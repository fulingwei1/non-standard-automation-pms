# -*- coding: utf-8 -*-
"""
工程师绩效数据自动采集服务 - 基础类和常量
"""

import re
from typing import Dict, List

from sqlalchemy.orm import Session


class PerformanceDataCollectorBase:
    """绩效数据采集器基类"""

    # 积极词汇（用于识别自我评价中的正面内容）
    POSITIVE_KEYWORDS = [
        # 完成类
        '完成', '达成', '实现', '交付', '通过', '验收', '合格', '完成度',
        # 解决类
        '解决', '修复', '处理', '消除', '克服', '攻克', '搞定',
        # 优化类
        '优化', '改进', '提升', '增强', '改善', '完善', '精进',
        # 创新类
        '突破', '创新', '革新', '改进', '升级', '迭代',
        # 协作类
        '分享', '协助', '配合', '支持', '帮助', '指导', '培训', '传授',
        '合作', '协同', '配合', '对接', '沟通', '协调',
        # 成功类
        '成功', '顺利', '高效', '优秀', '出色', '卓越', '完美',
        # 知识分享类
        '分享', '传授', '指导', '培训', '讲解', '演示', '展示',
        # 技术突破类
        '突破', '攻克', '解决难题', '技术突破', '创新方案'
    ]

    # 消极词汇（用于识别自我评价中的负面内容）
    NEGATIVE_KEYWORDS = [
        # 困难类
        '困难', '难题', '挑战', '阻碍', '障碍', '瓶颈', '卡点',
        # 问题类
        '问题', '错误', '失败', '异常', '故障', 'bug', '缺陷',
        # 延期类
        '延期', '延迟', '滞后', '超期', '延误', '推迟',
        # 未完成类
        '未完成', '待完成', '进行中', '未解决', '待处理',
        # 需要帮助类
        '需要支持', '需要帮助', '需要协助', '需要指导', '需要资源',
        # 遇到类
        '遇到', '碰到', '面临', '遭遇', '陷入',
        # 风险类
        '风险', '隐患', '担忧', '担心', '不确定',
        # 不足类
        '待解决', '待改进', '不足', '缺失', '缺少', '不够', '欠缺',
        # 技术难点类
        '技术难点', '技术难题', '技术瓶颈', '技术障碍'
    ]

    # 技术相关关键词
    TECH_KEYWORDS = [
        # 设计类
        '设计', '架构', '方案', '规划', '建模', '绘图', '制图',
        # 开发类
        '开发', '编程', '编码', '实现', '编写', '代码', '程序',
        # 调试类
        '调试', '测试', '验证', '检查', '排查', '定位', '分析',
        # 优化类
        '优化', '重构', '改进', '提升', '性能优化', '效率提升',
        # 技术概念类
        '算法', '模块', '接口', '协议', '框架', '库', '组件',
        # 技术难点类
        '技术难点', '技术突破', '技术攻关', '技术方案', '技术选型'
    ]

    # 协作相关关键词
    COLLABORATION_KEYWORDS = [
        # 配合类
        '配合', '协助', '支持', '帮助', '协作', '协同', '合作',
        # 沟通类
        '沟通', '交流', '讨论', '协商', '对接', '协调', '联络',
        # 会议类
        '会议', '评审', '讨论会', '技术交流', '方案评审',
        # 指导类
        '指导', '培训', '分享', '传授', '讲解', '演示', '展示',
        # 反馈类
        '反馈', '建议', '意见', '评价', '评估'
    ]

    # 问题解决场景关键词（上下文分析用）
    PROBLEM_SOLVING_PATTERNS = [
        r'遇到.*?问题.*?解决',
        r'通过.*?方法.*?解决',
        r'分析.*?原因.*?处理',
        r'定位.*?问题.*?修复',
        r'攻克.*?技术难点',
        r'突破.*?技术瓶颈'
    ]

    # 知识分享场景关键词
    KNOWLEDGE_SHARING_PATTERNS = [
        r'分享.*?经验',
        r'培训.*?团队',
        r'指导.*?新人',
        r'传授.*?技术',
        r'讲解.*?方案',
        r'文档.*?整理'
    ]

    # 技术突破场景关键词
    TECH_BREAKTHROUGH_PATTERNS = [
        r'技术突破',
        r'创新方案',
        r'优化.*?性能',
        r'提升.*?效率',
        r'改进.*?算法',
        r'重构.*?架构'
    ]

    def __init__(self, db: Session):
        self.db = db

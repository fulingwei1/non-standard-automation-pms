# 行政经理工作台统计功能总结

## 一、统计组件库

### 1.1 组件位置
`frontend/src/components/administrative/StatisticsCharts.jsx`

### 1.2 可用组件

#### SimpleBarChart - 柱状图
- **用途**: 展示分类数据对比
- **参数**:
  - `data`: 数据数组，格式 `[{label, value}]`
  - `height`: 图表高度（默认200）
  - `color`: 柱状图颜色（默认'bg-blue-500'）

#### SimplePieChart - 饼图（环形图）
- **用途**: 展示占比分布
- **参数**:
  - `data`: 数据数组，格式 `[{label, value, color}]`
  - `size`: 图表大小（默认200）

#### MonthlyTrendChart - 月度趋势图
- **用途**: 展示月度数据趋势
- **参数**:
  - `data`: 数据数组
  - `valueKey`: 数值字段名（默认'value'）
  - `labelKey`: 标签字段名（默认'month'）
  - `height`: 图表高度（默认200）

#### TrendComparisonCard - 趋势对比卡片
- **用途**: 展示当前值与上期值对比
- **参数**:
  - `title`: 标题
  - `current`: 当前值
  - `previous`: 上期值
  - `unit`: 单位（默认''）
  - `formatValue`: 格式化函数

#### CategoryBreakdownCard - 分类明细卡片
- **用途**: 展示分类数据明细和占比
- **参数**:
  - `title`: 标题
  - `data`: 数据数组，格式 `[{label, value, color}]`
  - `total`: 总计
  - `formatValue`: 格式化函数

## 二、已添加统计功能的页面

### 2.1 行政经理工作台 (`AdministrativeManagerWorkstation.jsx`)
**已添加统计**:
- ✅ 月度行政预算执行（费用分类明细 + 月度趋势图）
- ✅ 6个关键指标卡片（实时数据）

**统计内容**:
- 预算使用率
- 费用分类占比（办公用品、车辆费用、其他费用）
- 月度费用趋势（最近4个月）

### 2.2 行政费用统计 (`AdministrativeExpenses.jsx`)
**已添加统计**:
- ✅ 费用分类占比（饼图）
- ✅ 费用分类明细（分类卡片）
- ✅ 月度费用趋势（柱状图）
- ✅ 分类费用趋势（多个分类的趋势对比）
- ✅ 趋势对比卡片（本月 vs 上月）
- ✅ 费用明细列表

**统计内容**:
- 预算执行情况
- 6大费用分类占比和明细
- 最近6个月费用趋势
- 各分类月度趋势对比
- 费用明细记录

### 2.3 办公用品管理 (`OfficeSuppliesManagement.jsx`)
**已添加统计**:
- ✅ 分类库存价值分布
- ✅ 月度采购趋势

**统计内容**:
- 办公耗材 vs 办公文具库存价值对比
- 最近4个月采购金额趋势

### 2.4 员工考勤管理 (`AttendanceManagement.jsx`)
**已添加统计**:
- ✅ 部门出勤率对比（柱状图）
- ✅ 月度出勤趋势
- ✅ 趋势对比卡片（出勤率、出勤人数、请假人数）

**统计内容**:
- 各部门出勤率横向对比
- 最近4个月平均出勤率趋势
- 关键指标与上月对比

## 三、统计数据展示

### 3.1 费用统计
- **预算执行**: 预算总额、已使用、剩余、使用率
- **费用分类**: 办公用品、车辆费用、固定资产、会议费用、设备维护、其他费用
- **趋势分析**: 月度趋势、分类趋势、同比环比

### 3.2 库存统计
- **库存价值**: 总价值、分类价值分布
- **库存状态**: 正常、低库存物品数量
- **采购趋势**: 月度采购金额趋势

### 3.3 考勤统计
- **部门对比**: 各部门出勤率对比
- **月度趋势**: 平均出勤率趋势
- **指标对比**: 出勤率、出勤人数、请假人数与上月对比

### 3.4 审批统计
- **待审批**: 总数、紧急事项数
- **分类统计**: 办公用品、车辆、资产、会议、请假各类审批数量

## 四、数据可视化特点

### 4.1 图表类型
- **柱状图**: 用于分类对比（部门、分类等）
- **饼图**: 用于占比展示（费用分类、库存分类等）
- **趋势图**: 用于时间序列数据（月度趋势）
- **进度条**: 用于完成度展示（预算使用率、库存率等）

### 4.2 交互功能
- 悬停效果：图表元素悬停时高亮
- 数据标签：显示具体数值和百分比
- 颜色编码：不同分类使用不同颜色区分
- 响应式：适配不同屏幕尺寸

### 4.3 数据格式
- 货币格式：使用 `formatCurrency` 格式化金额
- 百分比格式：保留1位小数
- 日期格式：使用 `formatDate` 格式化日期
- 数字格式：大数字使用万/亿单位

## 五、后续扩展建议

### 5.1 待添加统计的页面
- [ ] 会议管理：会议室使用率、会议类型分布、会议时长统计
- [ ] 车辆管理：车辆使用率、燃油消耗趋势、维护费用统计
- [ ] 固定资产：资产价值趋势、折旧统计、维护成本分析
- [ ] 请假管理：请假类型分布、请假趋势、部门请假对比

### 5.2 高级统计功能
- [ ] 同比环比分析
- [ ] 预测分析（基于历史数据）
- [ ] 异常检测（费用异常、出勤异常等）
- [ ] 自定义报表生成
- [ ] 数据导出（Excel、PDF）

### 5.3 数据集成
- [ ] 对接后端API获取真实数据
- [ ] 实时数据更新
- [ ] 数据缓存机制
- [ ] 数据权限控制

## 六、技术实现

### 6.1 组件架构
```
StatisticsCharts.jsx (统计组件库)
├── SimpleBarChart (柱状图)
├── SimplePieChart (饼图)
├── MonthlyTrendChart (月度趋势)
├── TrendComparisonCard (趋势对比)
└── CategoryBreakdownCard (分类明细)
```

### 6.2 使用示例
```jsx
import { SimpleBarChart, MonthlyTrendChart } from '../components/administrative/StatisticsCharts'

// 柱状图
<SimpleBarChart
  data={[
    { label: '销售部', value: 95.6 },
    { label: '项目部', value: 97.4 },
  ]}
  height={200}
  color="bg-emerald-500"
/>

// 月度趋势
<MonthlyTrendChart
  data={[
    { month: '2024-10', amount: 420000 },
    { month: '2024-11', amount: 395000 },
  ]}
  valueKey="amount"
  labelKey="month"
  height={150}
/>
```

## 七、总结

已为行政经理工作台及相关管理页面添加了详细的统计功能，包括：
- ✅ 4个主要页面添加了统计图表
- ✅ 5个可复用的统计组件
- ✅ 多种数据可视化方式
- ✅ 趋势分析和对比分析
- ✅ 响应式设计

所有统计功能已集成到现有页面中，使用模拟数据展示。后续可对接后端API获取真实数据。

---

**文档版本**: v1.0  
**创建日期**: 2025-01-07  
**最后更新**: 2025-01-07




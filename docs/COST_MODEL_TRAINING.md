# AIæˆæœ¬ä¼°ç®—æ¨¡å‹è®­ç»ƒæ–‡æ¡£

## ğŸ“š ç›®å½•

1. [æ¨¡å‹æ¶æ„](#æ¨¡å‹æ¶æ„)
2. [æˆæœ¬è®¡ç®—å…¬å¼](#æˆæœ¬è®¡ç®—å…¬å¼)
3. [å‚æ•°é…ç½®](#å‚æ•°é…ç½®)
4. [å†å²æ•°æ®å­¦ä¹ ](#å†å²æ•°æ®å­¦ä¹ )
5. [æ¨¡å‹è°ƒä¼˜](#æ¨¡å‹è°ƒä¼˜)
6. [æ€§èƒ½è¯„ä¼°](#æ€§èƒ½è¯„ä¼°)

---

## æ¨¡å‹æ¶æ„

### å½“å‰ç‰ˆæœ¬: v1.0 (è§„åˆ™å¼•æ“+ç»Ÿè®¡å­¦ä¹ )

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è¾“å…¥å±‚ (Input Layer)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ é¡¹ç›®ç±»å‹ (project_type)                         â”‚  â”‚
â”‚  â”‚ â€¢ ç¡¬ä»¶æ¸…å• (hardware_items)                       â”‚  â”‚
â”‚  â”‚ â€¢ è½¯ä»¶éœ€æ±‚ (software_requirements)                â”‚  â”‚
â”‚  â”‚ â€¢ å¤æ‚åº¦ (complexity_level)                       â”‚  â”‚
â”‚  â”‚ â€¢ å®‰è£…éš¾åº¦ (installation_difficulty)              â”‚  â”‚
â”‚  â”‚ â€¢ æœåŠ¡å¹´é™ (service_years)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 è®¡ç®—å±‚ (Calculation Layer)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1. ç¡¬ä»¶æˆæœ¬è®¡ç®—                                    â”‚  â”‚
â”‚  â”‚    = Î£(å•ä»· Ã— æ•°é‡) Ã— åŠ æˆç³»æ•°                     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 2. è½¯ä»¶æˆæœ¬è®¡ç®—                                    â”‚  â”‚
â”‚  â”‚    = äººå¤© Ã— 8å°æ—¶ Ã— æ—¶è–ª                           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 3. å®‰è£…æˆæœ¬è®¡ç®—                                    â”‚  â”‚
â”‚  â”‚    = åŸºç¡€æˆæœ¬ Ã— éš¾åº¦ç³»æ•° + ç¡¬ä»¶æˆæœ¬ Ã— 5%           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 4. æœåŠ¡æˆæœ¬è®¡ç®—                                    â”‚  â”‚
â”‚  â”‚    = (ç¡¬ä»¶+è½¯ä»¶) Ã— å¹´æœåŠ¡è´¹ç‡ Ã— å¹´é™               â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 5. é£é™©å‚¨å¤‡è®¡ç®—                                    â”‚  â”‚
â”‚  â”‚    = åŸºç¡€æˆæœ¬ Ã— é£é™©ç‡ Ã— å¤æ‚åº¦ç³»æ•° Ã— å†å²è°ƒæ•´     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AIå¢å¼ºå±‚ (AI Enhancement Layer)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ å†å²æ•°æ®æŸ¥è¯¢                                     â”‚  â”‚
â”‚  â”‚ â€¢ åå·®ç‡ç»Ÿè®¡                                       â”‚  â”‚
â”‚  â”‚ â€¢ åŠ¨æ€ç³»æ•°è°ƒæ•´                                     â”‚  â”‚
â”‚  â”‚ â€¢ ç½®ä¿¡åº¦è¯„ä¼°                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 è¾“å‡ºå±‚ (Output Layer)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ â€¢ æ€»æˆæœ¬ä¼°ç®—                                       â”‚  â”‚
â”‚  â”‚ â€¢ æˆæœ¬åˆ†è§£                                         â”‚  â”‚
â”‚  â”‚ â€¢ ä¼˜åŒ–å»ºè®®                                         â”‚  â”‚
â”‚  â”‚ â€¢ å®šä»·æ¨è                                         â”‚  â”‚
â”‚  â”‚ â€¢ ç½®ä¿¡åº¦è¯„åˆ†                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æˆæœ¬è®¡ç®—å…¬å¼

### 1. ç¡¬ä»¶æˆæœ¬ (Hardware Cost)

**å…¬å¼**:
```python
hardware_cost = Î£(item.unit_price Ã— item.quantity) Ã— HARDWARE_MARKUP
```

**å‚æ•°**:
- `HARDWARE_MARKUP` = 1.15 (15%åŠ æˆ)

**åŠ æˆè¯´æ˜**:
- è¿è´¹: 5%
- æŸè€—: 3%
- å¤‡å“å¤‡ä»¶: 5%
- å…¶ä»–: 2%

**ç¤ºä¾‹**:
```python
hardware_items = [
    {"name": "PLC", "unit_price": 5000, "quantity": 2},
    {"name": "ç”µæœº", "unit_price": 3000, "quantity": 4}
]

raw_cost = 5000*2 + 3000*4 = 22000
hardware_cost = 22000 * 1.15 = 25300
```

### 2. è½¯ä»¶æˆæœ¬ (Software Cost)

**å…¬å¼**:
```python
if estimated_man_days:
    software_cost = estimated_man_days Ã— 8 Ã— SOFTWARE_HOURLY_RATE
else:
    # åŸºäºéœ€æ±‚æè¿°è‡ªåŠ¨ä¼°ç®—
    word_count = len(software_requirements)
    if word_count < 100:
        estimated_man_days = 5
    elif word_count < 500:
        estimated_man_days = 15
    else:
        estimated_man_days = 30
    software_cost = estimated_man_days Ã— 8 Ã— SOFTWARE_HOURLY_RATE
```

**å‚æ•°**:
- `SOFTWARE_HOURLY_RATE` = 800å…ƒ/å°æ—¶
- å·¥ä½œæ—¥: 8å°æ—¶/å¤©

**æ—¶è–ªä¾æ®**:
- åˆçº§å·¥ç¨‹å¸ˆ: 500-700å…ƒ/å°æ—¶
- ä¸­çº§å·¥ç¨‹å¸ˆ: 800-1000å…ƒ/å°æ—¶
- é«˜çº§å·¥ç¨‹å¸ˆ: 1200-1500å…ƒ/å°æ—¶
- å–å¹³å‡å€¼: 800å…ƒ/å°æ—¶

**ç¤ºä¾‹**:
```python
# æœ‰äººå¤©ä¼°ç®—
estimated_man_days = 20
software_cost = 20 Ã— 8 Ã— 800 = 128000

# æ— äººå¤©ä¼°ç®—,è‡ªåŠ¨æ¨æ–­
requirements = "éœ€è¦å¼€å‘PLCæ§åˆ¶ç¨‹åºã€MESæ¥å£ã€æ•°æ®é‡‡é›†"  # 23å­—
# word_count < 100, estimated_man_days = 5
software_cost = 5 Ã— 8 Ã— 800 = 32000
```

### 3. å®‰è£…è°ƒè¯•æˆæœ¬ (Installation Cost)

**å…¬å¼**:
```python
difficulty_multiplier = {
    "high": 2.0,
    "medium": 1.5,
    "low": 1.0
}.get(installation_difficulty, 1.0)

installation_cost = INSTALLATION_BASE_COST Ã— difficulty_multiplier + hardware_cost Ã— 0.05
```

**å‚æ•°**:
- `INSTALLATION_BASE_COST` = 5000å…ƒ
- ç¡¬ä»¶æˆæœ¬é™„åŠ : 5%

**éš¾åº¦è¯´æ˜**:
- **ä½éš¾åº¦**: æ ‡å‡†åŒ–è®¾å¤‡,ç°åœºæ¡ä»¶å¥½,1å¤©å®Œæˆ
- **ä¸­ç­‰éš¾åº¦**: éœ€è¦å®šåˆ¶åŒ–å®‰è£…,ç°åœºè°ƒè¯•2-3å¤©
- **é«˜éš¾åº¦**: å¤æ‚é›†æˆ,ç°åœºç¯å¢ƒå·®,éœ€è¦5-7å¤©

**ç¤ºä¾‹**:
```python
hardware_cost = 100000
difficulty = "medium"

installation_cost = 5000 Ã— 1.5 + 100000 Ã— 0.05
                  = 7500 + 5000
                  = 12500
```

### 4. å”®åæœåŠ¡æˆæœ¬ (Service Cost)

**å…¬å¼**:
```python
base_for_service = hardware_cost + software_cost
service_cost = base_for_service Ã— SERVICE_ANNUAL_RATE Ã— service_years
```

**å‚æ•°**:
- `SERVICE_ANNUAL_RATE` = 0.10 (å¹´æœåŠ¡è´¹ç‡10%)

**æœåŠ¡è´¹ç‡ä¾æ®**:
- ç¡¬ä»¶ç»´æŠ¤: 5%/å¹´
- è½¯ä»¶å‡çº§: 3%/å¹´
- æŠ€æœ¯æ”¯æŒ: 2%/å¹´

**ç¤ºä¾‹**:
```python
hardware_cost = 100000
software_cost = 80000
service_years = 2

service_cost = (100000 + 80000) Ã— 0.10 Ã— 2
             = 36000
```

### 5. é£é™©å‚¨å¤‡é‡‘ (Risk Reserve)

**å…¬å¼**:
```python
# åŸºç¡€é£é™©ç‡
base_risk_rate = RISK_RESERVE_RATE  # 0.08

# å¤æ‚åº¦è°ƒæ•´
complexity_factor = {
    "high": 1.5,
    "medium": 1.0,
    "low": 0.5
}.get(complexity_level, 1.0)

# å†å²æ•°æ®è°ƒæ•´
historical_variance = get_historical_variance(project_type)
if historical_variance:
    historical_adjustment = 1 + historical_variance
else:
    historical_adjustment = 1.0

# æœ€ç»ˆé£é™©å‚¨å¤‡
base_cost = hardware_cost + software_cost + installation_cost
risk_reserve = base_cost Ã— base_risk_rate Ã— complexity_factor Ã— historical_adjustment
```

**å‚æ•°**:
- `RISK_RESERVE_RATE` = 0.08 (åŸºç¡€é£é™©ç‡8%)

**é£é™©æ¥æº**:
- éœ€æ±‚å˜æ›´: 3%
- æŠ€æœ¯éš¾é¢˜: 2%
- ä¾›åº”é“¾å»¶è¯¯: 2%
- å…¶ä»–ä¸å¯é¢„è§: 1%

**ç¤ºä¾‹**:
```python
base_cost = 200000
complexity = "high"
historical_variance = 0.05  # å†å²åå·®ç‡5%

risk_reserve = 200000 Ã— 0.08 Ã— 1.5 Ã— 1.05
             = 25200
```

### 6. æ€»æˆæœ¬ (Total Cost)

**å…¬å¼**:
```python
total_cost = hardware_cost + software_cost + installation_cost + service_cost + risk_reserve
```

---

## å‚æ•°é…ç½®

### å¯é…ç½®å‚æ•°åˆ—è¡¨

æ‰€æœ‰å‚æ•°éƒ½åœ¨ `AICostEstimationService` ç±»ä¸­å®šä¹‰,å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶æˆ–æ•°æ®åº“åŠ¨æ€è°ƒæ•´:

```python
class AICostEstimationService:
    # ç¡¬ä»¶åŠ æˆ
    HARDWARE_MARKUP = Decimal("1.15")  # 15%
    
    # è½¯ä»¶æ—¶è–ª
    SOFTWARE_HOURLY_RATE = Decimal("800")  # 800å…ƒ/å°æ—¶
    
    # å®‰è£…åŸºç¡€æˆæœ¬
    INSTALLATION_BASE_COST = Decimal("5000")  # 5000å…ƒ
    
    # å¹´æœåŠ¡è´¹ç‡
    SERVICE_ANNUAL_RATE = Decimal("0.10")  # 10%
    
    # é£é™©å‚¨å¤‡ç‡
    RISK_RESERVE_RATE = Decimal("0.08")  # 8%
```

### å‚æ•°è°ƒæ•´æŒ‡å—

#### 1. ç¡¬ä»¶åŠ æˆ (HARDWARE_MARKUP)

**ä½•æ—¶è°ƒæ•´**:
- ä¾›åº”é“¾æˆæœ¬ä¸Šå‡: å¢åŠ è‡³1.20
- æ‰¹é‡é‡‡è´­æŠ˜æ‰£: é™ä½è‡³1.10
- è¿è´¹å¤§å¹…æ³¢åŠ¨: æ ¹æ®å®é™…è°ƒæ•´

**è°ƒæ•´æ–¹æ³•**:
```python
# æ–¹æ³•1: ä¿®æ”¹ä»£ç 
HARDWARE_MARKUP = Decimal("1.20")

# æ–¹æ³•2: ä»é…ç½®æ–‡ä»¶è¯»å–(æ¨è)
config = load_config()
HARDWARE_MARKUP = Decimal(config['hardware_markup'])
```

#### 2. è½¯ä»¶æ—¶è–ª (SOFTWARE_HOURLY_RATE)

**ä½•æ—¶è°ƒæ•´**:
- å›¢é˜Ÿè–ªèµ„å˜åŒ–
- å¤–åŒ…ä»·æ ¼è°ƒæ•´
- æŠ€æœ¯å¤æ‚åº¦å˜åŒ–

**ä¸åŒæŠ€æœ¯æ ˆå‚è€ƒ**:
- ä¼ ç»ŸPLCç¼–ç¨‹: 600-800å…ƒ/å°æ—¶
- å·¥ä¸šè§†è§‰ç®—æ³•: 1000-1200å…ƒ/å°æ—¶
- AIç®—æ³•å¼€å‘: 1500-2000å…ƒ/å°æ—¶

#### 3. é£é™©å‚¨å¤‡ç‡ (RISK_RESERVE_RATE)

**ä½•æ—¶è°ƒæ•´**:
- å†å²åå·®ç‡æŒç»­>15%: å¢åŠ è‡³0.12
- å†å²åå·®ç‡<5%: é™ä½è‡³0.05
- æ–°æŠ€æœ¯é¢†åŸŸ: å¢åŠ è‡³0.15

---

## å†å²æ•°æ®å­¦ä¹ 

### å­¦ä¹ æœºåˆ¶

#### 1. æ•°æ®æ”¶é›†

æ¯ä¸ªé¡¹ç›®å®Œæˆå,é€šè¿‡ `update-actual-cost` æ¥å£è®°å½•:
```python
{
    "estimation_id": 1,
    "project_id": 3001,
    "project_name": "XXé¡¹ç›®",
    "actual_cost": 235000,
    "actual_breakdown": {...}
}
```

å­˜å…¥ `presale_cost_history` è¡¨ã€‚

#### 2. åå·®ç‡è®¡ç®—

```python
variance = actual_cost - estimated_cost
variance_rate = (variance / estimated_cost) Ã— 100
```

#### 3. ç»Ÿè®¡å­¦ä¹ 

**æŒ‰é¡¹ç›®ç±»å‹ç»Ÿè®¡å¹³å‡åå·®ç‡**:
```python
def _get_historical_variance(self, project_type: str) -> Optional[Decimal]:
    result = self.db.query(
        func.avg(PresaleCostHistory.variance_rate)
    ).filter(
        PresaleCostHistory.project_features.contains(f'"project_type": "{project_type}"')
    ).scalar()
    
    return Decimal(str(result / 100)) if result else None
```

#### 4. åŠ¨æ€è°ƒæ•´

å†å²åå·®ç‡ç”¨äºè°ƒæ•´é£é™©å‚¨å¤‡é‡‘:
```python
if historical_variance:
    risk_reserve = base_cost Ã— risk_rate Ã— (1 + historical_variance)
```

**ç¤ºä¾‹**:
- è‡ªåŠ¨åŒ–äº§çº¿é¡¹ç›®,å†å²å¹³å‡åå·®ç‡ +8%
- ä¸‹æ¬¡ä¼°ç®—æ—¶,é£é™©å‚¨å¤‡ä¼šå¢åŠ 8%
- å¦‚æœè¿ç»­3ä¸ªé¡¹ç›®åå·®éƒ½æ˜¯-5%,åˆ™ä¼šé™ä½é£é™©å‚¨å¤‡

---

## æ¨¡å‹è°ƒä¼˜

### è°ƒä¼˜æ­¥éª¤

#### Step 1: è¯„ä¼°å½“å‰æ¨¡å‹æ€§èƒ½

```bash
GET /api/v1/presale/ai/historical-accuracy
```

æŸ¥çœ‹:
- `average_variance_rate`: å¹³å‡åå·®ç‡
- `accuracy_rate`: å‡†ç¡®ç‡(åå·®<15%çš„æ¯”ä¾‹)

**ç›®æ ‡**:
- `average_variance_rate` < 10%
- `accuracy_rate` > 85%

#### Step 2: åˆ†æåå·®åŸå› 

æŸ¥è¯¢é«˜åå·®é¡¹ç›®:
```sql
SELECT * FROM presale_cost_history
WHERE ABS(variance_rate) > 15
ORDER BY created_at DESC
LIMIT 20;
```

åˆ†æå…±æ€§:
- æ˜¯å¦é›†ä¸­åœ¨æŸä¸ªé¡¹ç›®ç±»å‹?
- æ˜¯å¦æŸä¸ªæˆæœ¬é¡¹åå·®ç‰¹åˆ«å¤§?
- æ˜¯å¦æŸä¸ªæ—¶é—´æ®µåå·®å¤§?

#### Step 3: è°ƒæ•´å‚æ•°

**åœºæ™¯1**: è½¯ä»¶æˆæœ¬æ™®éä½ä¼°
```python
# è°ƒæ•´å‰
SOFTWARE_HOURLY_RATE = Decimal("800")

# è°ƒæ•´å
SOFTWARE_HOURLY_RATE = Decimal("900")
```

**åœºæ™¯2**: é«˜å¤æ‚åº¦é¡¹ç›®é£é™©å‚¨å¤‡ä¸è¶³
```python
# è°ƒæ•´å‰
complexity_factor = {"high": 1.5, ...}

# è°ƒæ•´å
complexity_factor = {"high": 2.0, ...}
```

**åœºæ™¯3**: å®‰è£…æˆæœ¬æ³¢åŠ¨å¤§
```python
# è°ƒæ•´å‰
INSTALLATION_BASE_COST = Decimal("5000")

# è°ƒæ•´å(æ ¹æ®é¡¹ç›®è§„æ¨¡åŠ¨æ€è°ƒæ•´)
def _calculate_installation_cost(self, difficulty, hardware_cost):
    # å¤§é¡¹ç›®åŸºç¡€æˆæœ¬æ›´é«˜
    if hardware_cost > 100000:
        base_cost = Decimal("10000")
    else:
        base_cost = Decimal("5000")
    # ...
```

#### Step 4: å›æµ‹éªŒè¯

ç”¨å†å²æ•°æ®å›æµ‹æ–°å‚æ•°:
```python
def backtest(new_params):
    histories = db.query(PresaleCostHistory).all()
    
    total_variance = 0
    for history in histories:
        # ç”¨æ–°å‚æ•°é‡æ–°ä¼°ç®—
        new_estimation = estimate_with_params(history.input, new_params)
        new_variance = abs(new_estimation - history.actual_cost) / history.actual_cost
        total_variance += new_variance
    
    avg_variance = total_variance / len(histories)
    return avg_variance
```

#### Step 5: ä¸Šçº¿æ–°æ¨¡å‹

```python
# æ›´æ–°æ¨¡å‹ç‰ˆæœ¬
MODEL_VERSION = "v1.1.0"

# è®°å½•å‚æ•°å˜æ›´
changelog = {
    "version": "v1.1.0",
    "date": "2026-03-01",
    "changes": [
        "è°ƒæ•´è½¯ä»¶æ—¶è–ªè‡³900å…ƒ/å°æ—¶",
        "é«˜å¤æ‚åº¦é£é™©ç³»æ•°å¢è‡³2.0"
    ]
}
```

---

## æ€§èƒ½è¯„ä¼°

### è¯„ä¼°æŒ‡æ ‡

#### 1. å‡†ç¡®åº¦æŒ‡æ ‡

**å¹³å‡ç»å¯¹åå·®ç‡ (MAPE)**:
```python
MAPE = (1/n) Ã— Î£|actual - estimated| / actual Ã— 100%
```

**ç›®æ ‡**: < 10%

**å‡†ç¡®ç‡ (Accuracy Rate)**:
```python
Accuracy = (åå·®<15%çš„é¡¹ç›®æ•° / æ€»é¡¹ç›®æ•°) Ã— 100%
```

**ç›®æ ‡**: > 85%

#### 2. ç½®ä¿¡åº¦æŒ‡æ ‡

**ç½®ä¿¡åº¦è¯„åˆ†åˆ†å¸ƒ**:
```python
high_confidence = count(confidence_score > 0.85) / total
medium_confidence = count(0.70 < confidence_score <= 0.85) / total
low_confidence = count(confidence_score <= 0.70) / total
```

**ç›®æ ‡**: high_confidence > 60%

#### 3. ä¼˜åŒ–å»ºè®®è´¨é‡

**å¯è¡Œæ€§è¯„åˆ†åˆ†å¸ƒ**:
```python
high_feasibility = count(feasibility_score > 0.85) / total
```

**ç›®æ ‡**: high_feasibility > 80%

**å®é™…é‡‡çº³ç‡**:
```python
adoption_rate = (å®é™…é‡‡çº³çš„å»ºè®®æ•° / æä¾›çš„å»ºè®®æ€»æ•°) Ã— 100%
```

**ç›®æ ‡**: > 50%

### æ€§èƒ½ç›‘æ§

#### å®æ—¶ç›‘æ§æŒ‡æ ‡

```python
# æ¯æ—¥ç»Ÿè®¡
daily_stats = {
    "date": "2026-02-15",
    "total_estimations": 25,
    "avg_confidence_score": 0.82,
    "avg_response_time": 0.8,  # ç§’
    "estimations_by_type": {
        "è‡ªåŠ¨åŒ–äº§çº¿": 10,
        "AGVç³»ç»Ÿ": 5,
        "è§†è§‰æ£€æµ‹": 7,
        "å…¶ä»–": 3
    }
}
```

#### å‘¨æŠ¥å‘Š

```python
# æ¯å‘¨å‡†ç¡®åº¦æŠ¥å‘Š
weekly_report = {
    "week": "2026-W07",
    "completed_projects": 5,  # æœ¬å‘¨å®Œæˆå¹¶æ›´æ–°å®é™…æˆæœ¬çš„é¡¹ç›®
    "average_variance_rate": 8.5,
    "accuracy_rate": 90.0,
    "best_performing_category": "è‡ªåŠ¨åŒ–äº§çº¿",
    "worst_performing_category": "å®šåˆ¶åŒ–AGV"
}
```

---

## æœªæ¥æ¼”è¿›è·¯çº¿

### Phase 1: è§„åˆ™å¼•æ“ (å½“å‰)
- åŸºäºå›ºå®šå…¬å¼
- ç®€å•ç»Ÿè®¡å­¦ä¹ 
- äººå·¥è°ƒå‚

### Phase 2: æœºå™¨å­¦ä¹  (3ä¸ªæœˆ)
- scikit-learnå›å½’æ¨¡å‹
- ç‰¹å¾å·¥ç¨‹
- è‡ªåŠ¨è°ƒå‚

**æŠ€æœ¯æ–¹æ¡ˆ**:
```python
from sklearn.ensemble import RandomForestRegressor

# ç‰¹å¾
features = [
    'project_type_encoded',
    'industry_encoded',
    'complexity_level_encoded',
    'hardware_total',
    'estimated_man_days',
    'installation_difficulty_encoded',
    'service_years',
    'historical_avg_cost'
]

# è®­ç»ƒ
model = RandomForestRegressor(n_estimators=100)
model.fit(X_train, y_train)

# é¢„æµ‹
predicted_cost = model.predict(X_test)
```

### Phase 3: æ·±åº¦å­¦ä¹  (6ä¸ªæœˆ+)
- ç¥ç»ç½‘ç»œ
- NLPåˆ†æéœ€æ±‚æ–‡æ¡£
- å›¾åƒè¯†åˆ«ç¡¬ä»¶æ¸…å•

**æŠ€æœ¯æ–¹æ¡ˆ**:
```python
import tensorflow as tf

# éœ€æ±‚æ–‡æ¡£ç¼–ç 
requirement_embedding = bert_model.encode(software_requirements)

# ç¡¬ä»¶æ¸…å•å›¾åƒè¯†åˆ«
hardware_features = image_model.predict(hardware_photo)

# å¤šæ¨¡æ€èåˆ
combined_features = concat([requirement_embedding, hardware_features, structured_data])

# æˆæœ¬é¢„æµ‹
cost_prediction = cost_model.predict(combined_features)
```

---

## é™„å½•

### A. å‚æ•°é€ŸæŸ¥è¡¨

| å‚æ•° | é»˜è®¤å€¼ | è¯´æ˜ | è°ƒæ•´é¢‘ç‡ |
|------|--------|------|----------|
| HARDWARE_MARKUP | 1.15 | ç¡¬ä»¶åŠ æˆ15% | å­£åº¦ |
| SOFTWARE_HOURLY_RATE | 800 | è½¯ä»¶æ—¶è–ª800å…ƒ | åŠå¹´ |
| INSTALLATION_BASE_COST | 5000 | å®‰è£…åŸºç¡€æˆæœ¬5000å…ƒ | å¹´åº¦ |
| SERVICE_ANNUAL_RATE | 0.10 | å¹´æœåŠ¡è´¹ç‡10% | å¹´åº¦ |
| RISK_RESERVE_RATE | 0.08 | é£é™©å‚¨å¤‡ç‡8% | å­£åº¦ |

### B. éš¾åº¦ç³»æ•°è¡¨

| éš¾åº¦ | ç¡¬ä»¶ | è½¯ä»¶ | å®‰è£… | å¤æ‚åº¦ |
|------|------|------|------|--------|
| Low | 1.0 | 0.8 | 1.0 | 0.5 |
| Medium | 1.0 | 1.0 | 1.5 | 1.0 |
| High | 1.0 | 1.2 | 2.0 | 1.5 |

### C. è¡Œä¸šè°ƒæ•´ç³»æ•°(æœªæ¥)

| è¡Œä¸š | æˆæœ¬ç³»æ•° | é£é™©ç³»æ•° | è¯´æ˜ |
|------|----------|----------|------|
| æ±½è½¦åˆ¶é€  | 1.1 | 1.2 | è¦æ±‚é«˜,é£é™©å¤§ |
| ç”µå­åˆ¶é€  | 1.0 | 1.0 | æ ‡å‡† |
| ç‰©æµä»“å‚¨ | 0.95 | 0.9 | æ ‡å‡†åŒ–ç¨‹åº¦é«˜ |
| é£Ÿå“åŒ»è¯ | 1.15 | 1.3 | åˆè§„è¦æ±‚é«˜ |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0  
**æœ€åæ›´æ–°**: 2026-02-15  
**ç»´æŠ¤äºº**: AI Agent  

# 文化墙功能实现总结

## 一、功能概述

文化墙是一个全屏滚动播放的信息展示系统，为每个员工提供：
- 公司战略规划展示
- 企业文化宣传
- 公司重要事项通知
- 通知公告
- 奖励通报
- 个人月度和季度目标
- 系统通知

## 二、数据模型

### 2.1 CultureWallContent（文化墙内容）

**表名**：`culture_wall_content`

**核心字段**：
- `content_type`: 内容类型（STRATEGY/CULTURE/IMPORTANT/NOTICE/REWARD）
- `title`: 标题
- `content`: 内容
- `summary`: 摘要
- `images/videos/attachments`: 媒体资源
- `is_published`: 是否发布
- `publish_date/expire_date`: 发布和过期日期
- `priority`: 优先级
- `view_count`: 浏览次数

### 2.2 PersonalGoal（个人目标）

**表名**：`personal_goal`

**核心字段**：
- `user_id`: 用户ID
- `goal_type`: 目标类型（MONTHLY/QUARTERLY/YEARLY）
- `period`: 目标周期（如：2025-01/2025-Q1）
- `title`: 目标标题
- `target_value/current_value`: 目标值和当前值
- `progress`: 进度百分比
- `status`: 状态（IN_PROGRESS/COMPLETED/OVERDUE/CANCELLED）

### 2.3 CultureWallReadRecord（阅读记录）

**表名**：`culture_wall_read_record`

用于记录用户阅读文化墙内容的情况，支持阅读统计。

## 三、API端点

### 3.1 文化墙汇总

**端点**：`GET /api/v1/culture-wall/summary`

**功能**：获取所有需要展示的内容汇总
- 战略规划（最多10条）
- 企业文化（最多10条）
- 重要事项（最多10条）
- 通知公告（最多10条）
- 奖励通报（最多10条）
- 个人目标（当前月度和季度）
- 系统通知（最近10条未读）

### 3.2 文化墙内容管理

- `GET /api/v1/culture-wall/contents` - 内容列表
- `POST /api/v1/culture-wall/contents` - 创建内容
- `GET /api/v1/culture-wall/contents/{id}` - 内容详情（自动记录阅读）

### 3.3 个人目标管理

- `GET /api/v1/personal-goals` - 目标列表
- `POST /api/v1/personal-goals` - 创建目标
- `PUT /api/v1/personal-goals/{id}` - 更新目标

## 四、前端页面

### 4.1 文化墙页面

**路径**：`/culture-wall`

**功能特性**：
1. **全屏展示**：占用整个屏幕，沉浸式体验
2. **自动滚动播放**：每5秒自动切换到下一项
3. **手动控制**：
   - 播放/暂停按钮
   - 左右导航按钮
   - 底部指示器（点击跳转）
4. **内容分类展示**：
   - 不同类型内容有不同的颜色和图标
   - 战略规划：紫色
   - 企业文化：红色
   - 重要事项：橙色
   - 通知公告：蓝色
   - 奖励通报：黄色
   - 个人目标：蓝色/绿色
5. **阅读状态**：已读内容显示已读标记
6. **响应式设计**：适配不同屏幕尺寸

### 4.2 内容类型

- **战略规划**：展示公司战略方向、目标等
- **企业文化**：展示企业价值观、文化理念等
- **重要事项**：展示公司重要决策、事件等
- **通知公告**：展示各类通知和公告
- **奖励通报**：展示员工奖励、表彰等
- **个人目标**：展示当前用户的月度和季度目标
- **系统通知**：展示系统产生的通知

## 五、使用场景

### 5.1 员工日常查看

员工可以：
1. 访问 `/culture-wall` 查看文化墙
2. 自动播放或手动浏览各类内容
3. 查看自己的月度和季度目标进度
4. 查看系统通知

### 5.2 管理员发布内容

管理员可以：
1. 通过API创建各类文化墙内容
2. 设置发布和过期时间
3. 设置优先级控制显示顺序
4. 上传图片、视频等媒体资源

### 5.3 个人目标管理

用户可以：
1. 创建自己的月度和季度目标
2. 更新目标进度
3. 标记目标完成状态

## 六、技术实现

### 6.1 滚动播放机制

- 使用 `setInterval` 实现自动播放
- 每5秒切换到下一项
- 支持暂停和继续播放
- 使用 Framer Motion 实现平滑过渡动画

### 6.2 数据获取

- 一次性获取所有需要展示的内容
- 按优先级和发布时间排序
- 自动过滤已过期的内容
- 记录阅读状态

### 6.3 阅读统计

- 查看内容详情时自动记录阅读
- 增加浏览次数
- 标记为已读

## 七、后续优化建议

1. **内容管理界面**：创建后台管理页面，方便管理员发布内容
2. **个人目标设置**：创建个人目标设置页面
3. **播放速度调整**：允许用户自定义播放速度
4. **内容筛选**：支持按类型筛选显示
5. **全屏模式**：支持真正的全屏模式（F11）
6. **定时刷新**：定期自动刷新内容
7. **内容详情页**：点击"查看详情"跳转到详情页
8. **多媒体支持**：更好地支持视频播放

## 八、数据库迁移

已创建迁移脚本：
- `migrations/20260108_culture_wall_sqlite.sql`
- `migrations/20260108_culture_wall_mysql.sql`

运行迁移后即可使用文化墙功能。

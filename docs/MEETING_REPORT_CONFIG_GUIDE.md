# 会议报告配置管理使用指南

## 一、功能概述

管理部可以在后台配置月度报告和年度报告导出的数据，包括：
- 选择要包含的指标
- 配置环比和同比对比
- 自定义报告章节和显示顺序
- 设置默认报告模板

## 二、系统可抽取的关键数据清单

### 2.1 项目管理模块（12个核心指标）

#### 项目基础指标
1. **项目总数** - 统计所有项目数量
2. **新增项目数** - 本月/年新增项目数
3. **完成项目数** - 本月/年完成项目数
4. **进行中项目数** - 当前进行中的项目数

#### 项目财务指标
5. **项目合同总额** - 所有项目合同金额汇总
6. **新增合同额** - 本月/年新签合同额
7. **项目预算总额** - 所有项目预算汇总
8. **项目实际成本** - 所有项目实际成本汇总
9. **项目成本偏差率** - (实际成本 - 预算) / 预算 × 100%

#### 项目进度指标
10. **平均项目进度** - 所有项目进度平均值
11. **健康度异常项目数** - 健康度为H2或H3的项目数
12. **按时完成率** - 按时完成项目数 / 完成项目总数

---

### 2.2 销售管理模块（15个核心指标）

#### 销售漏斗指标
1. **线索总数** - 线索数量
2. **新增线索数** - 本月/年新增线索
3. **线索转化率** - 转化为商机的线索数 / 线索总数
4. **商机总数** - 商机数量
5. **新增商机数** - 本月/年新增商机
6. **商机金额** - 商机预估金额汇总

#### 合同与回款指标
7. **合同总数** - 合同数量
8. **新签合同数** - 本月/年新签合同
9. **合同金额** - 合同总金额
10. **新签合同额** - 本月/年新签合同额
11. **回款总额** - 实际回款金额
12. **本月回款额** - 本月回款金额
13. **回款率** - 已回款金额 / 合同金额
14. **开票金额** - 发票总金额
15. **本月开票额** - 本月开票金额

---

### 2.3 采购与物料管理模块（10个核心指标）

#### 采购指标
1. **采购订单总数** - 采购订单数量
2. **新增采购订单数** - 本月/年新增订单
3. **采购订单金额** - 采购订单总金额
4. **本月采购额** - 本月采购金额
5. **收货完成率** - 已收货订单数 / 订单总数
6. **逾期订单数** - 逾期未收货订单数

#### 物料指标
7. **物料总数** - 物料种类数
8. **缺料上报数** - 缺料上报次数
9. **缺料解决数** - 已解决缺料数
10. **缺料解决率** - 已解决缺料数 / 缺料总数

---

### 2.4 工程变更管理(ECN)（6个核心指标）

1. **ECN总数** - 工程变更通知数量
2. **新增ECN数** - 本月/年新增ECN
3. **ECN批准率** - 已批准ECN数 / ECN总数
4. **ECN成本影响** - 变更成本影响汇总
5. **ECN工期影响** - 变更工期影响汇总（天）
6. **平均ECN处理时间** - ECN平均处理天数

---

### 2.5 验收管理模块（6个核心指标）

1. **验收单总数** - 验收单数量
2. **新增验收单数** - 本月/年新增验收单
3. **验收通过率** - 通过验收数 / 验收总数
4. **验收问题数** - 验收发现问题数
5. **验收问题解决率** - 已解决问题数 / 问题总数
6. **FAT验收数** - 出厂验收数量

---

### 2.6 问题管理模块（7个核心指标）

1. **问题总数** - 问题数量
2. **新增问题数** - 本月/年新增问题
3. **问题解决率** - 已解决问题数 / 问题总数
4. **平均问题解决时间** - 平均解决天数
5. **严重问题数** - 严重问题数
6. **逾期未解决问题数** - 逾期问题数
7. **问题按类型分布** - 各类型问题数量

---

### 2.7 预警与异常管理（5个核心指标）

1. **预警总数** - 预警记录数量
2. **新增预警数** - 本月/年新增预警
3. **预警处理率** - 已处理预警数 / 预警总数
4. **紧急预警数** - 紧急预警数
5. **异常事件数** - 异常事件数量

---

### 2.8 工时管理模块（6个核心指标）

1. **总工时** - 所有工时汇总
2. **本月工时** - 本月工时汇总
3. **平均每日工时** - 总工时 / 工作天数
4. **加班工时** - 加班工时汇总
5. **加班工时占比** - 加班工时 / 总工时
6. **项目工时分布** - 各项目工时分布

---

### 2.9 绩效管理模块（4个核心指标）

1. **绩效考核人数** - 参与考核人数
2. **优秀人数** - 优秀等级人数
3. **优秀率** - 优秀人数 / 考核人数
4. **平均绩效分数** - 平均绩效分数

---

### 2.10 外协管理模块（5个核心指标）

1. **外协订单总数** - 外协订单数量
2. **新增外协订单数** - 本月/年新增订单
3. **外协订单金额** - 外协订单总金额
4. **外协交付率** - 已交付订单数 / 订单总数
5. **外协供应商数** - 外协供应商数量

---

### 2.11 任务中心模块（5个核心指标）

1. **任务总数** - 任务数量
2. **新增任务数** - 本月/年新增任务
3. **任务完成率** - 已完成任务数 / 任务总数
4. **逾期任务数** - 逾期任务数
5. **平均任务完成时间** - 平均完成天数

---

### 2.12 管理节律模块（7个核心指标）

1. **会议总数** - 会议数量
2. **已完成会议数** - 已完成会议数
3. **会议完成率** - 已完成会议数 / 会议总数
4. **行动项总数** - 行动项数量
5. **已完成行动项数** - 已完成行动项数
6. **行动项完成率** - 已完成行动项数 / 行动项总数
7. **逾期行动项数** - 逾期行动项数

---

## 三、环比和同比数据支持

### 3.1 环比（Month-over-Month, MoM）

**定义**：与上月对比

**支持指标**：所有月度指标都支持环比

**计算方式**：
- 变化量 = 当前月 - 上月
- 变化率 = (当前月 - 上月) / 上月 × 100%

**示例**：
- 本月项目数：10，上月：8，环比：+2 (+25%)
- 本月合同额：1000万，上月：800万，环比：+200万 (+25%)

---

### 3.2 同比（Year-over-Year, YoY）

**定义**：与去年同期对比

**支持指标**：所有月度指标都支持同比

**计算方式**：
- 变化量 = 当前月 - 去年同月
- 变化率 = (当前月 - 去年同月) / 去年同月 × 100%

**示例**：
- 本月项目数：10，去年同月：6，同比：+4 (+66.7%)
- 本月合同额：1000万，去年同月：600万，同比：+400万 (+66.7%)

---

### 3.3 年度报告对比

**年度报告支持**：
- 与去年全年对比（同比）
- 按季度对比（Q1/Q2/Q3/Q4）
- 按月度趋势（12个月趋势）

---

## 四、配置管理功能

### 4.1 指标库管理

**功能**：
- 查看所有可用指标（按分类）
- 查看指标详情（数据源、计算方式、支持对比）
- 启用/禁用指标
- 自定义指标（管理部可添加）

**访问路径**：`/meeting-reports/metrics/available`

---

### 4.2 报告模板配置

**功能**：
- 创建报告配置
- 选择包含的指标
- 设置指标显示顺序
- 配置对比方式（环比/同比）
- 设置默认配置

**访问路径**：`/meeting-reports/configs`

**配置项**：
1. **指标选择**：从指标库中选择要包含的指标
2. **显示位置**：设置指标在摘要或详细中显示
3. **对比配置**：启用环比/同比，设置高亮阈值
4. **章节配置**：自定义报告章节和顺序

---

### 4.3 默认配置

**功能**：
- 设置默认月度报告配置
- 设置默认年度报告配置
- 生成报告时自动使用默认配置

---

## 五、配置界面设计

### 5.1 指标选择界面

**布局**：
- 左侧：指标分类树（项目管理、销售管理、采购管理等）
- 中间：指标列表（显示指标名称、数据源、支持对比）
- 右侧：已选指标列表（可拖拽排序）

**功能**：
- 搜索指标
- 按分类筛选
- 批量选择/取消
- 查看指标详情

---

### 5.2 报告配置编辑界面

**布局**：
- 顶部：配置基本信息（名称、类型、描述）
- 中间：指标配置区域
  - 摘要指标列表（可拖拽排序）
  - 详细指标列表（可拖拽排序）
- 底部：对比配置
  - 启用环比开关
  - 启用同比开关
  - 高亮阈值设置

---

### 5.3 配置预览

**功能**：
- 预览报告结构
- 预览指标列表
- 预览对比配置

---

## 六、使用流程

### 6.1 创建报告配置

1. **进入配置管理页面**
   - 访问路径：`/meeting-reports/configs`

2. **点击"创建配置"**

3. **填写基本信息**
   - 配置名称
   - 报告类型（年度/月度）
   - 配置描述

4. **选择指标**
   - 从指标库中选择要包含的指标
   - 设置指标显示位置（摘要/详细）
   - 设置指标显示顺序

5. **配置对比**
   - 启用环比
   - 启用同比
   - 设置高亮阈值

6. **设置默认配置**（可选）
   - 勾选"设为默认配置"

7. **保存配置**

---

### 6.2 使用配置生成报告

1. **生成报告时选择配置**
   - 可以选择已保存的配置
   - 或使用默认配置

2. **系统根据配置生成报告**
   - 只包含配置中启用的指标
   - 按配置的顺序显示
   - 按配置的对比方式显示对比数据

---

## 七、系统预置指标（建议）

### 7.1 月度报告推荐指标（Top 20）

#### 经营类（必选）
1. 新签合同额
2. 回款总额
3. 项目实际成本
4. 项目成本偏差率

#### 运营类（必选）
5. 项目总数
6. 进行中项目数
7. 平均项目进度
8. 健康度异常项目数

#### 质量类（推荐）
9. 验收通过率
10. 问题解决率
11. ECN批准率

#### 执行类（推荐）
12. 任务完成率
13. 行动项完成率
14. 会议完成率

#### 趋势类（推荐）
15. 新增项目数（环比）
16. 合同额（环比）
17. 回款额（环比）
18. 成本（环比）

#### 对比类（推荐）
19. 项目数（同比）
20. 合同额（同比）

---

### 7.2 年度报告推荐指标（Top 30）

包含月度报告的所有指标，加上：
- 完成项目数
- 按时完成率
- 平均项目工期
- 各季度趋势
- 各月度趋势
- 战略结构完成情况

---

## 八、技术实现

### 8.1 数据模型

- `MeetingReportConfig`：报告配置表
- `ReportMetricDefinition`：指标定义表

### 8.2 API端点

- `GET /meeting-reports/configs`：获取配置列表
- `POST /meeting-reports/configs`：创建配置
- `PUT /meeting-reports/configs/{id}`：更新配置
- `GET /meeting-reports/configs/default/{type}`：获取默认配置
- `GET /meeting-reports/metrics/available`：获取可用指标
- `POST /meeting-reports/metrics`：创建指标定义
- `PUT /meeting-reports/metrics/{id}`：更新指标定义

---

## 九、后续优化方向

### 9.1 指标计算引擎
- 实现动态指标计算
- 支持复杂计算公式
- 支持多数据源聚合

### 9.2 数据缓存
- 缓存指标计算结果
- 提升报告生成速度

### 9.3 可视化配置
- 拖拽式配置界面
- 实时预览效果

---

## 十、总结

### 10.1 数据源丰富度
- ✅ **12个业务模块**提供数据
- ✅ **100+个关键指标**可抽取
- ✅ **全面支持环比和同比**

### 10.2 配置灵活性
- ✅ **管理部可自定义**报告内容
- ✅ **按需选择指标**
- ✅ **灵活配置对比方式**
- ✅ **支持默认配置**

### 10.3 实施优先级
1. **P0**: 创建指标定义库（系统预置常用指标）
2. **P1**: 开发配置管理界面
3. **P2**: 实现动态报告生成
4. **P3**: 优化性能和用户体验

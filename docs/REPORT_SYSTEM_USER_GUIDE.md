# 工时报表自动生成系统 - 用户使用指南

**版本**: 1.0.0  
**适用角色**: 普通用户、部门经理、HR

---

## 📖 目录

1. [系统简介](#系统简介)
2. [快速开始](#快速开始)
3. [报表生成](#报表生成)
4. [报表查询与下载](#报表查询与下载)
5. [常见问题](#常见问题)

---

## 系统简介

工时报表自动生成系统是一个完全自动化的工时统计报表解决方案，能够：

✅ **自动生成报表**: 每月1号自动生成上月工时报表  
✅ **多种报表类型**: 人员、部门、项目、公司整体、加班统计  
✅ **专业Excel格式**: 包含总览、明细和图表  
✅ **历史归档查询**: 随时查询和下载历史报表  
✅ **自动发送**: 可配置自动发送给相关人员

---

## 快速开始

### 1. 登录系统

使用您的账号密码登录系统：
```
https://your-domain.com/login
```

### 2. 进入报表模块

在左侧导航菜单中找到 **"工时管理" > "报表中心"**

您将看到三个子菜单：
- 📋 报表模板管理（仅 HR/Admin 可见）
- 📊 生成报表
- 📁 报表归档查询

---

## 报表生成

### 手动生成报表

有时您可能需要立即生成某个月份的报表，无需等待自动任务。

**步骤**:

1. 点击 **"生成报表"** 菜单
2. 选择报表模板（例如：人员月度工时报表）
3. 选择报表周期（例如：2026年1月）
4. 点击 **"预览数据"** 查看报表内容（可选）
5. 确认无误后，点击 **"生成报表"**
6. 等待几秒钟，报表生成完成

**示例截图**:
```
┌─────────────────────────────────────────┐
│  生成工时报表                           │
├─────────────────────────────────────────┤
│  选择模板: [人员月度工时报表 ▼]         │
│  报表周期: [2026-01      ]             │
│  [预览数据]  [生成报表]                 │
└─────────────────────────────────────────┘
```

### 预览功能

点击"预览数据"可以看到报表的前50条数据，确保数据正确后再生成完整报表。

---

## 报表查询与下载

### 查询历史报表

1. 点击 **"报表归档查询"** 菜单
2. 使用筛选条件查询：
   - **报表类型**: 选择您需要的报表类型
   - **报表周期**: 选择年月
   - **状态**: 成功/失败
3. 点击 **"查询"** 按钮

**示例**:
```
查询条件：
报表类型: [人员月度报表 ▼]
报表周期: [2026-01]
状态:     [成功 ▼]
[查询]
```

### 下载报表

在查询结果中，点击每行右侧的 **下载按钮** 📥 即可下载 Excel 文件。

**提示**: 
- 报表文件格式为 `.xlsx`
- 文件包含3个工作表：总览、明细、图表
- 支持批量下载多个报表（选中后点击批量下载）

---

## 报表内容说明

### 人员月度工时报表

**总览表**: 每个人的工时汇总
- 姓名
- 部门
- 总工时
- 正常工时
- 加班工时
- 工作天数
- 日均工时

**明细表**: 每一条工时记录
- 姓名
- 日期
- 项目名称
- 任务名称
- 工时
- 工作内容

**图表**:
- 工时对比柱状图
- 部门分布饼图（如果有）

### 部门月度工时报表

汇总每个部门的工时情况：
- 部门名称
- 人数
- 总工时
- 人均工时

### 项目月度工时报表

汇总每个项目的工时投入：
- 项目名称
- 参与人数
- 总工时
- 人均工时

### 加班统计报表

统计每个人的加班情况：
- 姓名
- 部门
- 平日加班
- 周末加班
- 节假日加班
- 总加班时长

---

## 常见问题

### Q1: 报表什么时候自动生成？
**A**: 每月1号上午9:00自动生成上月报表。例如，2月1号9点会自动生成1月份的报表。

### Q2: 我可以生成任意月份的报表吗？
**A**: 可以！使用"生成报表"功能，您可以手动生成任意月份的报表。

### Q3: 报表数据不对怎么办？
**A**: 
1. 首先确认工时数据是否已审批通过（只统计已审批的工时）
2. 检查筛选条件是否正确
3. 联系 HR 或系统管理员检查模板配置

### Q4: 可以导出 PDF 格式吗？
**A**: 目前支持 Excel 格式，PDF 格式正在开发中。

### Q5: 下载的报表可以编辑吗？
**A**: 可以！下载的 Excel 文件是标准格式，您可以使用 Microsoft Excel 或 WPS 打开编辑。

### Q6: 报表会自动发送给我吗？
**A**: 如果 HR 将您配置为某个报表的收件人，系统会自动发送报表到您的邮箱或企业微信。

### Q7: 历史报表保存多久？
**A**: 所有报表永久保存，随时可以查询下载。

### Q8: 报表生成失败了怎么办？
**A**: 
1. 刷新页面重试
2. 检查网络连接
3. 如果持续失败，请联系系统管理员

---

## 操作技巧

### 💡 技巧1：快速下载上月报表

每月初，您可以直接进入"报表归档查询"，系统会按时间倒序排列，最新的报表在最上方，直接下载即可。

### 💡 技巧2：批量下载

如果需要下载多个月份的报表：
1. 在归档查询页面勾选需要的报表
2. 点击"批量下载"
3. 系统会打包成 ZIP 文件供您下载

### 💡 技巧3：预览功能

在正式生成报表前，使用"预览数据"功能可以快速查看前50条数据，确保数据正确，避免重复生成。

---

## 联系支持

如遇到问题或有改进建议，请联系：

- **HR 部门**: hr@company.com
- **技术支持**: support@company.com
- **内部工单系统**: https://your-domain.com/tickets

---

**祝您使用愉快！** 🎉

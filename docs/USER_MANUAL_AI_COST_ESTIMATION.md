# AI智能成本估算 - 用户使用手册

## 📖 目录

1. [功能概述](#功能概述)
2. [快速开始](#快速开始)
3. [详细功能指南](#详细功能指南)
4. [最佳实践](#最佳实践)
5. [常见问题](#常见问题)
6. [案例演示](#案例演示)

---

## 功能概述

### 什么是AI智能成本估算?

AI智能成本估算是一个帮助售前团队快速、准确预测项目成本的智能系统。它能够:

✅ **多维度成本预测** - 自动计算硬件、软件、安装、服务、风险等各项成本  
✅ **智能优化建议** - AI识别成本过高项,推荐可行的优化方案  
✅ **定价推荐** - 基于成本和市场竞争,提供高中低三档报价  
✅ **历史学习** - 从过往项目学习,不断提升预测准确度  

### 核心价值

- **提速**: 从2小时手工估算缩短至5秒AI预测
- **准确**: AI学习历史数据,偏差率<15%
- **专业**: 提供优化建议和定价策略,提升方案竞争力
- **透明**: 成本分解清晰,决策有据可依

---

## 快速开始

### 第一步: 准备项目信息

在使用AI估算前,请准备以下信息:

**基本信息**:
- 售前工单ID
- 项目类型(如"自动化产线""AGV调度系统"等)
- 复杂度等级(低/中/高)

**硬件信息**:
- 硬件清单(设备名称、单价、数量)

**软件信息**:
- 软件需求描述(越详细越好)
- 预估开发人天(如果知道的话)

**其他**:
- 安装难度
- 售后服务年限
- 目标毛利率

### 第二步: 调用AI估算

**方式1: 通过API调用**

```bash
POST /api/v1/presale/ai/estimate-cost

{
  "presale_ticket_id": 1001,
  "project_type": "自动化产线",
  "complexity_level": "medium",
  "hardware_items": [
    {"name": "PLC控制器", "unit_price": 5000, "quantity": 2},
    {"name": "伺服电机", "unit_price": 3000, "quantity": 4}
  ],
  "software_requirements": "需要开发PLC控制程序、MES接口",
  "estimated_man_days": 20,
  "installation_difficulty": "medium",
  "service_years": 2,
  "target_margin_rate": 0.30
}
```

**方式2: 通过前端界面**

1. 登录系统,进入"售前管理"模块
2. 打开对应的售前工单
3. 点击"AI成本估算"按钮
4. 填写必要信息
5. 点击"开始估算"

### 第三步: 查看估算结果

系统会在5秒内返回估算结果,包括:

✅ **成本分解**
- 硬件成本: ¥32,200
- 软件成本: ¥128,000
- 安装调试: ¥11,610
- 售后服务: ¥32,362
- 风险储备: ¥16,174
- **总成本: ¥220,346**

✅ **置信度评分**: 0.85 (85%可靠)

✅ **优化建议**: 3条可行建议,预计可节省¥25,000

✅ **定价推荐**:
- 低价档: ¥283,314
- 标准报价: ¥314,794 ⭐
- 高价档: ¥362,013

---

## 详细功能指南

### 功能1: 智能成本估算

#### 适用场景
- 新项目快速报价
- 方案成本核算
- 与客户预算对比

#### 操作步骤

**1. 输入项目基本信息**

```json
{
  "presale_ticket_id": 1001,
  "project_type": "自动化产线",
  "industry": "制造业",
  "complexity_level": "medium"
}
```

- `project_type`: 选择最接近的项目类型,AI会从历史类似项目学习
- `complexity_level`: 
  - `low`: 标准化项目,成熟方案
  - `medium`: 有一定定制化
  - `high`: 高度定制,技术难度大

**2. 填写硬件清单**

```json
{
  "hardware_items": [
    {
      "name": "PLC控制器",
      "model": "西门子S7-1500",
      "unit_price": 5000,
      "quantity": 2,
      "supplier": "西门子"
    }
  ]
}
```

💡 **提示**: 硬件清单越详细,估算越准确。系统会自动加成15%考虑运费、损耗等。

**3. 描述软件需求**

```json
{
  "software_requirements": "需要开发PLC控制程序,包括:
  1. 设备通信协议适配
  2. MES系统接口开发
  3. 数据采集与存储
  4. 可视化监控界面
  5. 报警和日志系统",
  "estimated_man_days": 20
}
```

💡 **提示**: 
- 如果没有`estimated_man_days`,AI会根据需求描述自动估算
- 需求描述>100字,置信度会提升0.15

**4. 其他参数**

```json
{
  "installation_difficulty": "medium",  // 安装难度
  "service_years": 2,                   // 售后年限
  "target_margin_rate": 0.30            // 目标毛利率30%
}
```

#### 理解估算结果

**成本分解**:
- `hardware_cost`: 硬件总价 × 1.15 (含运费损耗)
- `software_cost`: 人天 × 8小时 × ¥800/小时
- `installation_cost`: 基础¥5000 + 难度系数 + 硬件成本5%
- `service_cost`: (硬件+软件) × 10% × 服务年限
- `risk_reserve`: 基于历史偏差数据的风险储备金

**置信度评分** (0-1):
- 0.5-0.6: 基础估算,缺少详细信息
- 0.7-0.8: 较可靠,提供了主要信息
- 0.85+: 高可靠,信息完整且有历史参考

---

### 功能2: 成本优化建议

#### 适用场景
- 成本过高,需要降本
- 与客户预算有差距
- 方案优化

#### 操作步骤

**1. 基于估算结果优化**

```bash
POST /api/v1/presale/ai/optimize-cost

{
  "estimation_id": 1,
  "focus_areas": ["software", "hardware"],
  "max_risk_level": "medium"
}
```

**2. 理解优化建议**

系统会返回多条优化建议,每条包含:

```json
{
  "type": "software",
  "description": "考虑使用现有代码库模块,减少开发工时",
  "original_cost": 128000,
  "optimized_cost": 108800,
  "saving_amount": 19200,
  "saving_rate": 15.0,
  "feasibility_score": 0.75,
  "alternative_solutions": [
    "采用低代码平台",
    "外包部分非核心功能"
  ]
}
```

**关键字段**:
- `feasibility_score`: 可行性评分(0-1)
  - >0.85: 强烈推荐,风险低
  - 0.70-0.85: 可行,需评估
  - <0.70: 有风险,谨慎考虑

**3. 风险等级控制**

- `max_risk_level: "low"`: 只显示可行性>0.85的建议
- `max_risk_level: "medium"`: 显示可行性>0.70的建议
- `max_risk_level: "high"`: 显示可行性>0.50的建议

💡 **实战建议**: 
- 与客户报价前,先看"low"风险建议
- 方案评审时,看"medium"建议
- 内部讨论时,可以看"high"建议寻找灵感

---

### 功能3: 智能定价推荐

#### 适用场景
- 确定对外报价
- 应对价格谈判
- 评估报价竞争力

#### 操作步骤

**1. 获取定价建议**

```bash
POST /api/v1/presale/ai/pricing-recommendation

{
  "estimation_id": 1,
  "target_margin_rate": 0.35,
  "market_competition_level": "high",
  "customer_budget": 280000
}
```

**2. 理解定价结果**

```json
{
  "pricing_recommendations": {
    "low": 269049,
    "medium": 298943,
    "high": 343784,
    "suggested_price": 298943,
    "target_margin_rate": 35.0
  },
  "sensitivity_analysis": {
    "budget_fit": {
      "customer_budget": 280000,
      "fits_low": true,
      "fits_recommended": false,
      "recommended_strategy": "客户预算偏紧,可考虑低价档,但需简化部分服务"
    }
  },
  "competitiveness_score": 0.75
}
```

**定价档位说明**:
- **低价档**: 建议价×0.90,保守报价,确保成交
- **标准报价**: 建议价,平衡利润与竞争力
- **高价档**: 建议价×1.15,强调高附加值

**竞争力评分** (0-1):
- >0.85: 竞争力强,客户预算充足
- 0.70-0.85: 有竞争力
- <0.70: 竞争力弱,可能需要优化方案或降价

#### 定价策略建议

**场景1: 客户预算 > 高价档**
- 策略: 报高价档,强调服务质量
- 行动: 增加附加值服务,提升方案

**场景2: 客户预算介于标准-高价档之间**
- 策略: 报标准价或略高
- 行动: 展示性价比,强调技术优势

**场景3: 客户预算介于低价-标准之间**
- 策略: 报低价档或优化方案降成本
- 行动: 简化非核心功能,分期交付

**场景4: 客户预算 < 低价档**
- 策略: 优化方案或考虑放弃
- 行动: 与客户沟通需求优先级,砍掉次要需求

---

### 功能4: 成本对比分析

#### 适用场景
- 对比多个技术方案
- 评估不同供应商报价
- 方案决策支持

#### 操作步骤

```bash
POST /api/v1/presale/ai/cost-comparison

{
  "estimation_ids": [1, 2, 3]
}
```

系统会返回:
- 各方案详细成本对比
- 成本差异统计(最低/最高/平均/方差)
- 推荐最优方案

💡 **使用技巧**: 
- 同时估算"标准方案"和"高配方案",给客户选择
- 对比"自研"vs"外采"的成本差异

---

### 功能5: 历史准确度查询

#### 适用场景
- 评估AI模型可靠性
- 团队内部汇报
- 持续改进参考

#### 操作步骤

```bash
GET /api/v1/presale/ai/historical-accuracy
```

返回结果:
```json
{
  "total_predictions": 156,
  "average_variance_rate": 9.85,
  "accuracy_rate": 87.82,
  "recent_trend": "improving"
}
```

**指标解读**:
- `accuracy_rate`: 偏差<15%的比例,越高越好
- `average_variance_rate`: 平均偏差率,越低越好
- `recent_trend`: 
  - `improving`: 模型在进步
  - `stable`: 保持稳定
  - `declining`: 需要关注

---

### 功能6: 更新实际成本 (重要!)

#### 为什么重要?

AI模型需要从实际数据中学习才能不断进步。**项目完成后务必更新实际成本!**

#### 操作步骤

**项目完成后**:

```bash
POST /api/v1/presale/ai/update-actual-cost

{
  "estimation_id": 1,
  "project_id": 3001,
  "project_name": "XX自动化产线项目",
  "actual_cost": 235000,
  "actual_breakdown": {
    "hardware_cost": 35000,
    "software_cost": 135000,
    "installation_cost": 12000,
    "service_cost": 33000,
    "risk_reserve": 20000,
    "total_cost": 235000
  }
}
```

系统会:
- 计算偏差率
- 分析偏差原因
- 更新AI模型参数
- 提升未来预测准确度

💡 **团队协作**: 
- 售前团队负责估算
- 项目经理负责更新实际成本
- 形成闭环,持续改进

---

## 最佳实践

### 1. 提高估算准确度的5个技巧

✅ **技巧1**: 硬件清单尽量详细,包含型号和供应商  
✅ **技巧2**: 软件需求描述>100字,列出主要功能点  
✅ **技巧3**: 选择准确的项目类型,便于历史学习  
✅ **技巧4**: 如果有类似项目经验,参考其人天估算  
✅ **技巧5**: 定期更新实际成本,让AI持续学习  

### 2. 报价流程最佳实践

**第1步**: AI快速估算 (5秒)  
**第2步**: 查看优化建议,初步优化方案 (10分钟)  
**第3步**: 获取定价推荐,确定报价区间 (5分钟)  
**第4步**: 结合客户预算,调整最终报价 (10分钟)  
**第5步**: 技术评审,确认方案可行性 (1天)  
**第6步**: 正式报价  

### 3. 成本控制技巧

- **硬件成本**: 批量采购折扣、国产替代、分期采购
- **软件成本**: 复用代码库、低代码平台、外包非核心
- **安装成本**: 提前勘查、模块化设计、远程支持
- **服务成本**: 培训客户自维护、预防性维护

### 4. 定价谈判策略

**谈判前**:
- 准备低/中/高三档报价
- 了解客户预算和竞争对手情况
- 准备成本分解说明(必要时展示)

**谈判中**:
- 先报标准价或高价
- 客户还价时,展示成本分解和优化空间
- 降价要有条件(如砍需求、延长交期)

**谈判后**:
- 记录实际成交价和让步条件
- 分析对利润的影响
- 为未来项目积累经验

---

## 常见问题

### Q1: AI估算结果偏差很大怎么办?

**A**: 
1. 检查输入信息是否完整准确
2. 查看置信度评分,<0.6说明信息不足
3. 如果是新项目类型,AI缺少历史参考,可以手工调整后记录实际成本
4. 偏差>20%的项目,务必在完成后更新实际成本

### Q2: 优化建议不可行怎么办?

**A**:
- 查看`feasibility_score`,<0.70的建议本来风险就高
- 优化建议是AI基于通用经验,需要结合实际情况判断
- 可以把建议作为灵感来源,自行调整

### Q3: 客户预算远低于估算成本?

**A**:
1. 先尝试成本优化,看能降多少
2. 与客户沟通需求优先级,砍掉次要功能
3. 考虑分期交付,降低首期成本
4. 如果差距>30%,建议放弃或建议客户增加预算

### Q4: 多久更新一次实际成本?

**A**:
- 理想情况: 每个项目完成后都更新
- 最低要求: 每季度更新完成的项目
- 更新越及时,AI学习越快,准确度提升越快

### Q5: AI模型会泄露商业机密吗?

**A**:
- AI模型只学习成本规律和统计特征,不会记录具体客户信息
- 历史数据脱敏处理
- 系统有严格的权限控制

---

## 案例演示

### 案例1: 标准自动化产线项目

**项目背景**:
- 客户: 某汽车零部件厂
- 需求: 轴承自动化检测产线
- 预算: ¥300,000

**估算过程**:

**步骤1**: 输入信息
```json
{
  "presale_ticket_id": 5001,
  "project_type": "自动化产线",
  "industry": "汽车制造",
  "complexity_level": "medium",
  "hardware_items": [
    {"name": "工业相机", "unit_price": 8000, "quantity": 4},
    {"name": "工控机", "unit_price": 6000, "quantity": 1},
    {"name": "传送带", "unit_price": 15000, "quantity": 1},
    {"name": "气缸", "unit_price": 500, "quantity": 8}
  ],
  "software_requirements": "视觉检测算法、数据采集、MES对接、报表生成",
  "estimated_man_days": 25,
  "installation_difficulty": "medium",
  "service_years": 2
}
```

**步骤2**: 查看估算结果
```
总成本: ¥242,580
- 硬件: ¥69,000
- 软件: ¥160,000
- 安装: ¥13,450
- 服务: ¥45,890
- 风险: ¥19,406

置信度: 0.88
```

**步骤3**: 优化建议
```
建议1: 使用国产工业相机,节省¥12,000 (可行性0.90)
建议2: 复用视觉检测代码库,节省¥24,000 (可行性0.80)
总计可节省: ¥36,000
优化后成本: ¥206,580
```

**步骤4**: 定价推荐
```
客户预算: ¥300,000
低价档: ¥265,000
标准价: ¥295,000 ⭐
高价档: ¥340,000

策略: 客户预算充足,报标准价,强调服务质量
竞争力: 0.90 (高)
```

**最终结果**: 
- 报价: ¥298,000
- 成交价: ¥290,000
- 实际成本: ¥215,000
- 毛利率: 34.5%
- **偏差率: 4.1%** ✅

---

### 案例2: 高度定制化AGV调度系统

**项目背景**:
- 客户: 某物流公司
- 需求: 20台AGV智能调度系统
- 预算: ¥500,000

**估算过程**:

**步骤1**: 输入信息
```json
{
  "presale_ticket_id": 5002,
  "project_type": "AGV调度系统",
  "complexity_level": "high",
  "hardware_items": [
    {"name": "调度服务器", "unit_price": 25000, "quantity": 1},
    {"name": "通信模块", "unit_price": 3000, "quantity": 20}
  ],
  "software_requirements": "路径规划算法、任务调度引擎、防碰撞系统、可视化监控、数据分析",
  "estimated_man_days": 60,
  "installation_difficulty": "high",
  "service_years": 3
}
```

**步骤2**: 查看估算结果
```
总成本: ¥582,760
- 硬件: ¥94,300
- 软件: ¥384,000
- 安装: ¥23,715
- 服务: ¥143,490
- 风险: ¥69,931 (高复杂度,风险储备加倍)

置信度: 0.72 (中等,高定制化项目历史案例少)
```

**步骤3**: 客户预算分析
```
客户预算: ¥500,000
估算成本: ¥582,760
差距: -¥82,760 (-14.2%)

AI建议: 需要优化方案或与客户沟通增加预算
```

**步骤4**: 优化方案
```
优化1: 调度算法使用开源框架改造,节省15天 (¥96,000)
优化2: 分期交付,第一期10台AGV,节省硬件成本 (¥47,150)
优化3: 售后服务从3年降为2年 (¥47,830)

优化后成本: ¥391,780
```

**步骤5**: 重新定价
```
优化后成本: ¥391,780
标准报价: ¥559,000
客户预算: ¥500,000

策略: 报¥520,000,毛利率24.6%,接受底线¥480,000
```

**最终结果**:
- 初次报价: ¥520,000
- 成交价: ¥495,000
- 实际成本: ¥425,000 (比优化预测高,因为开源框架集成比预期复杂)
- 毛利率: 16.5%
- **偏差率: 8.5%** ✅

**经验教训**:
- 高定制化项目AI置信度偏低,需要人工审核
- 使用开源框架节省成本,但集成难度可能被低估
- 更新实际成本后,AI下次遇到类似项目会调整风险储备

---

## 总结

AI智能成本估算是售前团队的得力助手,但不是替代品。**最佳实践是AI+人工经验相结合**:

✅ 用AI快速生成初步估算  
✅ 用AI发现优化机会  
✅ 用AI评估定价策略  
✅ 用人工经验审核和调整  
✅ 用实际数据反馈让AI持续进步  

**记住**: AI是工具,决策权在你手上! 🚀

---

## 技术支持

如有问题,欢迎联系:
- **使用咨询**: presales@example.com
- **功能建议**: product@example.com
- **技术支持**: tech-support@example.com

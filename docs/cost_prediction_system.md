# æˆæœ¬è¶…æ”¯é¢„è­¦å¢å¼ºç³»ç»Ÿ - æŠ€æœ¯æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
3. [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
4. [AIæœåŠ¡](#aiæœåŠ¡)
5. [APIç«¯ç‚¹](#apiç«¯ç‚¹)
6. [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
7. [æµ‹è¯•è¯´æ˜](#æµ‹è¯•è¯´æ˜)
8. [éƒ¨ç½²é…ç½®](#éƒ¨ç½²é…ç½®)

---

## ç³»ç»Ÿæ¦‚è¿°

### åŠŸèƒ½å®šä½

æˆæœ¬è¶…æ”¯é¢„è­¦å¢å¼ºç³»ç»Ÿæ˜¯åœ¨ç°æœ‰EVMï¼ˆæŒ£å€¼ç®¡ç†ï¼‰åŸºç¡€ä¸Šï¼Œæ·»åŠ AIé©±åŠ¨çš„æˆæœ¬é¢„æµ‹å’Œä¼˜åŒ–å»ºè®®åŠŸèƒ½ï¼Œå®ç°ï¼š

- **æ™ºèƒ½æˆæœ¬é¢„æµ‹**ï¼šä½¿ç”¨GLM-5 AIæ¨¡å‹é¢„æµ‹é¡¹ç›®æœ€ç»ˆæˆæœ¬ï¼ˆEACï¼‰
- **è¶…æ”¯é£é™©é¢„è­¦**ï¼šè¯†åˆ«æˆæœ¬è¶…æ”¯é£é™©å› ç´ ï¼Œè¯„ä¼°è¶…æ”¯æ¦‚ç‡
- **ä¼˜åŒ–å»ºè®®ç”Ÿæˆ**ï¼šAIè‡ªåŠ¨ç”Ÿæˆæˆæœ¬å‰Šå‡å’Œä¼˜åŒ–æ–¹æ¡ˆ
- **å…¨æµç¨‹è·Ÿè¸ª**ï¼šä»é¢„æµ‹â†’å»ºè®®â†’å®¡æ‰¹â†’å®æ–½â†’è¯„ä¼°çš„å®Œæ•´é—­ç¯

### æ ¸å¿ƒä»·å€¼

1. **é¢„æµ‹å‡†ç¡®æ€§**ï¼šAIæ¨¡å‹ç»“åˆå†å²æ•°æ®å’Œè¶‹åŠ¿åˆ†æï¼Œé¢„æµ‹è¯¯å·® â‰¤ 10%
2. **åŠæ—¶é¢„è­¦**ï¼šè¶…æ”¯é¢„è­¦å‡†ç¡®ç‡ â‰¥ 70%ï¼Œæå‰å‘ç°é£é™©
3. **å¯æ“ä½œæ€§**ï¼šAIç”Ÿæˆå…·ä½“å¯è¡Œçš„ä¼˜åŒ–å»ºè®®ï¼ŒROIè¯„ä¼°æ¸…æ™°
4. **å“åº”é€Ÿåº¦**ï¼šAPIå“åº”æ—¶é—´ â‰¤ 3ç§’

### æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**ï¼šFastAPI
- **æ•°æ®åº“**ï¼šPostgreSQL/MySQL (SQLAlchemy ORM)
- **AIæ¨¡å‹**ï¼šæ™ºè°±AI GLM-4-Plus
- **æµ‹è¯•æ¡†æ¶**ï¼šPytest
- **æ•°æ®ç±»å‹**ï¼šDecimalï¼ˆé‡‘èçº§ç²¾åº¦ï¼‰

---

## æ¶æ„è®¾è®¡

### ç³»ç»Ÿåˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          API Layer (FastAPI)        â”‚
â”‚  - æˆæœ¬é¢„æµ‹ç«¯ç‚¹                      â”‚
â”‚  - ä¼˜åŒ–å»ºè®®ç«¯ç‚¹                      â”‚
â”‚  - æˆæœ¬å¥åº·åº¦æŸ¥è¯¢                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Service Layer (ä¸šåŠ¡é€»è¾‘)      â”‚
â”‚  - CostPredictionService            â”‚
â”‚  - GLM5CostPredictor                â”‚
â”‚  - EVMCalculator (å¤ç”¨)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Data Layer (ORM Models)       â”‚
â”‚  - CostPrediction                   â”‚
â”‚  - CostOptimizationSuggestion       â”‚
â”‚  - EarnedValueData (å¤ç”¨)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Database (RDBMS)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
1. EVMæ•°æ®é‡‡é›† â†’ 2. AIåˆ†æé¢„æµ‹ â†’ 3. ç”Ÿæˆä¼˜åŒ–å»ºè®® â†’ 4. å®¡æ‰¹åˆ†é… â†’ 5. å®æ–½è·Ÿè¸ª
```

---

## æ•°æ®æ¨¡å‹

### 1. CostPredictionï¼ˆæˆæœ¬é¢„æµ‹è¡¨ï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨AIé¢„æµ‹çš„é¡¹ç›®æˆæœ¬å’Œé£é™©è¯„ä¼°ç»“æœ

**æ ¸å¿ƒå­—æ®µ**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | Integer | ä¸»é”® |
| `project_id` | Integer | é¡¹ç›®IDï¼ˆå¤–é”®ï¼‰ |
| `prediction_date` | Date | é¢„æµ‹æ—¥æœŸ |
| `prediction_version` | String | é¢„æµ‹ç‰ˆæœ¬ï¼ˆV1.0, V2.0...ï¼‰ |
| `predicted_eac` | Decimal(18,4) | é¢„æµ‹çš„å®Œå·¥ä¼°ç®— |
| `predicted_eac_confidence` | Decimal(5,2) | é¢„æµ‹ç½®ä¿¡åº¦ï¼ˆ0-100ï¼‰ |
| `overrun_probability` | Decimal(5,2) | è¶…æ”¯æ¦‚ç‡ï¼ˆ0-100%ï¼‰ |
| `expected_overrun_amount` | Decimal(18,4) | é¢„æœŸè¶…æ”¯é‡‘é¢ |
| `risk_level` | String | é£é™©ç­‰çº§ï¼ˆLOW/MEDIUM/HIGH/CRITICALï¼‰ |
| `risk_factors` | JSON | é£é™©å› ç´ åˆ—è¡¨ |
| `ai_analysis_summary` | Text | AIåˆ†ææ‘˜è¦ |
| `ai_insights` | JSON | AIæ´å¯Ÿï¼ˆç»“æ„åŒ–ï¼‰ |

**å…³é”®ç´¢å¼•**ï¼š
- `idx_cost_pred_project`ï¼šé¡¹ç›®ID
- `idx_cost_pred_date`ï¼šé¢„æµ‹æ—¥æœŸ
- `idx_cost_pred_risk_level`ï¼šé£é™©ç­‰çº§

**ç¤ºä¾‹æ•°æ®**ï¼š

```json
{
  "id": 1,
  "project_id": 123,
  "project_code": "PRJ-2026-001",
  "prediction_date": "2026-02-15",
  "prediction_version": "V1.0",
  "predicted_eac": 1066667.00,
  "predicted_eac_confidence": 75.00,
  "overrun_probability": 65.00,
  "expected_overrun_amount": 66667.00,
  "overrun_percentage": 6.67,
  "risk_level": "MEDIUM",
  "risk_score": 65.00,
  "risk_factors": [
    {
      "factor": "CPIæŒç»­ä¸‹é™",
      "impact": "HIGH",
      "weight": 0.35,
      "description": "è¿‡å»3ä¸ªæœˆCPIä»1.05é™è‡³0.92"
    }
  ]
}
```

### 2. CostOptimizationSuggestionï¼ˆæˆæœ¬ä¼˜åŒ–å»ºè®®è¡¨ï¼‰

**ç”¨é€”**ï¼šå­˜å‚¨AIç”Ÿæˆçš„æˆæœ¬ä¼˜åŒ–å»ºè®®å’Œå®æ–½è·Ÿè¸ª

**æ ¸å¿ƒå­—æ®µ**ï¼š

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | Integer | ä¸»é”® |
| `prediction_id` | Integer | å…³è”çš„é¢„æµ‹ID |
| `suggestion_code` | String | å»ºè®®ç¼–ç ï¼ˆå”¯ä¸€ï¼‰ |
| `suggestion_title` | String | å»ºè®®æ ‡é¢˜ |
| `suggestion_type` | String | ç±»å‹ï¼ˆRESOURCE_OPTIMIZATIONç­‰ï¼‰ |
| `priority` | String | ä¼˜å…ˆçº§ï¼ˆCRITICAL/HIGH/MEDIUM/LOWï¼‰ |
| `estimated_cost_saving` | Decimal(18,4) | é¢„è®¡æˆæœ¬èŠ‚çº¦ |
| `implementation_cost` | Decimal(18,4) | å®æ–½æˆæœ¬ |
| `roi_percentage` | Decimal(5,2) | æŠ•èµ„å›æŠ¥ç‡ï¼ˆ%ï¼‰ |
| `status` | String | çŠ¶æ€ï¼ˆPENDING/APPROVED/IN_PROGRESSç­‰ï¼‰ |
| `ai_confidence_score` | Decimal(5,2) | AIç½®ä¿¡åº¦ |

**å»ºè®®ç±»å‹æšä¸¾**ï¼š

- `RESOURCE_OPTIMIZATION`ï¼šèµ„æºä¼˜åŒ–
- `SCOPE_ADJUSTMENT`ï¼šèŒƒå›´è°ƒæ•´
- `PROCESS_IMPROVEMENT`ï¼šæµç¨‹æ”¹è¿›
- `VENDOR_NEGOTIATION`ï¼šä¾›åº”å•†è°ˆåˆ¤
- `SCHEDULE_OPTIMIZATION`ï¼šè¿›åº¦ä¼˜åŒ–

**å·¥ä½œæµçŠ¶æ€**ï¼š

```
PENDING â†’ APPROVED â†’ IN_PROGRESS â†’ COMPLETED
   â†“
REJECTED
```

---

## AIæœåŠ¡

### GLM5CostPredictor

**æ ¸å¿ƒæ–¹æ³•**ï¼š

#### 1. `predict_eac()`

é¢„æµ‹é¡¹ç›®æœ€ç»ˆæˆæœ¬ï¼ˆEAC - Estimate at Completionï¼‰

**è¾“å…¥**ï¼š
```python
{
  "project_data": {
    "project_code": "PRJ-001",
    "bac": 1000000,          # å®Œå·¥é¢„ç®—
    "current_cpi": 0.9375,   # å½“å‰æˆæœ¬ç»©æ•ˆæŒ‡æ•°
    "current_ac": 480000,    # å½“å‰å®é™…æˆæœ¬
    "current_ev": 450000     # å½“å‰æŒ£å¾—ä»·å€¼
  },
  "evm_history": [           # å†å²EVMæ•°æ®
    {"period": "2025-08", "cpi": 1.05, "spi": 0.98},
    {"period": "2025-09", "cpi": 1.02, "spi": 0.96},
    ...
  ]
}
```

**è¾“å‡º**ï¼š
```python
{
  "predicted_eac": 1066667.00,
  "confidence": 75.00,
  "eac_lower_bound": 1013334.00,   # ä¹è§‚æƒ…å†µ
  "eac_upper_bound": 1120000.00,   # æ‚²è§‚æƒ…å†µ
  "eac_most_likely": 1066667.00,   # æœ€å¯èƒ½å€¼
  "reasoning": "åŸºäºå½“å‰CPI=0.9375çš„è¶‹åŠ¿åˆ†æ...",
  "key_assumptions": ["CPIç»´æŒå½“å‰æ°´å¹³", "æ— é‡å¤§å˜æ›´"],
  "uncertainty_factors": ["å¸‚åœºæ³¢åŠ¨", "ä¾›åº”é“¾é£é™©"]
}
```

**é¢„æµ‹æ–¹æ³•**ï¼š

1. **AIæ–¹æ³•ï¼ˆä¼˜å…ˆï¼‰**ï¼šè°ƒç”¨GLM-5 APIï¼Œç»¼åˆåˆ†æ
   - å†å²CPI/SPIè¶‹åŠ¿
   - é¡¹ç›®å½“å‰é˜¶æ®µç‰¹ç‚¹
   - è¡Œä¸šç»éªŒå’Œç±»ä¼¼æ¡ˆä¾‹

2. **CPIæ–¹æ³•ï¼ˆå¤‡ç”¨ï¼‰**ï¼šä¼ ç»Ÿå…¬å¼
   ```
   EAC = AC + (BAC - EV) / CPI
   ```

#### 2. `analyze_cost_risks()`

åˆ†ææˆæœ¬è¶…æ”¯é£é™©

**è¾“å‡º**ï¼š
```python
{
  "overrun_probability": 65.00,      # è¶…æ”¯æ¦‚ç‡
  "risk_level": "MEDIUM",            # é£é™©ç­‰çº§
  "risk_score": 65.00,               # é£é™©è¯„åˆ†
  "risk_factors": [                  # é£é™©å› ç´ åˆ—è¡¨
    {
      "factor": "CPIæŒç»­ä¸‹é™",
      "impact": "HIGH",
      "weight": 0.35,
      "description": "è¿‡å»3ä¸ªæœˆCPIä»1.05é™è‡³0.92",
      "evidence": "å†å²æ•°æ®æ˜¾ç¤ºä¸‹é™è¶‹åŠ¿"
    }
  ],
  "cost_trend": "DECLINING",         # æˆæœ¬è¶‹åŠ¿
  "key_concerns": ["æˆæœ¬æ§åˆ¶ä¸åŠ›", "è¿›åº¦è½å"],
  "early_warning_signals": ["CPIä½äº0.95", "ACå¢é•¿ç‡è¶…é¢„æœŸ"]
}
```

**é£é™©ç­‰çº§åˆ¤å®š**ï¼š

| CPI | é£é™©ç­‰çº§ | è¶…æ”¯æ¦‚ç‡ |
|-----|---------|---------|
| â‰¥ 0.95 | LOW | 20% |
| 0.85-0.95 | MEDIUM | 50% |
| 0.75-0.85 | HIGH | 75% |
| < 0.75 | CRITICAL | 90% |

#### 3. `generate_optimization_suggestions()`

ç”Ÿæˆæˆæœ¬ä¼˜åŒ–å»ºè®®

**è¾“å‡º**ï¼š
```python
[
  {
    "title": "ä¸ä¸»è¦ä¾›åº”å•†é‡æ–°è°ˆåˆ¤",
    "type": "VENDOR_NEGOTIATION",
    "priority": "HIGH",
    "description": "å½“å‰ææ–™æˆæœ¬å æ€»æˆæœ¬35%ï¼Œä»·æ ¼é«˜äºå¸‚åœºå¹³å‡15%",
    "current_situation": "ä¸»è¦ä¾›åº”å•†Açš„é’¢æä»·æ ¼ä¸º5200å…ƒ/å¨...",
    "proposed_action": "1. æ”¶é›†3å®¶ä¾›åº”å•†æŠ¥ä»· 2. å‘èµ·è°ˆåˆ¤...",
    "implementation_steps": [
      {
        "step": 1,
        "action": "å¸‚åœºè°ƒç ”ï¼Œæ”¶é›†ç«å“æŠ¥ä»·",
        "duration_days": 5,
        "responsible": "é‡‡è´­éƒ¨"
      },
      {
        "step": 2,
        "action": "ä¸ä¾›åº”å•†Aé‡æ–°è°ˆåˆ¤",
        "duration_days": 7,
        "responsible": "é‡‡è´­ç»ç†"
      }
    ],
    "estimated_cost_saving": 50000.00,
    "implementation_cost": 5000.00,
    "roi_percentage": 900.00,
    "impact_on_schedule": "NEUTRAL",
    "implementation_risk": "LOW",
    "ai_confidence_score": 82.00
  }
]
```

### AIæç¤ºè¯å·¥ç¨‹

ç³»ç»Ÿä½¿ç”¨ç²¾å¿ƒè®¾è®¡çš„æç¤ºè¯ï¼ˆPromptï¼‰ï¼ŒåŒ…æ‹¬ï¼š

1. **è§’è‰²è®¾å®š**ï¼šèµ„æ·±é¡¹ç›®æˆæœ¬ç®¡ç†ä¸“å®¶
2. **ä»»åŠ¡æè¿°**ï¼šæ¸…æ™°çš„é¢„æµ‹/åˆ†æ/å»ºè®®ç”Ÿæˆç›®æ ‡
3. **ä¸Šä¸‹æ–‡ä¿¡æ¯**ï¼šé¡¹ç›®æ•°æ®ã€å†å²è¶‹åŠ¿ã€å½“å‰çŠ¶æ€
4. **è¾“å‡ºæ ¼å¼**ï¼šç»“æ„åŒ–JSONï¼Œä¾¿äºè§£æ
5. **çº¦æŸæ¡ä»¶**ï¼šå®é™…å¯æ“ä½œæ€§ã€æ•°æ®æ”¯æŒ

**ç¤ºä¾‹æç¤ºè¯ç‰‡æ®µ**ï¼š

```
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„é¡¹ç›®æˆæœ¬ç®¡ç†ä¸“å®¶ï¼Œç²¾é€šæŒ£å€¼ç®¡ç†ï¼ˆEVMï¼‰å’Œæˆæœ¬é¢„æµ‹ã€‚

# ä»»åŠ¡
åŸºäºé¡¹ç›®çš„å½“å‰çŠ¶æ€å’Œå†å²æ•°æ®ï¼Œé¢„æµ‹é¡¹ç›®çš„æœ€ç»ˆæˆæœ¬ï¼ˆEACï¼‰ã€‚

# é¡¹ç›®åŸºæœ¬ä¿¡æ¯
- é¡¹ç›®ç¼–å·ï¼šPRJ-2026-001
- å®Œå·¥é¢„ç®—ï¼ˆBACï¼‰ï¼š1,000,000 å…ƒ
- å½“å‰æˆæœ¬ç»©æ•ˆæŒ‡æ•°ï¼ˆCPIï¼‰ï¼š0.9375
...

# è¾“å‡ºè¦æ±‚
è¯·ä»¥JSONæ ¼å¼è¿”å›é¢„æµ‹ç»“æœï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
{
    "predicted_eac": <é¢„æµ‹çš„å®Œå·¥ä¼°ç®—>,
    "confidence": <ç½®ä¿¡åº¦ï¼ˆ0-100ï¼‰>,
    ...
}
```

---

## APIç«¯ç‚¹

### åŸºç¡€è·¯å¾„

```
/api/v1/projects/costs/
```

### 1. æˆæœ¬é¢„æµ‹ç«¯ç‚¹

#### POST `/predictions`

åˆ›å»ºæˆæœ¬é¢„æµ‹

**è¯·æ±‚ä½“**ï¼š
```json
{
  "project_id": 123,
  "prediction_version": "V1.0",
  "use_ai": true,
  "notes": "æœˆåº¦æˆæœ¬é¢„æµ‹"
}
```

**å“åº”**ï¼ˆ201 Createdï¼‰ï¼š
```json
{
  "id": 1,
  "project_id": 123,
  "project_code": "PRJ-2026-001",
  "prediction_date": "2026-02-15",
  "predicted_eac": 1066667.00,
  "predicted_eac_confidence": 75.00,
  "risk_level": "MEDIUM",
  "overrun_probability": 65.00,
  ...
}
```

#### GET `/predictions/{prediction_id}`

è·å–é¢„æµ‹è¯¦æƒ…

**å“åº”**ï¼ˆ200 OKï¼‰ï¼š
```json
{
  "id": 1,
  "predicted_eac": 1066667.00,
  "risk_factors": [...],
  "ai_analysis_summary": "...",
  "ai_insights": {...}
}
```

#### GET `/predictions/project/{project_id}/latest`

è·å–é¡¹ç›®æœ€æ–°é¢„æµ‹

#### GET `/predictions/project/{project_id}/history?limit=10`

è·å–é¢„æµ‹å†å²

**æŸ¥è¯¢å‚æ•°**ï¼š
- `limit`ï¼šè¿”å›æ•°é‡ï¼ˆ1-50ï¼Œé»˜è®¤10ï¼‰

#### POST `/predictions/{prediction_id}/approve`

å®¡æ‰¹é¢„æµ‹

### 2. ä¼˜åŒ–å»ºè®®ç«¯ç‚¹

#### GET `/predictions/{prediction_id}/suggestions`

è·å–ä¼˜åŒ–å»ºè®®åˆ—è¡¨

**æŸ¥è¯¢å‚æ•°**ï¼š
- `status_filter`ï¼šçŠ¶æ€ç­›é€‰ï¼ˆPENDING/APPROVEDç­‰ï¼‰
- `priority_filter`ï¼šä¼˜å…ˆçº§ç­›é€‰ï¼ˆHIGH/MEDIUMç­‰ï¼‰

**å“åº”**ï¼š
```json
[
  {
    "id": 1,
    "suggestion_code": "OPT-PRJ-001-202602-001",
    "suggestion_title": "ä¼˜åŒ–ä¾›åº”å•†é‡‡è´­",
    "priority": "HIGH",
    "estimated_cost_saving": 50000.00,
    "roi_percentage": 900.00,
    "status": "PENDING"
  }
]
```

#### GET `/suggestions/{suggestion_id}`

è·å–å»ºè®®è¯¦æƒ…

#### POST `/suggestions/{suggestion_id}/review`

å®¡æ ¸å»ºè®®

**è¯·æ±‚ä½“**ï¼š
```json
{
  "decision": "APPROVED",
  "comments": "åŒæ„å®æ–½"
}
```

#### POST `/suggestions/{suggestion_id}/assign`

åˆ†é…å»ºè®®

**è¯·æ±‚ä½“**ï¼š
```json
{
  "assigned_to": 456,
  "target_completion_date": "2026-03-15"
}
```

#### POST `/suggestions/{suggestion_id}/complete`

å®Œæˆå»ºè®®ï¼ˆè®°å½•å®æ–½ç»“æœï¼‰

**è¯·æ±‚ä½“**ï¼š
```json
{
  "actual_cost_saving": 52000.00,
  "actual_implementation_cost": 4800.00,
  "effectiveness_rating": 5,
  "lessons_learned": "ä¾›åº”å•†è°ˆåˆ¤æˆåŠŸï¼Œå®é™…èŠ‚çº¦è¶…å‡ºé¢„æœŸ"
}
```

### 3. æˆæœ¬å¥åº·åº¦ç«¯ç‚¹

#### GET `/projects/{project_id}/cost-health`

è·å–é¡¹ç›®æˆæœ¬å¥åº·åº¦

**å“åº”**ï¼š
```json
{
  "project_id": 123,
  "health_score": 65.0,
  "risk_level": "MEDIUM",
  "overrun_probability": 65.0,
  "expected_overrun_amount": 66667.00,
  "cost_trend": "DECLINING",
  "current_cpi": 0.9375,
  "suggestions_summary": {
    "pending": 3,
    "approved": 1,
    "in_progress": 2
  },
  "recommendation": "é¡¹ç›®æˆæœ¬å­˜åœ¨ä¸€å®šé£é™©ï¼Œå»ºè®®å…³æ³¨ä¼˜åŒ–å»ºè®®ã€‚"
}
```

**å¥åº·åº¦è¯„åˆ†è§„åˆ™**ï¼š

- åŸºç¡€åˆ†ï¼š100åˆ†
- æ‰£åˆ†é¡¹ï¼š
  - é£é™©ç­‰çº§ï¼šCRITICAL -40, HIGH -25, MEDIUM -10
  - CPI < 0.8: -20
  - CPI < 0.9: -10
  - æœ‰å¾…å¤„ç†å»ºè®®ï¼š-5

---

## ä½¿ç”¨æŒ‡å—

### å¿«é€Ÿå¼€å§‹

#### 1. é…ç½®AI APIå¯†é’¥

```bash
export GLM_API_KEY="your-glm-api-key"
```

æˆ–åœ¨`.env`æ–‡ä»¶ä¸­ï¼š
```
GLM_API_KEY=your-glm-api-key
```

#### 2. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç”Ÿæˆè¿ç§»è„šæœ¬
alembic revision --autogenerate -m "add cost prediction tables"

# æ‰§è¡Œè¿ç§»
alembic upgrade head
```

#### 3. åˆ›å»ºæˆæœ¬é¢„æµ‹

```python
from app.services.cost_prediction_service import CostPredictionService

service = CostPredictionService(db)

prediction = service.create_prediction(
    project_id=123,
    prediction_version="V1.0",
    use_ai=True,  # ä½¿ç”¨AIé¢„æµ‹
    created_by=1
)

print(f"é¢„æµ‹EAC: {prediction.predicted_eac}")
print(f"è¶…æ”¯é£é™©: {prediction.risk_level}")
```

### å…¸å‹ä¸šåŠ¡æµç¨‹

#### æœˆåº¦æˆæœ¬é¢„æµ‹æµç¨‹

```
1. PMOæ¯æœˆ15æ—¥è§¦å‘æˆæœ¬é¢„æµ‹
   â†“
2. ç³»ç»Ÿè·å–æœ€æ–°EVMæ•°æ®
   â†“
3. AIåˆ†æå¹¶ç”Ÿæˆé¢„æµ‹
   â†“
4. è‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–å»ºè®®ï¼ˆå¦‚é£é™©é«˜ï¼‰
   â†“
5. PMOå®¡æ‰¹é¢„æµ‹ç»“æœ
   â†“
6. é¡¹ç›®ç»ç†å®¡æ ¸å¹¶åˆ†é…ä¼˜åŒ–å»ºè®®
   â†“
7. è´£ä»»äººå®æ–½ä¼˜åŒ–æªæ–½
   â†“
8. è®°å½•å®æ–½æ•ˆæœ
```

#### è¶…æ”¯é¢„è­¦å“åº”æµç¨‹

```
æ£€æµ‹åˆ°é£é™©ç­‰çº§ = CRITICAL
   â†“
1. ç³»ç»Ÿè‡ªåŠ¨å‘é€é¢„è­¦é€šçŸ¥
   â†“
2. AIç”Ÿæˆç´§æ€¥ä¼˜åŒ–å»ºè®®
   â†“
3. PMOå’Œé¡¹ç›®ç»ç†ç´§æ€¥ä¼šè®®
   â†“
4. æ‰¹å‡†å¹¶å¿«é€Ÿå®æ–½ä¼˜åŒ–æªæ–½
   â†“
5. è·Ÿè¸ªå®æ–½æ•ˆæœ
```

### æœ€ä½³å®è·µ

1. **å®šæœŸé¢„æµ‹**ï¼šæ¯æœˆè‡³å°‘è¿›è¡Œä¸€æ¬¡æˆæœ¬é¢„æµ‹
2. **æ•°æ®è´¨é‡**ï¼šç¡®ä¿EVMæ•°æ®åŠæ—¶æ›´æ–°å’ŒéªŒè¯
3. **å»ºè®®è·Ÿè¸ª**ï¼šåŠæ—¶å®¡æ‰¹å’Œå®æ–½ä¼˜åŒ–å»ºè®®
4. **æ•ˆæœè¯„ä¼°**ï¼šå®Œæˆåè®°å½•å®é™…æ•ˆæœï¼Œåé¦ˆAIæ¨¡å‹
5. **è¶‹åŠ¿åˆ†æ**ï¼šå¯¹æ¯”å†å²é¢„æµ‹ï¼Œåˆ†æè¶‹åŠ¿å˜åŒ–

---

## æµ‹è¯•è¯´æ˜

### æµ‹è¯•è¦†ç›–

ç³»ç»ŸåŒ…å« **22ä¸ªæµ‹è¯•ç”¨ä¾‹**ï¼Œè¦†ç›–ï¼š

1. **æ•°æ®æ¨¡å‹æµ‹è¯•**ï¼ˆ6ä¸ªï¼‰
   - é¢„æµ‹è®°å½•åˆ›å»º
   - ä¼˜åŒ–å»ºè®®åˆ›å»º
   - å…³ç³»éªŒè¯
   - å·¥ä½œæµçŠ¶æ€è½¬æ¢

2. **AIæœåŠ¡æµ‹è¯•**ï¼ˆ6ä¸ªï¼‰
   - EACé¢„æµ‹ï¼ˆmockï¼‰
   - é£é™©åˆ†æï¼ˆmockï¼‰
   - ä¼ ç»Ÿæ–¹æ³•é¢„æµ‹
   - æ•°æ®è´¨é‡è¯„åˆ†

3. **APIç«¯ç‚¹æµ‹è¯•**ï¼ˆ7ä¸ªï¼‰
   - åˆ›å»ºé¢„æµ‹
   - æŸ¥è¯¢é¢„æµ‹
   - å®¡æ‰¹é¢„æµ‹
   - å»ºè®®ç®¡ç†
   - æˆæœ¬å¥åº·åº¦

4. **è¾¹ç•Œæ¡ä»¶æµ‹è¯•**ï¼ˆ3ä¸ªï¼‰
   - æ— EVMæ•°æ®
   - CPIä¸º0
   - æ•°æ®è´¨é‡è¾¹ç•Œ

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest tests/test_cost_prediction.py -v

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
pytest tests/test_cost_prediction.py::TestCostPredictionModel -v

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest tests/test_cost_prediction.py --cov=app.services.cost_prediction_service --cov-report=html
```

### Mockæµ‹è¯•è¯´æ˜

AIæœåŠ¡ä½¿ç”¨mocké¿å…å®é™…è°ƒç”¨APIï¼š

```python
@patch('app.services.cost_prediction_service.requests.post')
def test_predict_eac_with_mock(self, mock_post):
    # Mock APIå“åº”
    mock_response = Mock()
    mock_response.json.return_value = {
        "choices": [{
            "message": {
                "content": json.dumps({
                    "predicted_eac": 1066667,
                    "confidence": 75,
                    ...
                })
            }
        }]
    }
    mock_post.return_value = mock_response
    
    # æ‰§è¡Œæµ‹è¯•
    ...
```

---

## éƒ¨ç½²é…ç½®

### ç¯å¢ƒå˜é‡

```bash
# å¿…éœ€
GLM_API_KEY=your-glm-api-key

# å¯é€‰
GLM_API_BASE_URL=https://open.bigmodel.cn/api/paas/v4/chat/completions
GLM_MODEL=glm-4-plus
GLM_TIMEOUT=30
```

### æ•°æ®åº“è¿ç§»

```sql
-- ç¡®ä¿å·²æœ‰earned_value_dataè¡¨
-- åˆ›å»ºæ–°è¡¨
CREATE TABLE cost_prediction (...);
CREATE TABLE cost_optimization_suggestions (...);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_cost_pred_project ON cost_prediction(project_id);
CREATE INDEX idx_cost_pred_date ON cost_prediction(prediction_date);
...
```

### æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“ç´¢å¼•**ï¼šå·²é…ç½®å¿…è¦ç´¢å¼•
2. **AIç¼“å­˜**ï¼šç›¸åŒè¾“å…¥24å°æ—¶å†…ä½¿ç”¨ç¼“å­˜
3. **å¼‚æ­¥å¤„ç†**ï¼šå¤§æ‰¹é‡é¢„æµ‹ä½¿ç”¨å¼‚æ­¥ä»»åŠ¡
4. **åˆ†é¡µæŸ¥è¯¢**ï¼šå†å²æ•°æ®æŸ¥è¯¢æ”¯æŒåˆ†é¡µ

### ç›‘æ§æŒ‡æ ‡

å»ºè®®ç›‘æ§ï¼š

- AI APIè°ƒç”¨æˆåŠŸç‡
- é¢„æµ‹å“åº”æ—¶é—´ï¼ˆç›®æ ‡ â‰¤ 3ç§’ï¼‰
- é¢„æµ‹å‡†ç¡®ç‡ï¼ˆä¸å®é™…EACå¯¹æ¯”ï¼‰
- ä¼˜åŒ–å»ºè®®å®æ–½ç‡
- å®é™…æˆæœ¬èŠ‚çº¦é‡‘é¢

---

## é™„å½•

### A. é£é™©å› ç´ ç¤ºä¾‹

```json
{
  "risk_factors": [
    {
      "factor": "CPIæŒç»­ä¸‹é™",
      "impact": "HIGH",
      "weight": 0.35,
      "description": "è¿‡å»3ä¸ªæœˆCPIä»1.05é™è‡³0.92",
      "evidence": "å†å²EVMæ•°æ®"
    },
    {
      "factor": "ææ–™æˆæœ¬ä¸Šæ¶¨",
      "impact": "MEDIUM",
      "weight": 0.25,
      "description": "é’¢æä»·æ ¼ä¸Šæ¶¨15%",
      "evidence": "å¸‚åœºä»·æ ¼ç›‘æ§"
    },
    {
      "factor": "è¿›åº¦è½å",
      "impact": "MEDIUM",
      "weight": 0.20,
      "description": "SPI=0.90ï¼Œè½å10%",
      "evidence": "EVMæ•°æ®"
    }
  ]
}
```

### B. å¸¸è§é—®é¢˜

**Q1: AIé¢„æµ‹ä¸å‡†ç¡®æ€ä¹ˆåŠï¼Ÿ**

A: ç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°ä¼ ç»ŸCPIæ–¹æ³•ã€‚å»ºè®®æ£€æŸ¥ï¼š
- å†å²EVMæ•°æ®æ˜¯å¦å……è¶³ï¼ˆè‡³å°‘3æœŸï¼‰
- æ•°æ®æ˜¯å¦å·²éªŒè¯
- AI APIæ˜¯å¦æ­£å¸¸

**Q2: å¦‚ä½•æé«˜é¢„æµ‹å‡†ç¡®æ€§ï¼Ÿ**

A: 
- ç¡®ä¿EVMæ•°æ®åŠæ—¶æ›´æ–°
- å®šæœŸéªŒè¯æ•°æ®è´¨é‡
- ç§¯ç´¯å†å²æ•°æ®ï¼ˆ6æœŸä»¥ä¸Šæ›´ä½³ï¼‰
- è®°å½•ä¼˜åŒ–å»ºè®®å®æ–½æ•ˆæœ

**Q3: ä¼˜åŒ–å»ºè®®ä¸é€‚åˆé¡¹ç›®æ€ä¹ˆåŠï¼Ÿ**

A:
- å®¡æ ¸æ—¶å¯ä»¥"REJECTED"æ‹’ç»
- æˆ–æ ‡è®°ä¸º"NEED_MORE_INFO"è¦æ±‚è¡¥å……
- AIä¼šå­¦ä¹ å†å²å®¡æ ¸ç»“æœ

---

## å˜æ›´æ—¥å¿—

### V1.0 (2026-02-15)

- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- å®ç°AIæˆæœ¬é¢„æµ‹
- å®ç°ä¼˜åŒ–å»ºè®®ç”Ÿæˆ
- å®Œæˆ22ä¸ªæµ‹è¯•ç”¨ä¾‹
- å®ŒæˆæŠ€æœ¯æ–‡æ¡£

---

**æ–‡æ¡£ç»´æŠ¤**ï¼šTeam 2 - æˆæœ¬ç®¡ç†ç»„  
**æœ€åæ›´æ–°**ï¼š2026-02-15  
**ç‰ˆæœ¬**ï¼š1.0

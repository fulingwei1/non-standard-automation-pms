# 模块重组方案：成本报价、变更管理、进度跟踪独立成大模块

> **创建日期**：2026-01-14  
> **目的**：将成本报价、变更管理、进度跟踪独立成左侧栏的大模块，并整理相关功能

---

## 一、当前模块结构分析

### 1.1 当前一级模块（大模块）

根据 `frontend/src/components/layout/Sidebar.jsx` 的 `defaultNavGroups`，当前一级模块如下：

| 序号 | 一级模块 | 说明 |
|------|---------|------|
| 1 | **概览** | 工作台、大屏、预警、问题、通知、审批 |
| 2 | **项目管理** | PMO驾驶舱、看板、任务、立项、风险、结项、复盘等 |
| 3 | **采购管理** | 采购订单、物料成本、缺料管理、齐套管理 |
| 4 | **质量验收** | 验收管理、安装调试 |
| 5 | **AI人员匹配** | 标签字典、员工档案、人员需求、智能匹配 |
| 6 | **财务管理** | 财务成本 |
| 7 | **个人中心** | 工时填报、工作日志、知识管理、个人设置 |
| 8 | **系统管理** | 用户、角色、权限、客户、供应商、部门等 |

---

### 1.2 当前二级模块详细列表

#### 模块1：概览
- 管理员工作台
- 运营大屏
- 工作中心
- 预警中心
- 问题管理
- 通知中心
- 审批中心

#### 模块2：项目管理
- PMO 驾驶舱
- 项目看板
- 排期看板
- **任务中心** ⭐（进度跟踪相关）
- 立项管理
- 风险预警
- 项目结项
- 项目复盘
- 最佳实践
- 资源总览
- 项目周报

#### 模块3：采购管理
- 采购订单
- **物料成本** ⭐（成本相关）
- 缺料管理
- 齐套管理

#### 模块4：质量验收
- 验收管理
- 安装调试

#### 模块5：AI人员匹配
- 标签字典
- 员工档案
- 人员需求
- 智能匹配

#### 模块6：财务管理
- **财务成本** ⭐（成本相关）

#### 模块7：个人中心
- 工时填报
- 工作日志
- 知识管理
- 个人设置

#### 模块8：系统管理
- 用户管理
- 角色管理
- 权限管理
- 项目角色
- 问题模板
- 调度器监控
- 定时配置
- 客户管理
- 供应商管理
- 部门管理

---

## 二、需要抽取的功能分析

### 2.1 成本报价相关功能

#### 当前分布位置：
1. **销售管理模块**（销售菜单中）：
   - 报价管理 (`/sales/quotes`)
   - 报价成本管理 (`/sales/quotes/:id/cost`) ⭐
   - 报价成本分析 (`/sales/quotes/:id/cost-analysis`) ⭐
   - 物料成本 (`/sales/purchase-material-costs`) ⭐
   - 模板与CPQ (`/sales/templates`)

2. **采购管理模块**：
   - 物料成本 (`/sales/purchase-material-costs`) ⭐（重复）

3. **财务管理模块**：
   - 财务成本 (`/financial-costs`) ⭐

4. **采购工程师菜单**：
   - 成本控制：
     - 物料成本 ⭐
     - 预算管理 ⭐
     - 成本分析 ⭐

#### 需要抽取的功能：
- ✅ 报价管理（报价列表、报价详情）
- ✅ 报价成本管理（成本分解、成本检查、成本审批）
- ✅ 报价成本分析（成本趋势、成本对比）
- ✅ 物料成本管理
- ✅ 财务成本管理
- ✅ 成本预算管理
- ✅ 成本分析
- ✅ 报价模板与CPQ

---

### 2.2 变更管理相关功能

#### 当前分布位置：
1. **项目管理模块**（可能分散）：
   - ECN管理（需要查找具体路径）

2. **其他模块**：
   - 可能分散在项目详情、BOM管理等页面中

#### 需要抽取的功能：
- ✅ ECN管理（ECN列表、ECN详情）
- ✅ ECN申请
- ✅ ECN评估
- ✅ ECN审批
- ✅ ECN执行
- ✅ ECN影响分析
- ✅ ECN成本影响
- ✅ ECN进度影响
- ✅ ECN物料影响
- ✅ ECN任务管理

---

### 2.3 进度跟踪相关功能

#### 当前分布位置：
1. **项目管理模块**：
   - 任务中心 (`/tasks`) ⭐
   - 项目看板 (`/board`) ⭐
   - 排期看板 (`/schedule`) ⭐

2. **项目详情页面**：
   - 进度报告
   - 里程碑管理
   - WBS管理
   - 甘特图

3. **其他位置**：
   - 可能分散在项目详情、工作台等页面

#### 需要抽取的功能：
- ✅ 任务中心（任务列表、任务详情、任务分配）
- ✅ 进度填报（任务进度、里程碑进度）
- ✅ 进度看板（项目看板、排期看板）
- ✅ WBS管理（WBS模板、WBS分解）
- ✅ 里程碑管理（里程碑列表、里程碑跟踪）
- ✅ 进度报告（日报、周报、月报）
- ✅ 甘特图
- ✅ 进度预测
- ✅ 进度分析
- ✅ 依赖关系管理

---

## 三、重组后的模块结构

### 3.1 新增一级模块

#### 模块A：成本报价管理 ⭐ 新增

**二级模块**：
1. **报价管理**
   - 报价列表
   - 报价详情
   - 报价创建
   - 报价审批

2. **成本管理**
   - 报价成本管理
   - 报价成本分析
   - 物料成本管理
   - 财务成本管理
   - 成本预算管理
   - 成本分析

3. **模板与CPQ**
   - 报价模板
   - CPQ配置
   - 成本模板

---

#### 模块B：变更管理 ⭐ 新增

**二级模块**：
1. **ECN管理**
   - ECN列表
   - ECN详情
   - ECN申请
   - ECN查询

2. **ECN流程**
   - ECN评估
   - ECN审批
   - ECN执行
   - ECN关闭

3. **影响分析**
   - 成本影响分析
   - 进度影响分析
   - 物料影响分析
   - 综合影响分析

4. **ECN任务**
   - ECN执行任务
   - 任务跟踪

---

#### 模块C：进度跟踪 ⭐ 新增

**二级模块**：
1. **任务管理**
   - 任务中心
   - 任务列表
   - 任务详情
   - 任务分配

2. **进度填报**
   - 任务进度填报
   - 里程碑进度填报
   - 进度报告

3. **进度看板**
   - 项目看板
   - 排期看板
   - 甘特图

4. **WBS管理**
   - WBS模板
   - WBS分解
   - WBS查看

5. **里程碑管理**
   - 里程碑列表
   - 里程碑跟踪
   - 里程碑报告

6. **进度分析**
   - 进度预测
   - 进度分析
   - 依赖关系分析

---

### 3.2 调整后的完整模块结构

| 序号 | 一级模块 | 说明 | 状态 |
|------|---------|------|------|
| 1 | **概览** | 工作台、大屏、预警、问题、通知、审批 | 保留 |
| 2 | **项目管理** | PMO驾驶舱、立项、风险、结项、复盘等 | 调整（移除进度相关） |
| 3 | **成本报价管理** ⭐ | 报价、成本、模板 | **新增** |
| 4 | **变更管理** ⭐ | ECN管理、流程、影响分析 | **新增** |
| 5 | **进度跟踪** ⭐ | 任务、进度、看板、WBS、里程碑 | **新增** |
| 6 | **采购管理** | 采购订单、缺料、齐套 | 调整（移除成本相关） |
| 7 | **质量验收** | 验收管理、安装调试 | 保留 |
| 8 | **AI人员匹配** | 标签、档案、需求、匹配 | 保留 |
| 9 | **财务管理** | 财务成本（或合并到成本报价） | 调整 |
| 10 | **个人中心** | 工时、日志、知识、设置 | 保留 |
| 11 | **系统管理** | 用户、角色、权限等 | 保留 |

---

## 四、功能迁移清单

### 4.1 成本报价管理模块

#### 从销售管理模块迁移：
- [ ] `/sales/quotes` → `/cost-quote/quotes`（报价管理）
- [ ] `/sales/quotes/:id/cost` → `/cost-quote/cost-management`（报价成本管理）
- [ ] `/sales/quotes/:id/cost-analysis` → `/cost-quote/cost-analysis`（报价成本分析）
- [ ] `/sales/templates` → `/cost-quote/templates`（模板与CPQ）
- [ ] `/sales/purchase-material-costs` → `/cost-quote/material-costs`（物料成本）

#### 从采购管理模块迁移：
- [ ] `/sales/purchase-material-costs` → `/cost-quote/material-costs`（物料成本，去重）

#### 从财务管理模块迁移：
- [ ] `/financial-costs` → `/cost-quote/financial-costs`（财务成本）

#### 从采购工程师菜单迁移：
- [ ] 预算管理 → `/cost-quote/budget`（成本预算）
- [ ] 成本分析 → `/cost-quote/cost-analysis`（成本分析）

---

### 4.2 变更管理模块

#### 需要查找和迁移：
- [ ] `/ecn` → `/change-management/ecns`（ECN管理/列表）
- [ ] `/ecn/:id` → `/change-management/ecns/:id`（ECN详情）
- [ ] `/ecn-types` → `/change-management/ecn-types`（ECN类型管理）
- [ ] `/ecn/overdue-alerts` → `/change-management/ecns/overdue-alerts`（ECN逾期预警）
- [ ] `/ecn/statistics` → `/change-management/ecns/statistics`（ECN统计）

#### ECN详情页面的子功能（在ECNDetail组件中）：
- [ ] ECN基本信息 → `/change-management/ecns/:id/info`（ECN信息）
- [ ] ECN评估 → `/change-management/ecns/:id/evaluations`（ECN评估）
- [ ] ECN审批 → `/change-management/ecns/:id/approvals`（ECN审批）
- [ ] ECN执行任务 → `/change-management/ecns/:id/tasks`（ECN任务）
- [ ] ECN影响分析 → `/change-management/ecns/:id/impact-analysis`（影响分析）
- [ ] ECN集成 → `/change-management/ecns/:id/integration`（ECN集成）
- [ ] ECN知识库 → `/change-management/ecns/:id/knowledge`（ECN知识）
- [ ] ECN日志 → `/change-management/ecns/:id/logs`（ECN日志）

---

### 4.3 进度跟踪模块

#### 从项目管理模块迁移：
- [ ] `/tasks` → `/progress-tracking/tasks`（任务中心）
- [ ] `/board` → `/progress-tracking/board`（项目看板）
- [ ] `/schedule` → `/progress-tracking/schedule`（排期看板）

#### 从项目详情页面迁移：
- [ ] 进度报告功能 → `/progress-tracking/reports`（进度报告）
- [ ] 里程碑管理 → `/progress-tracking/milestones`（里程碑管理）
- [ ] WBS管理 → `/progress-tracking/wbs`（WBS管理）
- [ ] 甘特图 → `/progress-tracking/gantt`（甘特图）

#### 需要新增或整合：
- [ ] 进度填报 → `/progress-tracking/progress-entry`（进度填报）
- [ ] 进度预测 → `/progress-tracking/forecast`（进度预测）
- [ ] 进度分析 → `/progress-tracking/analysis`（进度分析）
- [ ] 依赖关系 → `/progress-tracking/dependencies`（依赖关系）

---

## 五、路由路径规划

### 5.1 成本报价管理模块路由

```
/cost-quote
├── /quotes                    # 报价列表
│   ├── /create               # 创建报价
│   └── /:id                  # 报价详情
│       ├── /cost             # 报价成本管理
│       ├── /cost-analysis    # 报价成本分析
│       └── /approval         # 报价审批
├── /cost-management          # 成本管理
│   ├── /material-costs       # 物料成本
│   ├── /financial-costs      # 财务成本
│   ├── /budget               # 成本预算
│   └── /analysis             # 成本分析
└── /templates                # 模板与CPQ
    ├── /quote-templates      # 报价模板
    ├── /cost-templates       # 成本模板
    └── /cpq-config           # CPQ配置
```

---

### 5.2 变更管理模块路由

```
/change-management
├── /ecns                     # ECN列表
│   ├── /create               # 创建ECN
│   └── /:id                  # ECN详情
│       ├── /evaluation       # ECN评估
│       ├── /approval         # ECN审批
│       ├── /execution        # ECN执行
│       ├── /cost-impact      # 成本影响
│       ├── /schedule-impact  # 进度影响
│       └── /material-impact # 物料影响
├── /impact-analysis          # 影响分析
│   ├── /cost                 # 成本影响分析
│   ├── /schedule             # 进度影响分析
│   └── /material             # 物料影响分析
└── /tasks                    # ECN任务
    └── /:id                  # ECN任务详情
```

---

### 5.3 进度跟踪模块路由

```
/progress-tracking
├── /tasks                    # 任务中心
│   ├── /list                 # 任务列表
│   └── /:id                  # 任务详情
├── /progress-entry           # 进度填报
│   ├── /task                 # 任务进度填报
│   └── /milestone            # 里程碑进度填报
├── /board                    # 进度看板
│   ├── /project              # 项目看板
│   └── /schedule             # 排期看板
├── /wbs                      # WBS管理
│   ├── /templates            # WBS模板
│   └── /:project_id          # 项目WBS
├── /milestones               # 里程碑管理
│   ├── /list                 # 里程碑列表
│   └── /:id                  # 里程碑详情
├── /reports                  # 进度报告
│   ├── /daily                # 日报
│   ├── /weekly               # 周报
│   └── /monthly              # 月报
├── /gantt                    # 甘特图
│   └── /:project_id          # 项目甘特图
├── /forecast                 # 进度预测
│   └── /:project_id          # 项目进度预测
├── /analysis                 # 进度分析
│   └── /:project_id          # 项目进度分析
└── /dependencies             # 依赖关系
    └── /:project_id          # 项目依赖关系
```

---

## 六、实施步骤

### Phase 1: 准备阶段（1-2天）

1. **代码分析**
   - [ ] 查找所有成本报价相关页面和组件
   - [ ] 查找所有变更管理相关页面和组件
   - [ ] 查找所有进度跟踪相关页面和组件
   - [ ] 整理路由依赖关系

2. **路由规划**
   - [ ] 确认新的路由路径
   - [ ] 规划路由重定向规则
   - [ ] 更新路由配置文件

---

### Phase 2: 成本报价模块（2-3天）

1. **创建新模块结构**
   - [ ] 创建 `/cost-quote` 路由组
   - [ ] 创建相关页面组件
   - [ ] 更新菜单配置

2. **迁移功能**
   - [ ] 迁移报价管理功能
   - [ ] 迁移成本管理功能
   - [ ] 迁移模板与CPQ功能
   - [ ] 更新API调用路径

3. **清理旧代码**
   - [ ] 从销售管理模块移除已迁移功能
   - [ ] 从采购管理模块移除已迁移功能
   - [ ] 从财务管理模块移除已迁移功能

---

### Phase 3: 变更管理模块（2-3天）

1. **创建新模块结构**
   - [ ] 创建 `/change-management` 路由组
   - [ ] 创建相关页面组件
   - [ ] 更新菜单配置

2. **迁移功能**
   - [ ] 迁移ECN管理功能
   - [ ] 迁移ECN流程功能
   - [ ] 迁移影响分析功能
   - [ ] 更新API调用路径

3. **清理旧代码**
   - [ ] 从项目管理模块移除已迁移功能

---

### Phase 4: 进度跟踪模块（2-3天）

1. **创建新模块结构**
   - [ ] 创建 `/progress-tracking` 路由组
   - [ ] 创建相关页面组件
   - [ ] 更新菜单配置

2. **迁移功能**
   - [ ] 迁移任务中心功能
   - [ ] 迁移进度填报功能
   - [ ] 迁移进度看板功能
   - [ ] 迁移WBS管理功能
   - [ ] 迁移里程碑管理功能
   - [ ] 更新API调用路径

3. **清理旧代码**
   - [ ] 从项目管理模块移除已迁移功能

---

### Phase 5: 测试与优化（2-3天）

1. **功能测试**
   - [ ] 测试所有迁移的功能
   - [ ] 测试路由重定向
   - [ ] 测试菜单导航

2. **优化**
   - [ ] 优化页面加载性能
   - [ ] 优化用户体验
   - [ ] 更新文档

---

## 七、注意事项

### 7.1 路由兼容性

- 需要保留旧路由的重定向，确保书签和外部链接可用
- 使用301永久重定向，告知搜索引擎路由变更

### 7.2 权限控制

- 确保新模块的权限配置正确
- 更新角色菜单配置
- 测试不同角色的访问权限

### 7.3 数据一致性

- 确保API路径变更不影响数据
- 确保数据库查询逻辑正确
- 确保前后端路由一致

### 7.4 用户体验

- 提供清晰的导航路径
- 保持页面风格一致
- 确保功能完整性

---

## 八、总结

### 8.1 新增模块

1. **成本报价管理**：整合所有成本报价相关功能
2. **变更管理**：整合所有ECN变更相关功能
3. **进度跟踪**：整合所有进度跟踪相关功能

### 8.2 模块数量变化

- **调整前**：8个一级模块
- **调整后**：11个一级模块（新增3个，调整3个）

### 8.3 预计工作量

- **总工作量**：约10-14天
- **Phase 1**：1-2天
- **Phase 2**：2-3天
- **Phase 3**：2-3天
- **Phase 4**：2-3天
- **Phase 5**：2-3天

---

**文档版本**：v1.0  
**创建日期**：2026-01-14  
**最后更新**：2026-01-14

# 产能优化建议

## 1. 产能分析框架

### 1.1 OEE (设备综合效率)

**OEE = 时间效率 × 性能效率 × 质量效率**

```python
def calculate_oee(resource, period):
    """计算OEE"""
    # 1. 时间效率 = 运行时间 / 计划生产时间
    planned_time = period.total_hours * 60  # 分钟
    downtime = sum([
        setup_time,
        breakdown_time,
        planned_maintenance
    ])
    operating_time = planned_time - downtime
    time_efficiency = operating_time / planned_time
    
    # 2. 性能效率 = (实际产量 × 标准节拍) / 运行时间
    actual_output = resource.actual_output
    standard_cycle_time = resource.standard_cycle_time
    ideal_cycle_time = actual_output * standard_cycle_time
    performance_efficiency = ideal_cycle_time / operating_time
    
    # 3. 质量效率 = 合格品数 / 总产量
    qualified_output = resource.qualified_output
    quality_efficiency = qualified_output / actual_output
    
    # OEE
    oee = time_efficiency * performance_efficiency * quality_efficiency
    
    return {
        'OEE': oee,
        'time_efficiency': time_efficiency,
        'performance_efficiency': performance_efficiency,
        'quality_efficiency': quality_efficiency,
        'level': get_oee_level(oee)
    }

def get_oee_level(oee):
    if oee >= 0.85: return '世界级'
    elif oee >= 0.75: return '优秀'
    elif oee >= 0.60: return '一般'
    else: return '需改进'
```

**案例分析**:
```
激光切割机 OEE分析 (本周)

计划生产时间: 2400分钟 (40小时)
├─ 停机时间: 360分钟 (15%)
│   ├─ 换型: 180分钟
│   ├─ 故障: 120分钟
│   └─ 保养: 60分钟
└─ 运行时间: 2040分钟 (85%)

实际产量: 1200件
标准节拍: 1.5分钟/件
理想节拍时间: 1800分钟
性能效率: 1800/2040 = 88.2%

合格品: 1152件
质量效率: 1152/1200 = 96%

OEE = 85% × 88.2% × 96% = 72%

改进方向:
1. 时间效率 85% → 90% (减少换型和故障)
2. 性能效率 88% → 95% (提升切割速度)
3. 质量效率 96% → 98% (减少废品)
目标OEE: 84% (+12%)
```

---

## 2. 瓶颈优化

### 2.1 瓶颈识别

**TOC五步聚焦法**:
```
1. 识别系统瓶颈
   → 利用率>95%的资源

2. 决定如何充分利用瓶颈
   → 瓶颈100%投入生产时间

3. 其他一切服从瓶颈
   → 非瓶颈工序根据瓶颈节拍

4. 提升瓶颈能力
   → 增加资源/改进工艺

5. 回到步骤1
   → 持续改进
```

**瓶颈分析工具**:
```python
def identify_bottleneck(workshop_id):
    """识别瓶颈资源"""
    resources = get_workshop_resources(workshop_id)
    
    utilization_data = []
    for resource in resources:
        utilization = calculate_utilization(resource)
        utilization_data.append({
            'resource': resource.name,
            'utilization': utilization,
            'capacity': resource.capacity,
            'demand': resource.demand,
            'is_bottleneck': utilization > 0.95
        })
    
    # 按利用率排序
    utilization_data.sort(key=lambda x: x['utilization'], reverse=True)
    
    return utilization_data
```

### 2.2 瓶颈提升策略

**短期措施 (1周内)**:
```
1. 延长工作时间
   └─ 瓶颈设备优先加班

2. 减少停机
   └─ 最小化换型/保养时间

3. 外协加工
   └─ 部分工作外包

4. 提高良率
   └─ 减少瓶颈返工
```

**中期措施 (1-3个月)**:
```
1. 工艺优化
   └─ 提升瓶颈工序速度

2. 技能培训
   └─ 培养多能工

3. 优化排程
   └─ 瓶颈工序优先排程

4. 改善布局
   └─ 减少搬运时间
```

**长期措施 (>3个月)**:
```
1. 增加设备
   └─ 购置第2台瓶颈设备

2. 自动化改造
   └─ 提升效率50%+

3. 供应商培养
   └─ 建立外协网络

4. 技术创新
   └─ 新工艺/新材料
```

**ROI分析**:
```
方案对比 (瓶颈: 激光切割机)

方案A: 延长工作时间 (加班2h/天)
├─ 投资: 0.5万元/月 (加班费)
├─ 产能提升: 25%
├─ ROI: 立即见效
└─ 推荐度: ★★★★★ (短期首选)

方案B: 外协加工 (20%工作量)
├─ 投资: 2万元/月 (外协费)
├─ 产能提升: 20%
├─ ROI: 立即见效,成本较高
└─ 推荐度: ★★★★☆ (灵活调整)

方案C: 工艺优化 (提速10%)
├─ 投资: 5万元 (一次性)
├─ 产能提升: 10%
├─ ROI: 6个月回收
└─ 推荐度: ★★★★☆ (中期方案)

方案D: 增加设备
├─ 投资: 50万元
├─ 产能提升: 100%
├─ ROI: 18个月回收
└─ 推荐度: ★★★☆☆ (长期投资)

建议: 短期A+B, 中期C, 长期D
```

---

## 3. 换型优化 (SMED)

### 3.1 SMED 快速换模法

**目标**: 将换型时间减少50%以上

**四步法**:
```
1. 区分内外作业
   ├─ 内作业 (停机才能做): 拆卸/安装
   └─ 外作业 (运行时做): 准备工具/预热

2. 内作业转外作业
   ├─ 提前准备模具/夹具
   └─ 预装配

3. 缩短内作业时间
   ├─ 快速锁紧装置
   ├─ 标准化作业
   └─ 减少调整

4. 缩短外作业时间
   ├─ 工具定置管理
   └─ 并行作业
```

**案例**:
```
焊接机换型优化

改进前:
├─ 总时间: 30分钟
├─ 拆卸旧夹具: 8分钟
├─ 安装新夹具: 10分钟
├─ 调试: 8分钟
└─ 首件确认: 4分钟

分析:
├─ 内作业: 18分钟 (拆卸+安装)
├─ 外作业: 12分钟 (调试+确认)
└─ 浪费: 找工具3分钟, 重复调整5分钟

改进后:
├─ 总时间: 10分钟 (-67%)
├─ 外作业前置:
│   └─ 新夹具预装配 (运行时完成)
├─ 快速锁紧:
│   └─ 螺栓改快速插销 (8分钟→2分钟)
├─ 标准化:
│   └─ 调试参数保存 (8分钟→3分钟)
└─ 工具定置:
    └─ 找工具时间为0

效果:
每次节省20分钟
每月换型40次
月节省: 800分钟 = 13.3小时
年产能提升: 160小时
```

### 3.2 换型标准化

**换型作业指导书**:
```
焊接机换型SOP (目标时间: 10分钟)

外作业 (提前准备):
□ 准备新夹具 (已装配)
□ 工具摆放就位
□ 首件样品准备
□ 工艺参数调出

内作业 (停机作业):
Step 1: 拆卸 (2分钟)
  □ 1.1 松开快速插销 (4个)
  □ 1.2 取下旧夹具
  □ 1.3 清洁工作台面

Step 2: 安装 (2分钟)
  □ 2.1 放置新夹具
  □ 2.2 锁紧快速插销
  □ 2.3 连接气路/电路

Step 3: 调试 (3分钟)
  □ 3.1 加载工艺参数
  □ 3.2 试运行 (空载)
  □ 3.3 微调确认

Step 4: 首件 (3分钟)
  □ 4.1 生产首件
  □ 4.2 质检确认
  □ 4.3 批量生产

注意事项:
⚠️ 快速插销定期检查
⚠️ 工艺参数及时保存
⚠️ 安全第一
```

---

## 4. 人员效率提升

### 4.1 多能工培养

**技能矩阵**:
```
       焊接  组装  测试  切割  打磨
张三    ★★★  ★★   ★    -     ★★
李四    ★★   ★★★  ★★   ★     ★
王五    ★     ★★   ★★★  ★★★  ★★
赵六    ★★   ★    ★★   ★★   ★★★

★★★ 熟练 (可独立+指导)
★★  合格 (可独立操作)
★   初级 (需要指导)
-   未培训

目标:
每人掌握3个工序 (★★以上)
```

**培养计划**:
```
张三技能提升计划 (Q1)

现状: 焊接★★★, 组装★★, 测试★
目标: 测试★★ (独立操作)

培训计划:
├─ Week 1-2: 理论培训
│   └─ 测试原理/标准/设备操作
├─ Week 3-4: 实操训练
│   └─ 跟随王五(测试★★★)学习
├─ Week 5-6: 独立操作
│   └─ 师傅旁站指导
└─ Week 7-8: 考核认证
    └─ 理论+实操考试

考核标准:
✅ 理论考试≥80分
✅ 实操合格率≥95%
✅ 效率达标准的80%

完成奖励: 500元 + 技能津贴200元/月
```

### 4.2 标准作业

**三要素**:
1. **节拍时间** (Takt Time)
   = 可用时间 / 客户需求量

2. **作业顺序** (标准化)
   = 最优操作步骤

3. **标准手持** (WIP)
   = 最少在制品

**标准作业组合票**:
```
工序: 焊接组装
节拍时间: 5分钟/件
作业时间: 4.5分钟 (90%)

步骤  作业内容         时间    备注
1    取料放置         0.3分   右手取,左手放
2    定位夹紧         0.5分   快速夹具
3    焊接(自动)       2.5分   机器自动
4    检查焊点         0.8分   目视+触摸
5    取下成品         0.2分   放置周转箱
6    记录报工         0.2分   扫码报工
──────────────────────────────────
合计                 4.5分   

标准手持:
├─ 待焊工件: 10件
├─ 焊接中: 1件
└─ 待检工件: 5件
总计: 16件 (约1小时库存)
```

### 4.3 动作经济原则

**22条原则 (精选)**:
```
1. 双手同时动作
   ❌ 错误: 右手取料,左手空闲
   ✅ 正确: 右手取料,左手放置

2. 动作对称
   ✅ 左右手动作相反且对称

3. 减少动作等级
   等级1: 手指 (最省力)
   等级2: 手腕
   等级3: 前臂
   等级4: 上臂
   等级5: 躯干 (最费力)

4. 利用惯性
   ✅ 滑道/重力自动下料

5. 减少寻找
   ✅ 固定位置,颜色区分

6. 工具就近
   ✅ 触手可及范围内
```

**改善案例**:
```
改进前: 螺丝拧紧作业
├─ 动作: 取螺丝→放置→拿起电批→拧紧→放下电批
└─ 时间: 15秒

问题分析:
❌ 电批需拿起/放下 (浪费)
❌ 螺丝需逐个取 (效率低)

改进后:
├─ 电批悬挂 (弹簧平衡器)
├─ 螺丝自动送料器
└─ 时间: 6秒 (-60%)

投资: 800元
月节省: 60小时
ROI: 2个月
```

---

## 5. 设备管理

### 5.1 TPM 全员生产维护

**TPM八大支柱**:
```
1. 个别改善 (持续改进)
2. 自主保全 (操作工日常维护)
3. 计划保全 (定期专业保养)
4. 质量保全 (防止质量问题)
5. 初期管理 (新设备管理)
6. 教育训练 (技能提升)
7. 事务改善 (管理效率)
8. 安全环境 (安全第一)
```

**自主保全7步骤**:
```
Step 1: 初期清扫
└─ 彻底清扫,发现问题

Step 2: 发生源/困难部位对策
└─ 消除污染源,改善难清扫部位

Step 3: 制定清扫/点检基准
└─ 5分钟清扫,标准化

Step 4: 总点检
└─ 学习设备结构/原理

Step 5: 自主点检
└─ 操作工独立点检

Step 6: 标准化
└─ 固化最佳实践

Step 7: 自主管理
└─ 持续改进
```

### 5.2 预防性维护

**保养计划**:
```
激光切割机保养计划

日保养 (操作工,5分钟):
□ 清洁工作台
□ 检查气压/水位
□ 润滑导轨
□ 记录运行参数

周保养 (操作工,30分钟):
□ 清洁镜片
□ 检查冷却系统
□ 检查传动带张紧度
□ 校准对焦

月保养 (维修工,2小时):
□ 更换过滤器
□ 检查激光管
□ 校准精度
□ 备件检查

年保养 (专业服务,1天):
□ 大修
□ 激光管更换
□ 全面校准
□ 性能测试
```

**故障预防**:
```
预防性维护 vs 事后维修

预防性维护:
├─ 停机时间: 计划内,影响小
├─ 维修成本: 低 (换件+人工)
├─ 产能损失: 最小 (可提前调整排程)
└─ 总成本: ¥5,000/年

事后维修 (故障后修):
├─ 停机时间: 不可预测,影响大
├─ 维修成本: 高 (紧急件+加班)
├─ 产能损失: 严重 (打乱排程)
└─ 总成本: ¥25,000/年

投资回报:
预防性维护投入 ¥8,000/年
避免损失 ¥20,000/年
ROI: 150%
```

---

## 6. 布局优化

### 6.1 精益布局原则

```
1. 按流程布局
   ✅ 单向流动,减少回流

2. U型布局
   ✅ 入口/出口靠近,便于协作

3. 单元式生产
   ✅ 小批量,快速流转

4. 设备就近
   ✅ 减少搬运

5. 可视化
   ✅ 进度一目了然
```

**改善案例**:
```
改进前: 直线型布局
原材料 → 切割 → 焊接 → 打磨 → 组装 → 测试 → 成品

问题:
❌ 搬运距离长 (200米)
❌ 在制品堆积
❌ 信息传递慢

改进后: U型单元
        测试 ← 组装
         ↑      ↓
       成品    打磨
         ↑      ↓
     原材料 → 切割 → 焊接

效果:
✅ 搬运距离: 200米 → 50米 (-75%)
✅ 在制品: 500件 → 100件 (-80%)
✅ 生产周期: 5天 → 2天 (-60%)
✅ 沟通效率大幅提升
```

### 6.2 5S现场管理

```
1S 整理 (Seiri)
└─ 区分要与不要,清除不要

2S 整顿 (Seiton)
└─ 定位定量,标识清晰

3S 清扫 (Seiso)
└─ 清扫点检,保持整洁

4S 清洁 (Seiketsu)
└─ 标准化,制度化

5S 素养 (Shitsuke)
└─ 养成习惯,持续改进
```

**实施要点**:
```
整理:
├─ 红牌作战 (1周不用→黄区,1月不用→红区→清理)
└─ 目标: 减少30%物品

整顿:
├─ 定位: 画线/标识
├─ 定量: 最大/最小库存
├─ 定容: 统一容器
└─ 目标: 30秒内找到任何物品

清扫:
├─ 每日5分钟清扫
├─ 清扫即点检
└─ 发现隐患

清洁:
├─ 制定清扫基准
├─ 责任到人
└─ 定期检查

素养:
├─ 培训教育
├─ 激励机制
└─ 持续改进
```

---

## 7. 数字化赋能

### 7.1 IoT设备监控

**实时数据采集**:
```python
# 设备数据采集
sensors = {
    '温度': {'value': 350.5, 'unit': '℃', 'threshold': [340, 360]},
    '压力': {'value': 0.6, 'unit': 'MPa', 'threshold': [0.5, 0.7]},
    '振动': {'value': 2.3, 'unit': 'mm/s', 'threshold': [0, 5.0]},
    '电流': {'value': 15.2, 'unit': 'A', 'threshold': [10, 20]}
}

# 异常检测
for sensor, data in sensors.items():
    if data['value'] < data['threshold'][0] or \
       data['value'] > data['threshold'][1]:
        alert(f'{sensor}异常: {data["value"]}{data["unit"]}')
```

**预测性维护**:
```python
# 基于机器学习的故障预测
from sklearn.ensemble import RandomForestClassifier

def predict_failure(sensor_data, model):
    """预测设备故障"""
    features = extract_features(sensor_data)
    failure_probability = model.predict_proba(features)[0][1]
    
    if failure_probability > 0.7:
        return {
            'alert_level': 'HIGH',
            'message': f'故障概率{failure_probability*100:.1f}%,建议维护',
            'recommended_action': '计划停机维护'
        }
    elif failure_probability > 0.4:
        return {
            'alert_level': 'MEDIUM',
            'message': '趋势异常,重点监控'
        }
    
    return {'alert_level': 'LOW'}
```

### 7.2 数据驱动决策

**产能仪表盘**:
```
实时产能监控
┌─────────────────────────────────────┐
│ 车间A - 2026-02-17 14:30            │
├─────────────────────────────────────┤
│ 今日目标: 500件                     │
│ 实际完成: 285件 (57%)  🟡           │
│ 预计完成: 480件 (96%)  🟢           │
│                                     │
│ OEE: 75% ▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░      │
│ ├─ 时间: 85% 🟢                     │
│ ├─ 性能: 90% 🟢                     │
│ └─ 质量: 98% 🟢                     │
│                                     │
│ 瓶颈设备: 激光切割机 (利用率98%)    │
│ 建议: 加班1小时可达成目标           │
└─────────────────────────────────────┘
```

---

## 8. 持续改进

### 8.1 KAIZEN (改善)

**小改善,大效果**:
```
日常改善示例:

改善1: 工具定置
投资: ¥50 (工具板)
效果: 找工具时间 5分钟→0分钟
年节约: 200小时

改善2: 滑道送料
投资: ¥200 (PVC管)
效果: 取料时间 3秒→0.5秒
年节约: 80小时

改善3: 脚踏开关
投资: ¥150
效果: 解放双手,效率提升10%
年节约: 150小时

总投资: ¥400
总节约: 430小时 = ¥21,500
ROI: 1周回收
```

### 8.2 改善提案制度

**激励机制**:
```
提案奖励标准:

A级 (重大改善):
├─ 标准: 年节约>10万元
├─ 奖励: 节约额的10% (最高5万)
└─ 荣誉: 年度创新奖

B级 (显著改善):
├─ 标准: 年节约1-10万元
├─ 奖励: 2000-5000元
└─ 荣誉: 季度改善明星

C级 (一般改善):
├─ 标准: 年节约<1万元
├─ 奖励: 200-1000元
└─ 荣誉: 月度改善之星

鼓励奖 (未实施):
└─ 奖励: 50元/个
```

---

## 9. 检查清单

### 产能诊断清单

**设备效率**:
- [ ] OEE > 75%?
- [ ] 故障停机 < 5%?
- [ ] 换型时间 < 10分钟?
- [ ] 性能达标 > 90%?

**人员效率**:
- [ ] 多能工比例 > 50%?
- [ ] 标准作业覆盖率 100%?
- [ ] 培训计划执行率 > 90%?

**流程效率**:
- [ ] 瓶颈利用率 < 90%?
- [ ] 在制品周转 < 3天?
- [ ] 单件流 or 小批量?

**管理效率**:
- [ ] 5S评分 > 85分?
- [ ] 改善提案 > 10个/月?
- [ ] 可视化管理?

---

## 10. 版本历史

| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2026-02-16 | 初始版本 |

# 排程员操作手册

## 1. 角色职责
- ✅ 制定生产排程计划
- ✅ 优化资源分配
- ✅ 处理排程冲突
- ✅ 监控产能负荷
- ✅ 应急调整排程

## 2. 核心操作

### 2.1 创建排程计划
**路径**: 生产管理 > 排程计划 > 新建

**步骤**:
1. 选择车间和日期
2. 导入待排程订单
3. 选择排程策略:
   - 手动排程
   - AI智能排程 (推荐)
   - 混合模式
4. 设置约束条件
5. 生成排程方案
6. 预览甘特图
7. 确认发布

### 2.2 AI智能排程
**算法选择**:
- 遗传算法 (推荐): 复杂场景，多目标优化
- 贪心算法: 简单快速，优先级优先
- FIFO: 先进先出

**优化目标**:
- 最小化总完工时间 (Makespan)
- 最大化资源利用率
- 最小化延期惩罚

**约束条件**:
```
✅ 技能匹配
✅ 设备可用性
✅ 最大加班2小时/天
✅ 严格遵守交期
✅ 同一项目工序顺序
```

**运行示例**:
```
AI排程中... 进度: 78%
已迭代: 156/200代
当前最优解:
  - 总完工时间: 8.5小时
  - 资源利用率: 87%
  - 适应度分数: 0.92
```

**结果对比**:
| 指标 | 手动排程 | AI排程 | 改善 |
|------|---------|--------|------|
| 完工时间 | 10.2h | 8.5h | 16.7%↑ |
| 利用率 | 75% | 87% | 16.0%↑ |
| 延期数 | 3 | 0 | 100%↓ |

### 2.3 资源分配
**查看资源负荷**:
```
资源负荷热力图 (本周)
        周一  周二  周三  周四  周五
张三    🔴95% 🔴98% 🟢70% 🟡85% 🟢75%
李四    🟢60% 🟢65% 🟢70% 🟢75% 🟡80%
焊机01  🔴97% 🔴99% 🔴95% 🔴96% 🔴98% ← 瓶颈!
切割机  🟢55% 🟢60% 🟢58% 🟢62% 🟢65%

🟢 正常(<80%)  🟡 预警(80-90%)  🔴 超载(>90%)
```

**负荷均衡**:
1. 识别瓶颈资源 (利用率>90%)
2. 将工单转移到低负荷资源
3. 或调整工单时序
4. 系统自动重新计算

### 2.4 冲突处理
**常见冲突**:
- ⚠️ 资源冲突: 2个工单同时需要同一设备
- ⚠️ 技能不匹配: 工人不具备所需技能
- ⚠️ 时间重叠: 同一工人被分配多个任务

**自动检测**:
系统自动高亮冲突工单，提示解决方案：
```
⚠️ 资源冲突检测到!
工单WO-001 与 WO-005 同时需要焊机01
建议方案:
  方案A: 将WO-005推迟2小时
  方案B: 使用备用焊机02
  方案C: 延长WO-001工期至周六
```

## 3. 排程调整

### 3.1 插单处理
**场景**: 紧急订单需插入当前排程

**步骤**:
1. 评估紧急订单:
   - 工时需求
   - 交期要求
   - 资源需求
2. 选择插入策略:
   - 延后低优先级工单
   - 利用空闲时段
   - 增加加班时间
3. 重新优化排程
4. 通知受影响工单的责任人

### 3.2 异常调整
**常见异常**:
- 设备故障
- 人员请假
- 物料短缺
- 质量问题导致返工

**应急处理**:
```
异常处理向导
1. 选择异常类型: [设备故障]
2. 影响资源: [焊机01]
3. 预计停机时间: [4小时]
4. 系统自动分析影响范围
5. 提供调整方案:
   - 转移5个工单到焊机02
   - 延后3个低优先级工单
   - 预计总延期1.5小时
6. 确认应用调整
```

## 4. 产能分析

### 4.1 产能预测
**查看未来7天产能**:
```
未来产能预测
日期      订单  预计工时  可用产能  负荷率  状态
2/17(一)   15    240h      320h     75%   🟢 充足
2/18(二)   18    288h      320h     90%   🟡 偏紧
2/19(三)   22    352h      320h    110%   🔴 超载! ← 需调整
```

**超载处理**:
- 增加加班
- 外协加工
- 推迟非紧急订单

### 4.2 瓶颈识别
**关键路径分析**:
系统自动识别关键工序（Float时间=0）：
```
关键路径:
工序1(焊接) → 工序3(组装) → 工序5(测试)
Total: 8.5小时

非关键路径:
工序2(打磨) → 工序4(喷涂)
Float: 2小时 (可延后2小时而不影响总工期)
```

**瓶颈资源**:
- 自动标记利用率>95%的资源
- 分析瓶颈原因
- 提供优化建议

## 5. 甘特图操作

### 5.1 查看甘特图
**视图切换**:
- 日视图
- 周视图
- 月视图

**颜色标识**:
- 🟢 绿色: 正常进行
- 🟡 黄色: 轻微延迟
- 🔴 红色: 严重延迟
- ⚪ 灰色: 未开始

### 5.2 拖拽调整
**操作**:
- 拖拽工单条调整时间
- 拉伸工单条调整工期
- 双击编辑详情

**自动检查**:
系统实时检查冲突：
```
⚠️ 检测到冲突!
工单WO-003 新时间与 WO-007 重叠
是否继续? [取消] [强制保存] [自动调整]
```

## 6. 报表与统计

### 6.1 排程效果分析
**每周统计**:
- 计划准确率
- 准时完工率
- 资源利用率
- 排程变更次数

### 6.2 优化建议
系统AI自动分析并提供建议：
```
本周优化建议:
1. 焊机01利用率98%，建议增加设备
2. 李四利用率仅60%，可承担更多任务
3. 周三产能超载10%，建议调整至周四
4. 组装工序成为瓶颈，建议增加人手
```

## 7. 最佳实践

### 7.1 排程原则
✅ 高优先级订单优先
✅ 同一项目工序连续排程
✅ 技能匹配优先于负荷均衡
✅ 预留15%缓冲时间应对异常
✅ 避免单一资源过度依赖

### 7.2 效率提升
- 使用模板快速创建重复性排程
- 批量操作减少重复工作
- 利用快捷键提升操作速度
- 定期优化排程参数

## 8. 常见问题

**Q1: AI排程需要多久？**
A: 通常1-2分钟，复杂场景可能需要3-5分钟。

**Q2: 如何处理突发插单？**
A: 使用"紧急插单"功能，系统自动评估影响并提供方案。

**Q3: 排程发布后能否修改？**
A: 可以，但需通知已派工的工人，建议谨慎修改。

**Q4: 如何提高排程准确率？**
A: 定期维护标准工时、及时更新资源状态、使用AI优化。

## 9. 技术支持
- 排程顾问: 内线7777
- IT支持: 内线8888

## 10. 版本历史
| 版本 | 日期 | 说明 |
|------|------|------|
| v1.0 | 2026-02-16 | 初始版本 |

# å‰ç«¯åŸºç¡€è®¾æ–½æµ‹è¯•åˆ›å»ºæŠ¥å‘Š

> åˆ›å»ºæ—¥æœŸï¼š2026-01-23  
> æµ‹è¯•æ¡†æ¶ï¼šVitest + @testing-library/react

---

## ä¸€ã€æµ‹è¯•æ–‡ä»¶æ¸…å•

### âœ… Hooks æµ‹è¯•ï¼ˆ4ä¸ªæ–‡ä»¶ï¼‰

1. **useDataLoader.test.ts**
   - ä½ç½®ï¼š`frontend/src/core/hooks/__tests__/useDataLoader.test.ts`
   - æµ‹è¯•ç”¨ä¾‹ï¼š6ä¸ª
   - è¦†ç›–åŠŸèƒ½ï¼š
     - æ•°æ®åŠ è½½æˆåŠŸ
     - åŠ è½½çŠ¶æ€å¤„ç†
     - é”™è¯¯çŠ¶æ€å¤„ç†
     - enabled é€‰é¡¹
     - æ‰‹åŠ¨åˆ·æ–°
     - è‡ªåŠ¨é‡è¯•ï¼ˆuseDataLoaderWithRetryï¼‰

2. **usePaginatedData.test.ts**
   - ä½ç½®ï¼š`frontend/src/core/hooks/__tests__/usePaginatedData.test.ts`
   - æµ‹è¯•ç”¨ä¾‹ï¼š8ä¸ª
   - è¦†ç›–åŠŸèƒ½ï¼š
     - åˆå§‹åŒ–é»˜è®¤å€¼
     - åˆ†é¡µæ•°æ®åŠ è½½
     - é¡µç å˜æ›´
     - ç­›é€‰å˜æ›´
     - å…³é”®è¯å˜æ›´
     - æ’åºå˜æ›´
     - é‡ç½®ç­›é€‰
     - enabled é€‰é¡¹

3. **useForm.test.ts**
   - ä½ç½®ï¼š`frontend/src/core/hooks/__tests__/useForm.test.ts`
   - æµ‹è¯•ç”¨ä¾‹ï¼š11ä¸ª
   - è¦†ç›–åŠŸèƒ½ï¼š
     - åˆå§‹åŒ–é»˜è®¤å€¼
     - å­—æ®µå˜æ›´
     - é”™è¯¯æ¸…é™¤
     - è¡¨å•éªŒè¯
     - è¡¨å•æäº¤ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
     - è¡¨å•é‡ç½®
     - resetOnSuccess é€‰é¡¹
     - å­—æ®µå€¼è®¾ç½®
     - å­—æ®µè§¦æ‘¸çŠ¶æ€
     - å­—æ®µé”™è¯¯è·å–

4. **useTable.test.ts**
   - ä½ç½®ï¼š`frontend/src/core/hooks/__tests__/useTable.test.ts`
   - æµ‹è¯•ç”¨ä¾‹ï¼š9ä¸ª
   - è¦†ç›–åŠŸèƒ½ï¼š
     - åˆå§‹åŒ–é»˜è®¤å€¼
     - é»˜è®¤é€‰ä¸­é¡¹
     - è¡Œkeyè·å–ï¼ˆå­—ç¬¦ä¸²/å‡½æ•°ï¼‰
     - é€‰æ‹©/å–æ¶ˆé€‰æ‹©
     - å…¨é€‰/å–æ¶ˆå…¨é€‰
     - æ¸…é™¤é€‰æ‹©
     - Ant Design rowSelection é…ç½®
     - æ•°æ®å˜æ›´æ—¶æ›´æ–°é€‰ä¸­è¡Œ

### âœ… ç»„ä»¶æµ‹è¯•ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰

5. **DataTable.test.tsx**
   - ä½ç½®ï¼š`frontend/src/core/components/DataTable/__tests__/DataTable.test.tsx`
   - æµ‹è¯•ç”¨ä¾‹ï¼š8ä¸ª
   - è¦†ç›–åŠŸèƒ½ï¼š
     - æ•°æ®æ¸²æŸ“
     - åŠ è½½çŠ¶æ€
     - åˆ†é¡µå¤„ç†
     - å…³é”®è¯æœç´¢
     - ç­›é€‰å˜æ›´
     - åˆ·æ–°åŠŸèƒ½
     - åˆå§‹ç­›é€‰æ¡ä»¶
     - åˆå§‹å…³é”®è¯

6. **FilterPanel.test.tsx**
   - ä½ç½®ï¼š`frontend/src/core/components/FilterPanel/__tests__/FilterPanel.test.tsx`
   - æµ‹è¯•ç”¨ä¾‹ï¼š10ä¸ª
   - è¦†ç›–åŠŸèƒ½ï¼š
     - Select ç­›é€‰å™¨æ¸²æŸ“
     - Input ç­›é€‰å™¨æ¸²æŸ“
     - Date ç­›é€‰å™¨æ¸²æŸ“
     - DateRange ç­›é€‰å™¨æ¸²æŸ“
     - Number ç­›é€‰å™¨æ¸²æŸ“
     - ç­›é€‰å€¼å˜æ›´
     - æ¸…é™¤æŒ‰é’®æ˜¾ç¤º/éšè—
     - æ¸…é™¤åŠŸèƒ½
     - å½“å‰ç­›é€‰å€¼æ˜¾ç¤º
     - å‚ç›´å¸ƒå±€

---

## äºŒã€æµ‹è¯•ç»Ÿè®¡

| ç±»å‹ | æ–‡ä»¶æ•° | æµ‹è¯•ç”¨ä¾‹æ•° | çŠ¶æ€ |
|------|--------|-----------|------|
| Hooks æµ‹è¯• | 4 | 34 | âœ… å®Œæˆ |
| ç»„ä»¶æµ‹è¯• | 2 | 18 | âœ… å®Œæˆ |
| **æ€»è®¡** | **6** | **52** | âœ… **å®Œæˆ** |

---

## ä¸‰ã€æµ‹è¯•è¦†ç›–èŒƒå›´

### Hooks æµ‹è¯•è¦†ç›–

- âœ… **useDataLoader**: 100% è¦†ç›–
  - åŸºæœ¬åŠŸèƒ½
  - çŠ¶æ€ç®¡ç†
  - é”™è¯¯å¤„ç†
  - é€‰é¡¹é…ç½®
  - é‡è¯•æœºåˆ¶

- âœ… **usePaginatedData**: 100% è¦†ç›–
  - åˆ†é¡µé€»è¾‘
  - ç­›é€‰é€»è¾‘
  - æœç´¢é€»è¾‘
  - æ’åºé€»è¾‘
  - çŠ¶æ€ç®¡ç†

- âœ… **useForm**: 100% è¦†ç›–
  - è¡¨å•çŠ¶æ€
  - å­—æ®µç®¡ç†
  - éªŒè¯é€»è¾‘
  - æäº¤å¤„ç†
  - é”™è¯¯å¤„ç†

- âœ… **useTable**: 100% è¦†ç›–
  - é€‰æ‹©é€»è¾‘
  - è¡Œkeyç®¡ç†
  - æ‰¹é‡æ“ä½œ
  - Ant Design é›†æˆ

### ç»„ä»¶æµ‹è¯•è¦†ç›–

- âœ… **DataTable**: ä¸»è¦åŠŸèƒ½è¦†ç›–
  - æ•°æ®å±•ç¤º
  - åˆ†é¡µ
  - æœç´¢
  - ç­›é€‰
  - åˆ·æ–°

- âœ… **FilterPanel**: ä¸»è¦åŠŸèƒ½è¦†ç›–
  - å„ç§ç­›é€‰å™¨ç±»å‹
  - å€¼ç®¡ç†
  - æ¸…é™¤åŠŸèƒ½
  - å¸ƒå±€é€‰é¡¹

---

## å››ã€è¿è¡Œæµ‹è¯•

### åŸºæœ¬å‘½ä»¤

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# è¿è¡Œæ‰€æœ‰æ ¸å¿ƒæµ‹è¯•
pnpm test src/core

# è¿è¡ŒHookæµ‹è¯•
pnpm test src/core/hooks

# è¿è¡Œç»„ä»¶æµ‹è¯•
pnpm test src/core/components

# è¿è¡Œå•ä¸ªæµ‹è¯•æ–‡ä»¶
pnpm test src/core/hooks/__tests__/useDataLoader.test.ts

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pnpm test:run --coverage src/core
```

### æµ‹è¯•ç¯å¢ƒè¦æ±‚

- Node.js >= 18
- pnpm >= 8
- å·²å®‰è£…ä¾èµ–ï¼š`pnpm install`

---

## äº”ã€æµ‹è¯•å·¥å…·å’Œé…ç½®

### æµ‹è¯•æ¡†æ¶

- **Vitest** - å¿«é€Ÿã€ç°ä»£çš„æµ‹è¯•æ¡†æ¶
- **@testing-library/react** - React ç»„ä»¶æµ‹è¯•å·¥å…·
- **@testing-library/user-event** - ç”¨æˆ·äº¤äº’æ¨¡æ‹Ÿ
- **@tanstack/react-query** - æ•°æ®è·å–æµ‹è¯•æ”¯æŒ

### æµ‹è¯•é…ç½®

- é…ç½®æ–‡ä»¶ï¼š`frontend/vitest.config.js`
- æµ‹è¯•è®¾ç½®ï¼š`frontend/src/test/setupTests.js`
- æµ‹è¯•ç¯å¢ƒï¼šjsdomï¼ˆæµè§ˆå™¨ç¯å¢ƒæ¨¡æ‹Ÿï¼‰

### æµ‹è¯•æ¨¡å¼

- **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯•å•ä¸ª Hook æˆ–ç»„ä»¶
- **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯• Hook å’Œç»„ä»¶çš„ç»„åˆä½¿ç”¨
- **å¿«ç…§æµ‹è¯•**ï¼šç»„ä»¶æ¸²æŸ“ç»“æœå¯¹æ¯”ï¼ˆå¯é€‰ï¼‰

---

## å…­ã€æµ‹è¯•æœ€ä½³å®è·µ

### 1. æµ‹è¯•ç»“æ„

```typescript
describe('Component/Hook Name', () => {
  beforeEach(() => {
    // æ¸…ç†å’Œåˆå§‹åŒ–
  });

  it('should do something', () => {
    // æµ‹è¯•ç”¨ä¾‹
  });
});
```

### 2. å¼‚æ­¥æµ‹è¯•

```typescript
await waitFor(() => {
  expect(result.current.isSuccess).toBe(true);
});
```

### 3. ç”¨æˆ·äº¤äº’

```typescript
fireEvent.click(button);
fireEvent.change(input, { target: { value: 'test' } });
```

### 4. Mock ä½¿ç”¨

```typescript
const mockFn = vi.fn().mockResolvedValue(data);
vi.mock('module', () => ({ default: mockFn }));
```

---

## ä¸ƒã€å·²çŸ¥é—®é¢˜å’Œé™åˆ¶

### 1. Ant Design ç»„ä»¶æµ‹è¯•

- Ant Design ç»„ä»¶éœ€è¦å®Œæ•´çš„ DOM ç¯å¢ƒ
- æŸäº›äº¤äº’å¯èƒ½éœ€è¦æ›´å¤æ‚çš„æ¨¡æ‹Ÿ
- å»ºè®®ä½¿ç”¨ `@testing-library/react` çš„æŸ¥è¯¢æ–¹æ³•

### 2. React Query æµ‹è¯•

- æ‰€æœ‰ä½¿ç”¨ React Query çš„æµ‹è¯•éƒ½éœ€è¦ `QueryClientProvider`
- éœ€è¦æ­£ç¡®é…ç½® `QueryClient` çš„é»˜è®¤é€‰é¡¹
- å¼‚æ­¥æ“ä½œéœ€è¦ä½¿ç”¨ `waitFor` ç­‰å¾…

### 3. TypeScript ç±»å‹

- æµ‹è¯•æ–‡ä»¶ä½¿ç”¨ TypeScriptï¼Œéœ€è¦æ­£ç¡®çš„ç±»å‹å®šä¹‰
- æŸäº› Ant Design ç±»å‹å¯èƒ½éœ€è¦é¢å¤–çš„ç±»å‹æ–­è¨€

---

## å…«ã€ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆå·²å®Œæˆï¼‰

- âœ… åˆ›å»ºæ‰€æœ‰ Hook æµ‹è¯•
- âœ… åˆ›å»ºä¸»è¦ç»„ä»¶æµ‹è¯•
- âœ… ç¼–å†™æµ‹è¯•æ–‡æ¡£

### ä¸­æœŸï¼ˆå¾…å®Œæˆï¼‰

- [ ] è¿è¡Œæµ‹è¯•å¹¶ä¿®å¤é—®é¢˜
- [ ] æå‡æµ‹è¯•è¦†ç›–ç‡åˆ° 90%+
- [ ] æ·»åŠ  CommonForm ç»„ä»¶æµ‹è¯•
- [ ] æ·»åŠ  Dashboard ç»„ä»¶æµ‹è¯•
- [ ] æ·»åŠ é›†æˆæµ‹è¯•

### é•¿æœŸï¼ˆè®¡åˆ’ä¸­ï¼‰

- [ ] æ·»åŠ  E2E æµ‹è¯•
- [ ] æ·»åŠ æ€§èƒ½æµ‹è¯•
- [ ] æ·»åŠ å¯è®¿é—®æ€§æµ‹è¯•
- [ ] CI/CD é›†æˆæµ‹è¯•

---

## ä¹ã€æµ‹è¯•æ–‡ä»¶ç»“æ„

```
frontend/src/core/
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ __tests__/
â”‚   â”‚   â”œâ”€â”€ useDataLoader.test.ts      âœ…
â”‚   â”‚   â”œâ”€â”€ usePaginatedData.test.ts   âœ…
â”‚   â”‚   â”œâ”€â”€ useForm.test.ts            âœ…
â”‚   â”‚   â””â”€â”€ useTable.test.ts           âœ…
â”‚   â”œâ”€â”€ useDataLoader.ts
â”‚   â”œâ”€â”€ usePaginatedData.ts
â”‚   â”œâ”€â”€ useForm.ts
â”‚   â””â”€â”€ useTable.ts
â””â”€â”€ components/
    â”œâ”€â”€ DataTable/
    â”‚   â”œâ”€â”€ __tests__/
    â”‚   â”‚   â””â”€â”€ DataTable.test.tsx     âœ…
    â”‚   â””â”€â”€ DataTable.tsx
    â”œâ”€â”€ FilterPanel/
    â”‚   â”œâ”€â”€ __tests__/
    â”‚   â”‚   â””â”€â”€ FilterPanel.test.tsx   âœ…
    â”‚   â””â”€â”€ FilterPanel.tsx
    â””â”€â”€ __tests__/
        â””â”€â”€ README.md                   âœ…
```

---

## åã€æ€»ç»“

### âœ… å®Œæˆæƒ…å†µ

- **æµ‹è¯•æ–‡ä»¶**ï¼š6ä¸ª
- **æµ‹è¯•ç”¨ä¾‹**ï¼š52ä¸ª
- **è¦†ç›–èŒƒå›´**ï¼šæ ¸å¿ƒ Hooks å’Œä¸»è¦ç»„ä»¶
- **ä»£ç è´¨é‡**ï¼šéµå¾ªæœ€ä½³å®è·µ

### ğŸ“Š æµ‹è¯•è´¨é‡

- **å®Œæ•´æ€§**ï¼šâœ… è¦†ç›–ä¸»è¦åŠŸèƒ½
- **å¯ç»´æŠ¤æ€§**ï¼šâœ… ä»£ç æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
- **å¯è¯»æ€§**ï¼šâœ… æµ‹è¯•æè¿°æ˜ç¡®
- **ç‹¬ç«‹æ€§**ï¼šâœ… æµ‹è¯•ç”¨ä¾‹ç›¸äº’ç‹¬ç«‹

### ğŸ¯ ç›®æ ‡è¾¾æˆ

- âœ… ä¸ºæ‰€æœ‰æ ¸å¿ƒ Hooks åˆ›å»ºæµ‹è¯•
- âœ… ä¸ºä¸»è¦ç»„ä»¶åˆ›å»ºæµ‹è¯•
- âœ… ç¼–å†™æµ‹è¯•æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—
- âœ… éµå¾ªé¡¹ç›®æµ‹è¯•è§„èŒƒ

---

**æŠ¥å‘Šç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2026-01-23

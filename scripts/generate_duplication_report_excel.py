#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ç”Ÿæˆç³»ç»Ÿé‡å¤é—®é¢˜å®¡æŸ¥æŠ¥å‘Šçš„Excelè¡¨æ ¼
"""

import pandas as pd
from datetime import datetime
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill, Alignment, Border, Side
from openpyxl.utils import get_column_letter

def create_duplication_report_excel():
    """åˆ›å»ºé‡å¤é—®é¢˜å®¡æŸ¥æŠ¥å‘Šçš„Excelæ–‡ä»¶"""
    
    # åˆ›å»ºå·¥ä½œç°¿
    wb = Workbook()
    
    # ========== Sheet 1: APIç«¯ç‚¹é‡å¤é—®é¢˜ ==========
    ws1 = wb.active
    ws1.title = "APIç«¯ç‚¹é‡å¤"
    
    api_duplication_data = [
        {
            "åºå·": 1,
            "é—®é¢˜ç±»å‹": "ä¾›åº”å•†APIé‡å¤",
            "é‡å¤ä½ç½®1": "app/api/v1/endpoints/suppliers.py",
            "é‡å¤ä½ç½®2": "app/api/v1/endpoints/materials/suppliers.py",
            "é‡å¤å†…å®¹": "read_suppliers() - è·å–ä¾›åº”å•†åˆ—è¡¨",
            "é‡å¤ä»£ç è¡Œæ•°": "~200è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸ”´ é«˜",
            "å½±å“": "ç»´æŠ¤æˆæœ¬é«˜ï¼Œéœ€è¦åŒæ­¥ä¿®æ”¹ä¸¤å¤„",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ é™¤materials/suppliers.pyï¼Œç»Ÿä¸€ä½¿ç”¨/suppliers/è·¯ç”±",
            "ä¼˜å…ˆçº§": "P0 - ç«‹å³å¤„ç†",
            "é¢„è®¡å·¥ä½œé‡": "2å°æ—¶"
        },
        {
            "åºå·": 2,
            "é—®é¢˜ç±»å‹": "é¡¹ç›®è§’è‰²APIé‡å¤",
            "é‡å¤ä½ç½®1": "app/api/v1/endpoints/project_roles/",
            "é‡å¤ä½ç½®2": "app/api/v1/endpoints/projects/roles/",
            "é‡å¤å†…å®¹": "é¡¹ç›®è§’è‰²ç®¡ç†åŠŸèƒ½",
            "é‡å¤ä»£ç è¡Œæ•°": "å¾…ç¡®è®¤",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "å½±å“": "è·¯ç”±æ··ä¹±ï¼ŒèŒè´£è¾¹ç•Œä¸æ¸…",
            "å»ºè®®æ–¹æ¡ˆ": "ç»Ÿä¸€ä¸ºé¡¹ç›®ä¸­å¿ƒè®¾è®¡ï¼š/projects/{id}/roles/",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸå¤„ç†",
            "é¢„è®¡å·¥ä½œé‡": "4å°æ—¶"
        },
        {
            "åºå·": 3,
            "é—®é¢˜ç±»å‹": "é‡Œç¨‹ç¢‘APIé‡å¤",
            "é‡å¤ä½ç½®1": "app/api/v1/endpoints/milestones/",
            "é‡å¤ä½ç½®2": "app/api/v1/endpoints/projects/milestones/",
            "é‡å¤å†…å®¹": "é‡Œç¨‹ç¢‘CRUDå’Œæµç¨‹ç®¡ç†",
            "é‡å¤ä»£ç è¡Œæ•°": "~300è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "å½±å“": "è·¯ç”±æ··ä¹±ï¼ŒåŠŸèƒ½é‡å¤",
            "å»ºè®®æ–¹æ¡ˆ": "ç»Ÿä¸€ä¸ºé¡¹ç›®ä¸­å¿ƒè®¾è®¡ï¼š/projects/{id}/milestones/",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸå¤„ç†",
            "é¢„è®¡å·¥ä½œé‡": "4å°æ—¶"
        }
    ]
    
    df1 = pd.DataFrame(api_duplication_data)
    write_dataframe_to_sheet(ws1, df1, "APIç«¯ç‚¹é‡å¤é—®é¢˜æ±‡æ€»")
    
    # ========== Sheet 2: CRUDæ“ä½œé‡å¤ ==========
    ws2 = wb.create_sheet("CRUDæ“ä½œé‡å¤")
    
    crud_duplication_data = [
        {
            "é—®é¢˜ç±»å‹": "åˆ†é¡µæŸ¥è¯¢æ¨¡å¼",
            "é‡å¤ä½ç½®": "å‡ ä¹æ‰€æœ‰åˆ—è¡¨æ¥å£",
            "æ¶‰åŠæ–‡ä»¶æ•°": "456ä¸ªæ–‡ä»¶",
            "é‡å¤å‡½æ•°æ•°": "~400ä¸ª",
            "é‡å¤ä»£ç è¡Œæ•°": "~4000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "é‡å¤æ¨¡å¼": "åˆ†é¡µè®¡ç®—ã€å…³é”®è¯æœç´¢ã€ç­›é€‰é€»è¾‘",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºé€šç”¨CRUDåŸºç±»æˆ–å·¥å…·å‡½æ•°",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "16å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "å‡å°‘30-40%é‡å¤ä»£ç "
        },
        {
            "é—®é¢˜ç±»å‹": "è¯¦æƒ…æŸ¥è¯¢æ¨¡å¼",
            "é‡å¤ä½ç½®": "å‡ ä¹æ‰€æœ‰è¯¦æƒ…æ¥å£",
            "æ¶‰åŠæ–‡ä»¶æ•°": "456ä¸ªæ–‡ä»¶",
            "é‡å¤å‡½æ•°æ•°": "~300ä¸ª",
            "é‡å¤ä»£ç è¡Œæ•°": "~2000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "é‡å¤æ¨¡å¼": "IDæŸ¥è¯¢ã€404æ£€æŸ¥ã€å“åº”æ„å»º",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºé€šç”¨è¯¦æƒ…æŸ¥è¯¢åŸºç±»",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "8å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€é”™è¯¯å¤„ç†é€»è¾‘"
        },
        {
            "é—®é¢˜ç±»å‹": "åˆ›å»ºæ“ä½œæ¨¡å¼",
            "é‡å¤ä½ç½®": "å‡ ä¹æ‰€æœ‰åˆ›å»ºæ¥å£",
            "æ¶‰åŠæ–‡ä»¶æ•°": "456ä¸ªæ–‡ä»¶",
            "é‡å¤å‡½æ•°æ•°": "~300ä¸ª",
            "é‡å¤ä»£ç è¡Œæ•°": "~3000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "é‡å¤æ¨¡å¼": "å”¯ä¸€æ€§æ£€æŸ¥ã€æ•°æ®åˆ›å»ºã€äº‹åŠ¡æäº¤",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºé€šç”¨åˆ›å»ºæ“ä½œåŸºç±»",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "12å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€éªŒè¯å’Œé”™è¯¯å¤„ç†"
        },
        {
            "é—®é¢˜ç±»å‹": "æ›´æ–°æ“ä½œæ¨¡å¼",
            "é‡å¤ä½ç½®": "å‡ ä¹æ‰€æœ‰æ›´æ–°æ¥å£",
            "æ¶‰åŠæ–‡ä»¶æ•°": "456ä¸ªæ–‡ä»¶",
            "é‡å¤å‡½æ•°æ•°": "~200ä¸ª",
            "é‡å¤ä»£ç è¡Œæ•°": "~2500è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "é‡å¤æ¨¡å¼": "å­˜åœ¨æ€§æ£€æŸ¥ã€å­—æ®µæ›´æ–°ã€äº‹åŠ¡æäº¤",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºé€šç”¨æ›´æ–°æ“ä½œåŸºç±»",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "10å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€æ›´æ–°é€»è¾‘"
        },
        {
            "é—®é¢˜ç±»å‹": "åˆ é™¤æ“ä½œæ¨¡å¼",
            "é‡å¤ä½ç½®": "å‡ ä¹æ‰€æœ‰åˆ é™¤æ¥å£",
            "æ¶‰åŠæ–‡ä»¶æ•°": "456ä¸ªæ–‡ä»¶",
            "é‡å¤å‡½æ•°æ•°": "~97ä¸ª",
            "é‡å¤ä»£ç è¡Œæ•°": "~1500è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­",
            "é‡å¤æ¨¡å¼": "å­˜åœ¨æ€§æ£€æŸ¥ã€å…³è”æ£€æŸ¥ã€è½¯åˆ é™¤/ç¡¬åˆ é™¤",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºé€šç”¨åˆ é™¤æ“ä½œåŸºç±»",
            "ä¼˜å…ˆçº§": "P1 - çŸ­æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "8å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€åˆ é™¤ç­–ç•¥"
        }
    ]
    
    df2 = pd.DataFrame(crud_duplication_data)
    write_dataframe_to_sheet(ws2, df2, "CRUDæ“ä½œé‡å¤æ¨¡å¼æ±‡æ€»")
    
    # ========== Sheet 3: ç»Ÿè®¡åŠŸèƒ½é‡å¤ ==========
    ws3 = wb.create_sheet("ç»Ÿè®¡åŠŸèƒ½é‡å¤")
    
    statistics_duplication_data = [
        {
            "æ¨¡å—": "ç»Ÿä¸€å·¥ä½œå°ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/dashboard_stats.py",
            "åŠŸèƒ½": "å¤šè§’è‰²ç»Ÿè®¡æ•°æ®",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "å®¢æœç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/service/statistics.py",
            "åŠŸèƒ½": "æœåŠ¡å·¥å•ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€å¹³å‡å“åº”æ—¶é—´",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "é¢„è­¦ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/alerts/statistics/",
            "åŠŸèƒ½": "é¢„è­¦æ•°æ®ç»Ÿè®¡ï¼ˆ3ä¸ªæ–‡ä»¶ï¼‰",
            "é‡å¤æ¨¡å¼": "åˆ†å¸ƒç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æã€æ€§èƒ½æŒ‡æ ‡",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "ç¼ºæ–™ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/shortage/analytics/dashboard.py",
            "åŠŸèƒ½": "ç¼ºæ–™æ•°æ®åˆ†æ",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "ç”Ÿäº§ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/production/dashboard.py",
            "åŠŸèƒ½": "ç”Ÿäº§æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "å”®å‰ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/presales_integration/dashboard.py",
            "åŠŸèƒ½": "å”®å‰æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "äººå‘˜åŒ¹é…ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/staff_matching/dashboard.py",
            "åŠŸèƒ½": "äººå‘˜åŒ¹é…æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "å•†åŠ¡æ”¯æŒç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/business_support/dashboard.py",
            "åŠŸèƒ½": "å•†åŠ¡æ”¯æŒæ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "è£…é…å¥—ä»¶ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/assembly_kit/dashboard.py",
            "åŠŸèƒ½": "è£…é…å¥—ä»¶æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "é…å¥—ç‡ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/kit_rate/dashboard.py",
            "åŠŸèƒ½": "é…å¥—ç‡æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "ç®¡ç†èŠ‚å¥ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/management_rhythm/dashboard.py",
            "åŠŸèƒ½": "ç®¡ç†èŠ‚å¥æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "äººäº‹ç»Ÿè®¡",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/hr_management/dashboard.py",
            "åŠŸèƒ½": "äººäº‹æ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        },
        {
            "æ¨¡å—": "PMOé©¾é©¶èˆ±",
            "æ–‡ä»¶è·¯å¾„": "app/api/v1/endpoints/pmo/cockpit.py",
            "åŠŸèƒ½": "PMOæ•°æ®ç»Ÿè®¡",
            "é‡å¤æ¨¡å¼": "è®¡æ•°ç»Ÿè®¡ã€è¶‹åŠ¿åˆ†æ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¡ ä¸­"
        }
    ]
    
    df3 = pd.DataFrame(statistics_duplication_data)
    write_dataframe_to_sheet(ws3, df3, "ç»Ÿè®¡åŠŸèƒ½é‡å¤æ±‡æ€»")
    
    # ========== Sheet 4: å‰ç«¯ç»„ä»¶é‡å¤ ==========
    ws4 = wb.create_sheet("å‰ç«¯ç»„ä»¶é‡å¤")
    
    frontend_duplication_data = [
        {
            "é—®é¢˜ç±»å‹": "æ•°æ®åŠ è½½æ¨¡å¼",
            "é‡å¤ä½ç½®": "å‡ ä¹æ‰€æœ‰é¡µé¢",
            "æ¶‰åŠæ–‡ä»¶æ•°": "405ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~8000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¢ ä½",
            "é‡å¤æ¨¡å¼": "useState(loading/data/error), useEffect, try-catch",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºuseDataLoaderé€šç”¨hook",
            "ä¼˜å…ˆçº§": "P2 - é•¿æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "16å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "å‡å°‘40-50%é‡å¤ä»£ç "
        },
        {
            "é—®é¢˜ç±»å‹": "ç­›é€‰å’Œåˆ†é¡µæ¨¡å¼",
            "é‡å¤ä½ç½®": "æ‰€æœ‰åˆ—è¡¨é¡µé¢",
            "æ¶‰åŠæ–‡ä»¶æ•°": "~200ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~4000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¢ ä½",
            "é‡å¤æ¨¡å¼": "filtersçŠ¶æ€ã€paginationçŠ¶æ€ã€handleFilterChange",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºusePaginatedDataé€šç”¨hook",
            "ä¼˜å…ˆçº§": "P2 - é•¿æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "12å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€åˆ†é¡µé€»è¾‘"
        },
        {
            "é—®é¢˜ç±»å‹": "è¡¨å•å¤„ç†æ¨¡å¼",
            "é‡å¤ä½ç½®": "æ‰€æœ‰è¡¨å•é¡µé¢",
            "æ¶‰åŠæ–‡ä»¶æ•°": "~150ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~3000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¢ ä½",
            "é‡å¤æ¨¡å¼": "formDataçŠ¶æ€ã€submittingçŠ¶æ€ã€handleSubmit",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºuseFormé€šç”¨hook",
            "ä¼˜å…ˆçº§": "P2 - é•¿æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "10å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€è¡¨å•å¤„ç†é€»è¾‘"
        },
        {
            "é—®é¢˜ç±»å‹": "è¡¨æ ¼å±•ç¤ºæ¨¡å¼",
            "é‡å¤ä½ç½®": "æ‰€æœ‰åˆ—è¡¨é¡µé¢",
            "æ¶‰åŠæ–‡ä»¶æ•°": "~200ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~5000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ğŸŸ¢ ä½",
            "é‡å¤æ¨¡å¼": "Tableç»„ä»¶ã€columnså®šä¹‰ã€rowSelection",
            "å»ºè®®æ–¹æ¡ˆ": "åˆ›å»ºé€šç”¨DataTableç»„ä»¶",
            "ä¼˜å…ˆçº§": "P2 - é•¿æœŸä¼˜åŒ–",
            "é¢„è®¡å·¥ä½œé‡": "20å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€è¡¨æ ¼æ ·å¼å’ŒåŠŸèƒ½"
        }
    ]
    
    df4 = pd.DataFrame(frontend_duplication_data)
    write_dataframe_to_sheet(ws4, df4, "å‰ç«¯ç»„ä»¶é‡å¤æ¨¡å¼æ±‡æ€»")
    
    # ========== Sheet 5: æ€»ä½“ç»Ÿè®¡ ==========
    ws5 = wb.create_sheet("æ€»ä½“ç»Ÿè®¡")
    
    summary_data = [
        {
            "ç±»åˆ«": "APIç«¯ç‚¹é‡å¤",
            "é—®é¢˜æ•°é‡": 3,
            "æ¶‰åŠæ–‡ä»¶æ•°": "6ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~500è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "é«˜/ä¸­",
            "ä¼˜å…ˆçº§": "P0-P1",
            "é¢„è®¡å·¥ä½œé‡": "10å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "ç»Ÿä¸€è·¯ç”±ï¼Œé™ä½ç»´æŠ¤æˆæœ¬"
        },
        {
            "ç±»åˆ«": "CRUDæ“ä½œé‡å¤",
            "é—®é¢˜æ•°é‡": 5,
            "æ¶‰åŠæ–‡ä»¶æ•°": "456ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~13000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ä¸­",
            "ä¼˜å…ˆçº§": "P1",
            "é¢„è®¡å·¥ä½œé‡": "54å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "å‡å°‘30-40%é‡å¤ä»£ç "
        },
        {
            "ç±»åˆ«": "ç»Ÿè®¡åŠŸèƒ½é‡å¤",
            "é—®é¢˜æ•°é‡": 13,
            "æ¶‰åŠæ–‡ä»¶æ•°": "262ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~8000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ä¸­",
            "ä¼˜å…ˆçº§": "P1",
            "é¢„è®¡å·¥ä½œé‡": "40å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "å‡å°‘50%é‡å¤ä»£ç "
        },
        {
            "ç±»åˆ«": "å‰ç«¯ç»„ä»¶é‡å¤",
            "é—®é¢˜æ•°é‡": 4,
            "æ¶‰åŠæ–‡ä»¶æ•°": "405ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~20000è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "ä½",
            "ä¼˜å…ˆçº§": "P2",
            "é¢„è®¡å·¥ä½œé‡": "58å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "å‡å°‘40-50%é‡å¤ä»£ç "
        },
        {
            "ç±»åˆ«": "æ€»è®¡",
            "é—®é¢˜æ•°é‡": 25,
            "æ¶‰åŠæ–‡ä»¶æ•°": "1129ä¸ªæ–‡ä»¶",
            "é‡å¤ä»£ç è¡Œæ•°": "~41500è¡Œ",
            "ä¸¥é‡ç¨‹åº¦": "-",
            "ä¼˜å…ˆçº§": "-",
            "é¢„è®¡å·¥ä½œé‡": "162å°æ—¶",
            "é¢„æœŸæ”¶ç›Š": "å‡å°‘çº¦39%é‡å¤ä»£ç ï¼ˆ~16200è¡Œï¼‰"
        }
    ]
    
    df5 = pd.DataFrame(summary_data)
    write_dataframe_to_sheet(ws5, df5, "é‡å¤é—®é¢˜æ€»ä½“ç»Ÿè®¡")
    
    # ========== Sheet 6: è¡ŒåŠ¨è®¡åˆ’ ==========
    ws6 = wb.create_sheet("è¡ŒåŠ¨è®¡åˆ’")
    
    action_plan_data = [
        {
            "é˜¶æ®µ": "ç¬¬ä¸€é˜¶æ®µï¼ˆç«‹å³å¤„ç†ï¼‰",
            "ä»»åŠ¡": "åˆ é™¤materials/suppliers.pyï¼Œç»Ÿä¸€ä½¿ç”¨/suppliers/è·¯ç”±",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬å‘¨",
            "ä¼˜å…ˆçº§": "P0",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬ä¸€é˜¶æ®µï¼ˆç«‹å³å¤„ç†ï¼‰",
            "ä»»åŠ¡": "å®¡æŸ¥å¹¶ç»Ÿä¸€project_roles/å’Œprojects/roles/çš„èŒè´£",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬å‘¨",
            "ä¼˜å…ˆçº§": "P0",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬ä¸€é˜¶æ®µï¼ˆç«‹å³å¤„ç†ï¼‰",
            "ä»»åŠ¡": "å®¡æŸ¥å¹¶ç»Ÿä¸€milestones/å’Œprojects/milestones/çš„èŒè´£",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬å‘¨",
            "ä¼˜å…ˆçº§": "P0",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬äºŒé˜¶æ®µï¼ˆçŸ­æœŸä¼˜åŒ–ï¼‰",
            "ä»»åŠ¡": "åˆ›å»ºé€šç”¨CRUDåŸºç±»ï¼Œå‡å°‘é‡å¤ä»£ç ",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬æœˆ",
            "ä¼˜å…ˆçº§": "P1",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬äºŒé˜¶æ®µï¼ˆçŸ­æœŸä¼˜åŒ–ï¼‰",
            "ä»»åŠ¡": "åˆ›å»ºç»Ÿä¸€ç»Ÿè®¡æœåŠ¡å±‚",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬æœˆ",
            "ä¼˜å…ˆçº§": "P1",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬äºŒé˜¶æ®µï¼ˆçŸ­æœŸä¼˜åŒ–ï¼‰",
            "ä»»åŠ¡": "åˆ›å»ºé€šç”¨å‰ç«¯hooksï¼ˆuseDataLoader, usePaginatedDataï¼‰",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬æœˆ",
            "ä¼˜å…ˆçº§": "P1",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬ä¸‰é˜¶æ®µï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰",
            "ä»»åŠ¡": "é‡æ„æ‰€æœ‰åˆ—è¡¨é¡µé¢ä½¿ç”¨é€šç”¨DataTableç»„ä»¶",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬å­£åº¦",
            "ä¼˜å…ˆçº§": "P2",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬ä¸‰é˜¶æ®µï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰",
            "ä»»åŠ¡": "é‡æ„æ‰€æœ‰è¡¨å•é¡µé¢ä½¿ç”¨é€šç”¨Formç»„ä»¶",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬å­£åº¦",
            "ä¼˜å…ˆçº§": "P2",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        },
        {
            "é˜¶æ®µ": "ç¬¬ä¸‰é˜¶æ®µï¼ˆé•¿æœŸä¼˜åŒ–ï¼‰",
            "ä»»åŠ¡": "å»ºç«‹ä»£ç å®¡æŸ¥æœºåˆ¶ï¼Œé˜²æ­¢æ–°çš„é‡å¤ä»£ç ",
            "è´Ÿè´£äºº": "å¾…åˆ†é…",
            "é¢„è®¡å®Œæˆæ—¶é—´": "æœ¬å­£åº¦",
            "ä¼˜å…ˆçº§": "P2",
            "çŠ¶æ€": "å¾…å¼€å§‹"
        }
    ]
    
    df6 = pd.DataFrame(action_plan_data)
    write_dataframe_to_sheet(ws6, df6, "é‡å¤é—®é¢˜ä¼˜åŒ–è¡ŒåŠ¨è®¡åˆ’")
    
    # ä¿å­˜æ–‡ä»¶
    filename = f"reports/ç³»ç»Ÿé‡å¤é—®é¢˜å®¡æŸ¥æŠ¥å‘Š_{datetime.now().strftime('%Y%m%d')}.xlsx"
    wb.save(filename)
    print(f"âœ… ExcelæŠ¥å‘Šå·²ç”Ÿæˆ: {filename}")
    return filename


def write_dataframe_to_sheet(ws, df, title):
    """å°†DataFrameå†™å…¥å·¥ä½œè¡¨å¹¶åº”ç”¨æ ·å¼"""
    
    # å†™å…¥æ ‡é¢˜
    ws['A1'] = title
    ws['A1'].font = Font(bold=True, size=14)
    ws.merge_cells('A1:J1')
    ws['A1'].alignment = Alignment(horizontal='center', vertical='center')
    
    # å†™å…¥è¡¨å¤´ï¼ˆä»ç¬¬3è¡Œå¼€å§‹ï¼‰
    header_row = 3
    for col_num, column_title in enumerate(df.columns, 1):
        cell = ws.cell(row=header_row, column=col_num)
        cell.value = column_title
        cell.font = Font(bold=True, color="FFFFFF")
        cell.fill = PatternFill(start_color="366092", end_color="366092", fill_type="solid")
        cell.alignment = Alignment(horizontal='center', vertical='center', wrap_text=True)
        cell.border = Border(
            left=Side(style='thin'),
            right=Side(style='thin'),
            top=Side(style='thin'),
            bottom=Side(style='thin')
        )
    
    # å†™å…¥æ•°æ®
    for row_num, row_data in enumerate(df.values, header_row + 1):
        for col_num, value in enumerate(row_data, 1):
            cell = ws.cell(row=row_num, column=col_num)
            cell.value = value
            cell.alignment = Alignment(horizontal='left', vertical='center', wrap_text=True)
            cell.border = Border(
                left=Side(style='thin'),
                right=Side(style='thin'),
                top=Side(style='thin'),
                bottom=Side(style='thin')
            )
            
            # æ ¹æ®ä¸¥é‡ç¨‹åº¦è®¾ç½®èƒŒæ™¯è‰²
            if isinstance(value, str):
                if 'ğŸ”´' in value or 'é«˜' in value:
                    cell.fill = PatternFill(start_color="FFE6E6", end_color="FFE6E6", fill_type="solid")
                elif 'ğŸŸ¡' in value or 'ä¸­' in value:
                    cell.fill = PatternFill(start_color="FFF4E6", end_color="FFF4E6", fill_type="solid")
                elif 'ğŸŸ¢' in value or 'ä½' in value:
                    cell.fill = PatternFill(start_color="E6F7E6", end_color="E6F7E6", fill_type="solid")
    
    # è‡ªåŠ¨è°ƒæ•´åˆ—å®½
    for col_num, column_title in enumerate(df.columns, 1):
        max_length = len(str(column_title))
        for row_num in range(header_row + 1, header_row + len(df) + 1):
            cell_value = ws.cell(row=row_num, column=col_num).value
            if cell_value:
                max_length = max(max_length, len(str(cell_value)))
        adjusted_width = min(max_length + 2, 50)
        ws.column_dimensions[get_column_letter(col_num)].width = adjusted_width
    
    # è®¾ç½®è¡Œé«˜
    ws.row_dimensions[1].height = 30
    ws.row_dimensions[header_row].height = 25


if __name__ == "__main__":
    create_duplication_report_excel()

#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ç»éªŒæ•™è®­åº“ç§å­æ•°æ®
åˆ›å»º 8-10 æ¡ç¤ºä¾‹ç»éªŒæ•™è®­ï¼Œè¦†ç›–ä¸åŒé¡¹ç›®ã€åˆ†ç±»å’Œç±»å‹
"""

import sqlite3
import random
from datetime import datetime, timedelta

# æ•°æ®åº“è·¯å¾„
DB_PATH = "data/pms.db"

# ç¤ºä¾‹æ•°æ®
LESSONS_DATA = [
    {
        "project_id": 1,
        "title": "éœ€æ±‚å˜æ›´ç®¡ç†æµç¨‹ä¼˜åŒ–",
        "category": "management",
        "lesson_type": "improvement",
        "description": "åœ¨é¡¹ç›®æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå®¢æˆ·é¢‘ç¹æå‡ºéœ€æ±‚å˜æ›´ï¼Œå¯¼è‡´é¡¹ç›®è¿›åº¦ä¸¥é‡å»¶è¯¯ã€‚åˆæœŸæ²¡æœ‰å»ºç«‹è§„èŒƒçš„å˜æ›´æ§åˆ¶æµç¨‹ï¼Œæ‰€æœ‰å˜æ›´éƒ½ç›´æ¥å®æ–½ã€‚",
        "root_cause": "ç¼ºä¹æ­£å¼çš„å˜æ›´æ§åˆ¶å§”å‘˜ä¼šï¼ˆCCBï¼‰å’Œå˜æ›´è¯„ä¼°æµç¨‹ï¼Œå˜æ›´å½±å“åˆ†æä¸åˆ°ä½ã€‚",
        "action_taken": "å»ºç«‹äº†å˜æ›´æ§åˆ¶æµç¨‹ï¼Œæ‰€æœ‰å˜æ›´éœ€ç»è¿‡ CCB å®¡æ‰¹ï¼Œå¹¶è¯„ä¼°å¯¹è¿›åº¦ã€æˆæœ¬çš„å½±å“ã€‚å®æ–½å˜æ›´è¯·æ±‚å•åˆ¶åº¦ã€‚",
        "recommendation": "æ‰€æœ‰é¡¹ç›®åº”åœ¨å¯åŠ¨é˜¶æ®µå°±å»ºç«‹å˜æ›´æ§åˆ¶æµç¨‹ï¼Œæ˜ç¡®å˜æ›´å®¡æ‰¹æƒé™å’Œå½±å“è¯„ä¼°æœºåˆ¶ã€‚å»ºè®®å˜æ›´è¶…è¿‡ 3 æ¬¡/æœˆæ—¶è§¦å‘é¡¹ç›®å¤ç›˜ã€‚",
        "impact_level": "high",
        "applicable_to": "æ‰€æœ‰è½¯ä»¶å¼€å‘é¡¹ç›®",
        "tags": "éœ€æ±‚ç®¡ç†ï¼Œå˜æ›´æ§åˆ¶ï¼Œæµç¨‹ä¼˜åŒ–",
        "reviewed": 1,
    },
    {
        "project_id": 2,
        "title": "å…³é”®æŠ€æœ¯é€‰å‹å¤±è¯¯å¯¼è‡´è¿”å·¥",
        "category": "technical",
        "lesson_type": "failure",
        "description": "é¡¹ç›®åˆæœŸé€‰æ‹©äº†ä¸æˆç†Ÿçš„æŠ€æœ¯æ¡†æ¶ï¼ŒåæœŸå‘ç°æ€§èƒ½æ— æ³•æ»¡è¶³è¦æ±‚ï¼Œå¯¼è‡´æ ¸å¿ƒæ¨¡å—éœ€è¦é‡æ„ï¼Œå»¶è¯¯é¡¹ç›® 2 ä¸ªæœˆã€‚",
        "root_cause": "æŠ€æœ¯é€‰å‹æ—¶æœªè¿›è¡Œå……åˆ†çš„ PoC éªŒè¯ï¼Œè¿‡äºå…³æ³¨æ–°æŠ€æœ¯çš„å…ˆè¿›æ€§è€Œå¿½è§†äº†æˆç†Ÿåº¦å’Œå›¢é˜ŸæŒæ¡ç¨‹åº¦ã€‚",
        "action_taken": "ç»„ç»‡æŠ€æœ¯è¯„å®¡ä¼šï¼Œé‚€è¯·å¤–éƒ¨ä¸“å®¶å‚ä¸å…³é”®æŠ€æœ¯é€‰å‹å†³ç­–ã€‚å»ºç«‹æŠ€æœ¯é€‰å‹è¯„ä¼° checklistï¼ŒåŒ…æ‹¬æ€§èƒ½ã€æˆç†Ÿåº¦ã€å›¢é˜Ÿèƒ½åŠ›ç­‰ç»´åº¦ã€‚",
        "recommendation": "å…³é”®æŠ€æœ¯é€‰å‹å¿…é¡»è¿›è¡Œ PoC éªŒè¯ï¼Œè¯„ä¼°ç»´åº¦åº”åŒ…å«ï¼šæ€§èƒ½æŒ‡æ ‡ã€ç¤¾åŒºæ´»è·ƒåº¦ã€å›¢é˜Ÿå­¦ä¹ æˆæœ¬ã€é•¿æœŸç»´æŠ¤é£é™©ã€‚å»ºè®®å»ºç«‹å…¬å¸çº§æŠ€æœ¯é›·è¾¾ã€‚",
        "impact_level": "high",
        "applicable_to": "æ‰€æœ‰ç ”å‘é¡¹ç›®",
        "tags": "æŠ€æœ¯é€‰å‹ï¼Œæ¶æ„è®¾è®¡ï¼Œé£é™©è¯„ä¼°",
        "reviewed": 1,
    },
    {
        "project_id": 3,
        "title": "è·¨éƒ¨é—¨åä½œæ²Ÿé€šæœºåˆ¶å»ºç«‹",
        "category": "management",
        "lesson_type": "success",
        "description": "å¤§å‹é¡¹ç›®æ¶‰åŠå¤šä¸ªéƒ¨é—¨åä½œï¼Œé€šè¿‡å»ºç«‹å®šæœŸæ²Ÿé€šæœºåˆ¶å’Œæ˜ç¡®æ¥å£äººï¼Œæœ‰æ•ˆæå‡äº†åä½œæ•ˆç‡ï¼Œé¡¹ç›®æŒ‰æ—¶äº¤ä»˜ã€‚",
        "root_cause": "NA",
        "action_taken": "å»ºç«‹äº†å‘¨ä¾‹ä¼šåˆ¶åº¦ï¼Œå„éƒ¨é—¨æŒ‡å®šå›ºå®šæ¥å£äººï¼Œä½¿ç”¨ç»Ÿä¸€çš„é¡¹ç›®ç®¡ç†å·¥å…·è·Ÿè¸ªè·¨éƒ¨é—¨ä»»åŠ¡ã€‚",
        "recommendation": "è·¨éƒ¨é—¨é¡¹ç›®åº”åœ¨å¯åŠ¨ä¼šå°±æ˜ç¡®æ²Ÿé€šæœºåˆ¶ï¼šå‘¨ä¾‹ä¼šæ—¶é—´ã€å‚ä¼šäººå‘˜ã€å†³ç­–æµç¨‹ã€‚å»ºè®®ä½¿ç”¨ RACI çŸ©é˜µæ˜ç¡®å„æ–¹èŒè´£ã€‚",
        "impact_level": "medium",
        "applicable_to": "è·¨éƒ¨é—¨åä½œé¡¹ç›®",
        "tags": "æ²Ÿé€šç®¡ç†ï¼Œåä½œæœºåˆ¶ï¼Œè·¨éƒ¨é—¨",
        "reviewed": 1,
    },
    {
        "project_id": 1,
        "title": "ä¾›åº”å•†äº¤ä»˜å»¶æœŸåº”å¯¹ç­–ç•¥",
        "category": "cost",
        "lesson_type": "failure",
        "description": "å…³é”®é›¶éƒ¨ä»¶ä¾›åº”å•†äº¤ä»˜å»¶æœŸ 3 å‘¨ï¼Œå¯¼è‡´æ•´æœºç»„è£…æ— æ³•æŒ‰æœŸè¿›è¡Œï¼Œé¡¹ç›®é¢ä¸´è¿çº¦é£é™©ã€‚",
        "root_cause": "å•ä¸€ä¾›åº”å•†ä¾èµ–ï¼Œæœªå»ºç«‹å¤‡é€‰ä¾›åº”å•†æ¸…å•ã€‚é‡‡è´­åˆåŒä¸­å¯¹å»¶æœŸè¿çº¦è´£ä»»çº¦å®šä¸æ˜ç¡®ã€‚",
        "action_taken": "ç´§æ€¥å¯ç”¨å¤‡é€‰ä¾›åº”å•†ï¼Œè™½ç„¶æˆæœ¬å¢åŠ  15%ï¼Œä½†ä¿è¯äº†äº¤ä»˜ã€‚ä¸ä¸»ä¾›åº”å•†é‡æ–°è°ˆåˆ¤ï¼Œå¢åŠ å»¶æœŸç½šåˆ™æ¡æ¬¾ã€‚",
        "recommendation": "å…³é”®ç‰©æ–™å¿…é¡»å»ºç«‹ AB ä¾›åº”å•†æœºåˆ¶ï¼Œä¿æŒè‡³å°‘ 2 å®¶åˆæ ¼ä¾›åº”å•†ã€‚é‡‡è´­åˆåŒåº”æ˜ç¡®å»¶æœŸè¿çº¦è´£ä»»å’Œèµ”å¿æ¡æ¬¾ã€‚å»ºè®®å»ºç«‹ä¾›åº”å•†ç»©æ•ˆè¯„ä¼°ä½“ç³»ã€‚",
        "impact_level": "high",
        "applicable_to": "é‡‡è´­ç®¡ç†ã€ä¾›åº”é“¾ç®¡ç†",
        "tags": "ä¾›åº”å•†ç®¡ç†ï¼Œé‡‡è´­é£é™©ï¼Œäº¤ä»˜å»¶æœŸ",
        "reviewed": 1,
    },
    {
        "project_id": 4,
        "title": "è‡ªåŠ¨åŒ–æµ‹è¯•è¦†ç›–ç‡æå‡å®è·µ",
        "category": "technical",
        "lesson_type": "success",
        "description": "é€šè¿‡å»ºç«‹è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œå°†æ ¸å¿ƒåŠŸèƒ½çš„æµ‹è¯•è¦†ç›–ç‡ä» 30% æå‡è‡³ 85%ï¼Œæ˜¾è‘—é™ä½äº†å›å½’æµ‹è¯•æ—¶é—´å’Œç”Ÿäº§ç¼ºé™·ç‡ã€‚",
        "root_cause": "NA",
        "action_taken": "å¼•å…¥ pytest æµ‹è¯•æ¡†æ¶ï¼Œå»ºç«‹ CI/CD æµæ°´çº¿è‡ªåŠ¨æ‰§è¡Œæµ‹è¯•ã€‚åˆ¶å®šæµ‹è¯•è¦†ç›–ç‡ç›®æ ‡å¹¶çº³å…¥ä»£ç å®¡æŸ¥æ ‡å‡†ã€‚",
        "recommendation": "æ–°é¡¹ç›®åº”ä»ç¬¬ä¸€å¤©å°±å»ºç«‹è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæ ¸å¿ƒä¸šåŠ¡é€»è¾‘è¦†ç›–ç‡åº”è¾¾åˆ° 80% ä»¥ä¸Šã€‚å»ºè®®å°†æµ‹è¯•è¦†ç›–ç‡ä½œä¸ºä»£ç åˆå¹¶çš„å‰ç½®æ¡ä»¶ã€‚",
        "impact_level": "medium",
        "applicable_to": "è½¯ä»¶å¼€å‘é¡¹ç›®",
        "tags": "è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œè´¨é‡æ§åˆ¶ï¼ŒCI/CD",
        "reviewed": 1,
    },
    {
        "project_id": 2,
        "title": "é¡¹ç›®è¿›åº¦ä¼°ç®—åå·®åˆ†æ",
        "category": "schedule",
        "lesson_type": "failure",
        "description": "é¡¹ç›®åˆæœŸä¼°ç®— 6 ä¸ªæœˆå®Œæˆï¼Œå®é™…è€—æ—¶ 9 ä¸ªæœˆï¼Œè¿›åº¦åå·®è¾¾ 50%ã€‚ä¸»è¦åŸå› æ˜¯ä½ä¼°äº†æŠ€æœ¯éš¾åº¦å’Œéœ€æ±‚å˜æ›´é¢‘ç‡ã€‚",
        "root_cause": "ä¼°ç®—æ—¶è¿‡äºä¹è§‚ï¼Œæœªè€ƒè™‘æŠ€æœ¯é£é™©ç¼“å†²ã€‚é‡‡ç”¨å•ä¸€ä¼°ç®—æ–¹æ³•ï¼Œç¼ºä¹å†å²æ•°æ®å‚è€ƒã€‚",
        "action_taken": "å¼•å…¥ä¸‰ç‚¹ä¼°ç®—æ³•ï¼ˆä¹è§‚/æ‚²è§‚/æœ€å¯èƒ½ï¼‰ï¼Œå¢åŠ  20% çš„é£é™©ç¼“å†²æ—¶é—´ã€‚å»ºç«‹é¡¹ç›®å†å²æ•°æ®åº“ï¼Œä¸ºåç»­ä¼°ç®—æä¾›å‚è€ƒã€‚",
        "recommendation": "é¡¹ç›®ä¼°ç®—åº”é‡‡ç”¨å¤šç§æ–¹æ³•äº¤å‰éªŒè¯ï¼Œå¿…é¡»åŒ…å«é£é™©ç¼“å†²ï¼ˆå»ºè®® 15-25%ï¼‰ã€‚å»ºè®®å»ºç«‹å…¬å¸çº§é¡¹ç›®å†å²æ•°æ®åº“ï¼Œç§¯ç´¯ä¼°ç®—åŸºå‡†æ•°æ®ã€‚",
        "impact_level": "medium",
        "applicable_to": "é¡¹ç›®è®¡åˆ’ç®¡ç†",
        "tags": "è¿›åº¦ä¼°ç®—ï¼Œé£é™©ç®¡ç†ï¼Œé¡¹ç›®è®¡åˆ’",
        "reviewed": 1,
    },
    {
        "project_id": 5,
        "title": "å®¢æˆ·éœ€æ±‚ç®¡ç†æœ€ä½³å®è·µ",
        "category": "customer",
        "lesson_type": "success",
        "description": "é€šè¿‡å»ºç«‹å®¢æˆ·éœ€æ±‚è·Ÿè¸ªçŸ©é˜µå’Œå®šæœŸç¡®è®¤æœºåˆ¶ï¼Œç¡®ä¿éœ€æ±‚ç†è§£ä¸€è‡´ï¼Œé¡¹ç›®éªŒæ”¶ä¸€æ¬¡æ€§é€šè¿‡ï¼Œå®¢æˆ·æ»¡æ„åº¦é«˜ã€‚",
        "root_cause": "NA",
        "action_taken": "ä½¿ç”¨éœ€æ±‚è·Ÿè¸ªçŸ©é˜µï¼ˆRTMï¼‰ç®¡ç†æ‰€æœ‰éœ€æ±‚ï¼Œæ¯ä¸ªéœ€æ±‚éƒ½æœ‰å”¯ä¸€ IDã€‚æ¯ä¸¤å‘¨ä¸å®¢æˆ·ç¡®è®¤éœ€æ±‚ç†è§£ï¼Œå½¢æˆä¹¦é¢è®°å½•ã€‚",
        "recommendation": "æ‰€æœ‰é¡¹ç›®åº”å»ºç«‹éœ€æ±‚è·Ÿè¸ªçŸ©é˜µï¼Œç¡®ä¿éœ€æ±‚å¯è¿½æº¯ã€‚å»ºè®®é‡‡ç”¨åŸå‹æˆ– Demo æ–¹å¼æ—©æœŸç¡®è®¤éœ€æ±‚ç†è§£ï¼Œé¿å…åæœŸè¿”å·¥ã€‚",
        "impact_level": "medium",
        "applicable_to": "éœ€æ±‚ç®¡ç†ã€å®¢æˆ·æ²Ÿé€š",
        "tags": "éœ€æ±‚ç®¡ç†ï¼Œå®¢æˆ·æ²Ÿé€šï¼ŒéªŒæ”¶ç®¡ç†",
        "reviewed": 1,
    },
    {
        "project_id": 3,
        "title": "ä»£ç å®¡æŸ¥æµç¨‹ä¼˜åŒ–",
        "category": "quality",
        "lesson_type": "improvement",
        "description": "åˆæœŸä»£ç å®¡æŸ¥æµäºå½¢å¼ï¼Œç”Ÿäº§ç¯å¢ƒç¼ºé™·ç‡é«˜ã€‚ä¼˜åŒ–å®¡æŸ¥æµç¨‹åï¼Œç¼ºé™·ç‡ä¸‹é™ 60%ã€‚",
        "root_cause": "å®¡æŸ¥ checklist ä¸å®Œå–„ï¼Œå®¡æŸ¥äººå‘˜ç¼ºä¹åŸ¹è®­ï¼Œå®¡æŸ¥æ—¶é—´ä¸è¶³ã€‚",
        "action_taken": "åˆ¶å®šè¯¦ç»†çš„ä»£ç å®¡æŸ¥ checklistï¼ŒåŒ…å«å®‰å…¨ã€æ€§èƒ½ã€å¯ç»´æŠ¤æ€§ç­‰ç»´åº¦ã€‚å»ºç«‹å®¡æŸ¥äººå‘˜è®¤è¯æœºåˆ¶ï¼Œç¡®ä¿å®¡æŸ¥è´¨é‡ã€‚",
        "recommendation": "ä»£ç å®¡æŸ¥åº”ä½œä¸ºå¼ºåˆ¶æµç¨‹ï¼Œæ ¸å¿ƒä»£ç å¿…é¡»ç»è¿‡ 2 äººä»¥ä¸Šå®¡æŸ¥ã€‚å»ºè®®å»ºç«‹å®¡æŸ¥ checklist å¹¶æŒç»­ä¼˜åŒ–ï¼Œå®šæœŸç»„ç»‡å®¡æŸ¥æŠ€èƒ½åŸ¹è®­ã€‚",
        "impact_level": "medium",
        "applicable_to": "è½¯ä»¶å¼€å‘é¡¹ç›®",
        "tags": "ä»£ç å®¡æŸ¥ï¼Œè´¨é‡ç®¡ç†ï¼Œå¼€å‘æµç¨‹",
        "reviewed": 1,
    },
    {
        "project_id": 4,
        "title": "é¡¹ç›®æ–‡æ¡£ç®¡ç†è§„èŒƒåŒ–",
        "category": "management",
        "lesson_type": "success",
        "description": "å»ºç«‹ç»Ÿä¸€çš„é¡¹ç›®æ–‡æ¡£ç®¡ç†ä½“ç³»ï¼Œæ‰€æœ‰æ–‡æ¡£é›†ä¸­å­˜å‚¨ã€ç‰ˆæœ¬å¯æ§ï¼Œæ˜¾è‘—æå‡çŸ¥è¯†ä¼ æ‰¿æ•ˆç‡å’Œæ–°æˆå‘˜ onboarding é€Ÿåº¦ã€‚",
        "root_cause": "NA",
        "action_taken": "ä½¿ç”¨ Confluence å»ºç«‹é¡¹ç›®çŸ¥è¯†åº“ï¼Œå®šä¹‰æ–‡æ¡£æ¨¡æ¿å’Œç›®å½•ç»“æ„ã€‚åˆ¶å®šæ–‡æ¡£æ›´æ–°æµç¨‹ï¼Œç¡®ä¿æ–‡æ¡£ä¸é¡¹ç›®åŒæ­¥ã€‚",
        "recommendation": "é¡¹ç›®å¯åŠ¨æ—¶åº”å»ºç«‹æ–‡æ¡£ç›®å½•ç»“æ„ï¼Œæ˜ç¡®å„ç±»æ–‡æ¡£çš„è´£ä»»äººå’Œæ›´æ–°é¢‘ç‡ã€‚å»ºè®®å°†æ–‡æ¡£å®Œæ•´æ€§ä½œä¸ºé¡¹ç›®ç»“é¡¹çš„å‰ç½®æ¡ä»¶ã€‚",
        "impact_level": "low",
        "applicable_to": "æ‰€æœ‰é¡¹ç›®",
        "tags": "æ–‡æ¡£ç®¡ç†ï¼ŒçŸ¥è¯†ç®¡ç†ï¼Œé¡¹ç›®è§„èŒƒ",
        "reviewed": 1,
    },
    {
        "project_id": 1,
        "title": "æ€§èƒ½ä¼˜åŒ–ç»éªŒæ€»ç»“",
        "category": "technical",
        "lesson_type": "success",
        "description": "é€šè¿‡ç³»ç»Ÿæ€§æ€§èƒ½ä¼˜åŒ–ï¼Œç³»ç»Ÿå“åº”æ—¶é—´ä» 2 ç§’é™ä½è‡³ 200msï¼Œç”¨æˆ·ä½“éªŒæ˜¾è‘—æå‡ã€‚",
        "root_cause": "NA",
        "action_taken": "å»ºç«‹æ€§èƒ½åŸºçº¿ï¼Œä½¿ç”¨ APM å·¥å…·å®šä½ç“¶é¢ˆã€‚ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ï¼ˆæ·»åŠ ç´¢å¼•ã€ä¼˜åŒ– SQLï¼‰ã€å¼•å…¥ç¼“å­˜ã€å¼‚æ­¥å¤„ç†è€—æ—¶æ“ä½œã€‚",
        "recommendation": "æ€§èƒ½ä¼˜åŒ–åº”éµå¾ª'æµ‹é‡ - åˆ†æ - ä¼˜åŒ– - éªŒè¯'å¾ªç¯ã€‚å»ºè®®åœ¨æ–°é¡¹ç›®è®¾è®¡é˜¶æ®µå°±è€ƒè™‘æ€§èƒ½æŒ‡æ ‡ï¼Œå»ºç«‹æ€§èƒ½æµ‹è¯•è‡ªåŠ¨åŒ–ã€‚",
        "impact_level": "high",
        "applicable_to": "ç³»ç»Ÿå¼€å‘ã€æ€§èƒ½ä¼˜åŒ–",
        "tags": "æ€§èƒ½ä¼˜åŒ–ï¼Œæ•°æ®åº“ä¼˜åŒ–ï¼Œç¼“å­˜ç­–ç•¥",
        "reviewed": 1,
    },
]


def seed_lessons_data():
    """æ’å…¥ç»éªŒæ•™è®­ç§å­æ•°æ®"""
    conn = sqlite3.connect(DB_PATH)
    conn.row_factory = sqlite3.Row
    cursor = conn.cursor()
    
    # æ£€æŸ¥è¡¨æ˜¯å¦å­˜åœ¨
    cursor.execute("""
        SELECT name FROM sqlite_master 
        WHERE type='table' AND name='lessons_learned'
    """)
    if not cursor.fetchone():
        print("âŒ lessons_learned è¡¨ä¸å­˜åœ¨ï¼Œè¯·å…ˆå¯åŠ¨åç«¯åˆ›å»ºè¡¨")
        conn.close()
        return False
    
    # æ£€æŸ¥æ˜¯å¦å·²æœ‰æ•°æ®
    cursor.execute("SELECT COUNT(*) as count FROM lessons_learned")
    existing_count = cursor.fetchone()["count"]
    if existing_count > 0:
        print(f"âš ï¸  å·²å­˜åœ¨ {existing_count} æ¡ç»éªŒæ•™è®­æ•°æ®ï¼Œè·³è¿‡æ’å…¥")
        conn.close()
        return True
    
    # æ’å…¥æ•°æ®
    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    insert_sql = """
        INSERT INTO lessons_learned (
            project_id, title, category, lesson_type, description,
            root_cause, action_taken, recommendation, impact_level,
            applicable_to, tags, submitted_by, reviewed, created_at, updated_at
        ) VALUES (
            :project_id, :title, :category, :lesson_type, :description,
            :root_cause, :action_taken, :recommendation, :impact_level,
            :applicable_to, :tags, :submitted_by, :reviewed, :now, :now
        )
    """
    
    inserted_count = 0
    for lesson in LESSONS_DATA:
        try:
            cursor.execute(insert_sql, {
                "project_id": lesson["project_id"],
                "title": lesson["title"],
                "category": lesson["category"],
                "lesson_type": lesson["lesson_type"],
                "description": lesson["description"],
                "root_cause": lesson["root_cause"],
                "action_taken": lesson["action_taken"],
                "recommendation": lesson["recommendation"],
                "impact_level": lesson["impact_level"],
                "applicable_to": lesson["applicable_to"],
                "tags": lesson["tags"],
                "submitted_by": 1,  # é»˜è®¤ç®¡ç†å‘˜
                "reviewed": lesson["reviewed"],
                "now": now,
            })
            inserted_count += 1
        except Exception as e:
            print(f"âŒ æ’å…¥å¤±è´¥ï¼š{lesson['title']} - {e}")
    
    conn.commit()
    conn.close()
    
    print(f"âœ… æˆåŠŸæ’å…¥ {inserted_count} æ¡ç»éªŒæ•™è®­æ•°æ®")
    return True


if __name__ == "__main__":
    print("ğŸ“ å¼€å§‹æ’å…¥ç»éªŒæ•™è®­åº“ç§å­æ•°æ®...")
    seed_lessons_data()
    print("\nğŸ’¡ æç¤ºï¼šè¯·è®¿é—® /lessons-learned æŸ¥çœ‹æ•°æ®")

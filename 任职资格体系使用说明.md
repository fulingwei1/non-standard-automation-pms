# 任职资格体系使用说明

## 一、系统概述

任职资格体系用于管理不同岗位、不同等级的技能要求，并将这些要求融合到日常绩效考核中。

### 职级体系

系统支持5个职级：
1. **ASSISTANT** - 助理级（0-1年经验）
2. **JUNIOR** - 初级（1-2年经验）
3. **MIDDLE** - 中级（2-4年经验）
4. **SENIOR** - 高级（4-6年经验）
5. **EXPERT** - 专家级（6年以上经验）

### 支持的岗位类型

- **ENGINEER** - 工程师岗位（包含子类型：ME/EE/SW/TE）
- **SALES** - 销售岗位
- **CUSTOMER_SERVICE** - 客服岗位
- **WORKER** - 生产工人岗位

## 二、初始化数据

### 1. 执行数据库迁移

```bash
# SQLite 环境
sqlite3 data/app.db < migrations/20260107_qualification_system_sqlite.sql

# MySQL 环境
mysql -u username -p database_name < migrations/20260107_qualification_system_mysql.sql
```

### 2. 创建种子数据

```bash
python create_qualification_seed_data.py
```

这将创建：
- 5个职级等级
- 工程师岗位（ME/EE/SW/TE）各5个等级的能力模型（共20个）
- 销售岗位5个等级的能力模型
- 客服岗位5个等级的能力模型
- 生产工人岗位5个等级的能力模型

## 三、API 使用指南

### 1. 任职资格等级管理

#### 获取等级列表
```http
GET /api/v1/qualifications/levels?role_type=ENGINEER&is_active=true
```

#### 创建等级（仅HR）
```http
POST /api/v1/qualifications/levels
Content-Type: application/json

{
  "level_code": "ASSISTANT",
  "level_name": "助理级",
  "level_order": 1,
  "role_type": null,
  "description": "助理级岗位描述"
}
```

### 2. 岗位能力模型管理

#### 获取能力模型列表
```http
GET /api/v1/qualifications/models?position_type=ENGINEER&level_id=1
```

#### 获取特定岗位等级的能力要求
```http
GET /api/v1/qualifications/models/ENGINEER/1?position_subtype=ME
```

#### 创建能力模型（仅HR）
```http
POST /api/v1/qualifications/models
Content-Type: application/json

{
  "position_type": "ENGINEER",
  "position_subtype": "ME",
  "level_id": 1,
  "competency_dimensions": {
    "technical_skills": {
      "name": "专业技能",
      "weight": 40,
      "items": [
        {
          "name": "设计能力",
          "description": "能够完成基础设计任务",
          "score_range": [0, 100]
        }
      ]
    }
  }
}
```

### 3. 员工任职资格管理

#### 认证员工任职资格（仅HR）
```http
POST /api/v1/qualifications/employees/{employee_id}/certify
Content-Type: application/json

{
  "position_type": "ENGINEER",
  "level_id": 2,
  "assessment_details": {
    "technical_skills": {"score": 85, "items": {...}},
    "business_skills": {"score": 80, "items": {...}}
  },
  "certified_date": "2024-01-15",
  "valid_until": "2025-01-15"
}
```

#### 获取员工任职资格
```http
GET /api/v1/qualifications/employees/{employee_id}?position_type=ENGINEER
```

#### 员工晋升评估（仅HR）
```http
POST /api/v1/qualifications/employees/{employee_id}/promote
Content-Type: application/json

{
  "target_level_id": 3,
  "assessment_details": {
    "technical_skills": {"score": 90, "items": {...}},
    "business_skills": {"score": 85, "items": {...}}
  },
  "assessment_period": "2024-Q1"
}
```

### 4. 任职资格评估

#### 创建评估记录
```http
POST /api/v1/qualifications/assessments
Content-Type: application/json

{
  "employee_id": 1,
  "qualification_id": 1,
  "assessment_type": "ANNUAL",
  "assessment_period": "2024-Q1",
  "scores": {
    "technical_skills": 85,
    "business_skills": 80,
    "communication_skills": 75
  },
  "comments": "评估意见"
}
```

#### 获取员工评估历史
```http
GET /api/v1/qualifications/assessments/{employee_id}?qualification_id=1
```

### 5. 绩效融合

#### 获取融合后的绩效结果
```http
GET /api/v1/performance/integrated/{user_id}?period=2024-01
```

响应示例：
```json
{
  "code": 200,
  "message": "获取成功",
  "data": {
    "base_score": 85.0,
    "qualification_score": 80.0,
    "integrated_score": 83.5,
    "base_weight": 0.7,
    "qualification_weight": 0.3,
    "qualification_level": "MIDDLE",
    "details": {
      "base_performance": 85.0,
      "qualification": {
        "score": 80.0,
        "level_code": "MIDDLE",
        "level_name": "中级"
      },
      "calculation": {
        "formula": "85.0 × 0.7 + 80.0 × 0.3",
        "result": 83.5
      }
    }
  }
}
```

#### 计算融合绩效（仅管理层）
```http
POST /api/v1/performance/calculate-integrated?user_id=1&period=2024-01
```

## 四、能力维度说明

### 工程师岗位能力维度

1. **专业技能** (technical_skills) - 权重 30-40%
   - 设计能力
   - 编程/绘图能力
   - 调试能力
   - 问题解决
   - 技术架构（高级以上）

2. **业务能力** (business_skills) - 权重 25-30%
   - 需求理解
   - 方案设计
   - 业务洞察（高级以上）

3. **沟通协作** (communication_skills) - 权重 15-20%
   - 团队协作
   - 跨部门沟通
   - 客户沟通（高级以上）

4. **学习成长** (learning_skills) - 权重 10%
   - 技术学习
   - 知识分享
   - 技术研究（高级以上）

5. **项目管理** (project_management_skills) - 权重 10-15%
   - 任务管理
   - 进度控制
   - 风险管理（高级以上）

### 销售岗位能力维度

1. **业务能力** (business_skills) - 权重 40%
2. **客户服务** (customer_service_skills) - 权重 30%
3. **沟通协作** (communication_skills) - 权重 20%
4. **学习成长** (learning_skills) - 权重 10%

### 客服岗位能力维度

1. **客户服务** (customer_service_skills) - 权重 50%
2. **业务能力** (business_skills) - 权重 25%
3. **沟通协作** (communication_skills) - 权重 15%
4. **学习成长** (learning_skills) - 权重 10%

### 生产工人岗位能力维度

1. **专业技能** (technical_skills) - 权重 40-50%
2. **质量意识** (quality_skills) - 权重 30%
3. **效率能力** (efficiency_skills) - 权重 10-20%
4. **学习成长** (learning_skills) - 权重 10%

## 五、绩效融合计算

### 计算公式

```
综合得分 = 基础绩效得分 × 70% + 任职资格得分 × 30%
```

### 权重配置

默认权重配置：
- 基础绩效权重：70%
- 任职资格权重：30%

权重可在 `app/services/performance_integration_service.py` 中的 `get_qualification_weight_config()` 方法中配置。

## 六、业务流程

### 1. 员工认证流程

1. HR 创建员工任职资格认证
2. 填写评估详情（各维度得分）
3. 系统自动计算综合得分
4. 认证通过后，员工获得对应等级的任职资格

### 2. 晋升评估流程

1. 员工申请晋升或HR发起晋升评估
2. 进行任职资格评估（各维度评分）
3. 系统检查晋升资格：
   - 目标等级必须高于当前等级
   - 最近一次评估结果必须为 PASS
   - 综合得分需达到80分以上
4. 评估通过后，更新员工任职资格等级

### 3. 年度评估流程

1. 每年定期进行任职资格评估
2. 评估各维度能力
3. 更新评估记录
4. 根据评估结果决定是否调整等级

### 4. 绩效融合流程

1. 员工提交月度工作总结
2. 部门经理和项目经理进行评价（基础绩效）
3. 系统自动获取员工当前任职资格得分
4. 计算融合后的综合得分
5. 在绩效评价记录中保存任职资格信息

## 七、权限说明

- **等级管理、能力模型管理、员工认证、晋升评估**：仅人力资源经理（HR）可操作
- **查看任职资格、评估历史**：所有用户可查看自己的，管理层可查看下属的
- **绩效融合查看**：所有用户可查看自己的，管理层可查看下属的
- **绩效融合计算**：仅管理层和HR可执行

## 八、注意事项

1. 等级编码必须唯一，建议使用：ASSISTANT, JUNIOR, MIDDLE, SENIOR, EXPERT
2. 能力模型的 JSON 结构必须符合规范，包含 name、weight、items 等字段
3. 评估得分范围通常为 0-100 分
4. 晋升评估需要满足一定条件，系统会自动检查
5. 绩效融合权重可根据实际情况调整

## 九、常见问题

### Q1: 如何修改绩效融合权重？

A: 修改 `app/services/performance_integration_service.py` 中的 `DEFAULT_BASE_PERFORMANCE_WEIGHT` 和 `DEFAULT_QUALIFICATION_WEIGHT` 常量，或实现配置表存储。

### Q2: 如何添加新的岗位类型？

A: 在 `app/models/qualification.py` 的 `PositionTypeEnum` 中添加新类型，然后创建对应的能力模型。

### Q3: 如何自定义能力维度？

A: 在创建或更新能力模型时，修改 `competency_dimensions` JSON 字段，可以添加自定义的维度。

### Q4: 评估记录可以修改吗？

A: 评估记录创建后可以更新，但建议通过创建新的评估记录来记录历史变化。

## 十、后续扩展

1. **权重配置管理**：实现权重配置的数据库存储和管理界面
2. **评估模板**：为不同岗位创建评估模板，简化评估流程
3. **自动评估**：基于工作数据自动计算部分维度得分
4. **评估报告**：生成详细的评估报告和趋势分析
5. **培训建议**：根据评估结果自动生成培训建议






# æ•°æ®åº“é—®é¢˜æ€»ç»“æŠ¥å‘Š

**æ—¶é—´**: 2026-02-16 16:15  
**é—®é¢˜ç±»å‹**: æ•°æ®åº“æ¨¡å¼ä¸å®Œæ•´  
**å½±å“èŒƒå›´**: 500é”™è¯¯çš„ä¸»è¦åŸå› 

---

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 
**æ•°æ®åº“è¿ç§»è„šæœ¬æœªå®Œæ•´æ‰§è¡Œ**ï¼Œå¯¼è‡´ï¼š
1. âœ… éƒ¨åˆ†è¡¨å­˜åœ¨ï¼ˆå¦‚projects, usersç­‰æ ¸å¿ƒè¡¨ï¼‰
2. âŒ éƒ¨åˆ†è¡¨ç¼ºå¤±ï¼ˆå¦‚contacts, ç­‰è¾…åŠ©è¡¨ï¼‰
3. âŒ éƒ¨åˆ†åˆ—ç¼ºå¤±ï¼ˆå¦‚customersçš„å¤šä¸ªå­—æ®µï¼‰

### å·²å‘ç°çš„ç¼ºå¤±

**ç¼ºå¤±çš„è¡¨**:
- `contacts` - è”ç³»äººè¡¨

**ç¼ºå¤±çš„åˆ—**:
- `customers.established_date` âœ… å·²ä¿®å¤
- `customers.customer_level` âœ… å·²ä¿®å¤
- `customers.account_period` âœ… å·²ä¿®å¤
- `customers.customer_source` âœ… å·²ä¿®å¤
- `customers.sales_owner_id` âœ… å·²ä¿®å¤
- `customers.last_follow_up_at` âœ… å·²ä¿®å¤
- `customers.annual_revenue` âœ… å·²ä¿®å¤
- `customers.cooperation_years` âœ… å·²ä¿®å¤
- `customers.website` âœ… å·²ä¿®å¤
- `opportunities.probability` âœ… å·²ä¿®å¤
- `projects.customer_address` âœ… å·²ä¿®å¤
- `projects.template_id` âœ… å·²ä¿®å¤
- `projects.template_version_id` âœ… å·²ä¿®å¤

---

## ğŸ¯ æ ¹æœ¬è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆA: æ‰§è¡Œå®Œæ•´çš„æ•°æ®åº“è¿ç§»ï¼ˆæ¨èï¼‰â­

**æ­¥éª¤**:
1. æ‰¾åˆ°æ‰€æœ‰migration SQLæ–‡ä»¶
2. æŒ‰é¡ºåºæ‰§è¡Œæœªæ‰§è¡Œçš„è¿ç§»
3. éªŒè¯æ‰€æœ‰è¡¨å’Œåˆ—éƒ½å·²åˆ›å»º

**ä¼˜ç‚¹**:
- ä¸€æ¬¡æ€§è§£å†³æ‰€æœ‰é—®é¢˜
- æ•°æ®åº“ç»“æ„ä¸ä»£ç æ¨¡å‹å®Œå…¨åŒ¹é…
- ç¬¦åˆæ ‡å‡†å¼€å‘æµç¨‹

**ç¼ºç‚¹**:
- éœ€è¦30-60åˆ†é’Ÿ
- å¯èƒ½é‡åˆ°è¿ç§»å†²çª

**æ‰§è¡Œå‘½ä»¤**:
```bash
cd migrations
ls -1 *.sql | sort | while read file; do
  echo "æ‰§è¡Œ: $file"
  sqlite3 ../data/app.db < $file
done
```

---

### æ–¹æ¡ˆB: ä»æ¨¡å‹å®šä¹‰è‡ªåŠ¨åˆ›å»ºè¡¨ï¼ˆå¿«é€Ÿï¼‰

**æ­¥éª¤**:
1. ä½¿ç”¨SQLAlchemyçš„`Base.metadata.create_all()`
2. è‡ªåŠ¨åˆ›å»ºæ‰€æœ‰ç¼ºå¤±çš„è¡¨å’Œåˆ—

**ä¼˜ç‚¹**:
- 5-10åˆ†é’Ÿå¿«é€Ÿä¿®å¤
- ç®€å•ç›´æ¥

**ç¼ºç‚¹**:
- å¯èƒ½ä¸æ‰‹å†™migrationä¸ä¸€è‡´
- ä¸é€‚åˆç”Ÿäº§ç¯å¢ƒ

**æ‰§è¡Œè„šæœ¬**:
```python
from app.models.base import Base
from app.core.database import engine

# åˆ›å»ºæ‰€æœ‰è¡¨
Base.metadata.create_all(bind=engine)
```

---

### æ–¹æ¡ˆC: æ‰‹åŠ¨åˆ›å»ºç¼ºå¤±çš„è¡¨ï¼ˆä¸´æ—¶ï¼‰

**æ­¥éª¤**:
1. é€ä¸ªå‘ç°ç¼ºå¤±çš„è¡¨
2. æ‰‹åŠ¨åˆ›å»ºè¡¨ç»“æ„
3. ç»§ç»­æµ‹è¯•

**ä¼˜ç‚¹**:
- å¯æ§æ€§å¼º

**ç¼ºç‚¹**:
- éœ€è¦æŒç»­ä¿®å¤ï¼ˆæ‰“åœ°é¼ ï¼‰
- è€—æ—¶æœ€é•¿

---

## ğŸ’¡ æˆ‘çš„å»ºè®®

**ç«‹å³æ‰§è¡Œ**: **æ–¹æ¡ˆB (è‡ªåŠ¨åˆ›å»ºæ‰€æœ‰è¡¨)** + åç»­æ‰§è¡Œæ–¹æ¡ˆA

**åŸå› **:
1. æ–¹æ¡ˆB å¯åœ¨5-10åˆ†é’Ÿå†…å¿«é€Ÿæ¢å¤ç³»ç»Ÿå¯ç”¨æ€§
2. æ–¹æ¡ˆA ä½œä¸ºåç»­ä¼˜åŒ–ï¼Œç¡®ä¿ç”Ÿäº§ç¯å¢ƒä¸€è‡´æ€§
3. é¿å…æ–¹æ¡ˆCçš„"æ‰“åœ°é¼ "é—®é¢˜

**æ‰§è¡Œé¡ºåº**:
```bash
# 1. ç«‹å³æ‰§è¡Œæ–¹æ¡ˆBï¼ˆ10åˆ†é’Ÿï¼‰
python3 scripts/auto_create_tables.py

# 2. é‡æ–°æµ‹è¯•
python3 test_core_api.py

# 3. åç»­æ‰§è¡Œæ–¹æ¡ˆAï¼ˆ30-60åˆ†é’Ÿï¼‰
# æ‰§è¡Œå®Œæ•´è¿ç§»ï¼ŒéªŒè¯æ•°æ®ä¸€è‡´æ€§
```

---

## ğŸ“ˆ é¢„æœŸæ•ˆæœ

| æ–¹æ¡ˆ | æ—¶é—´ | 500é”™è¯¯ä¿®å¤ç‡ | APIé€šè¿‡ç‡æå‡ |
|------|------|---------------|---------------|
| A | 30-60åˆ†é’Ÿ | 100% | +30% (30%â†’60%+) |
| B | 5-10åˆ†é’Ÿ | 90%+ | +25% (30%â†’55%+) |
| C | 2-3å°æ—¶ | é€æ­¥æå‡ | +15% (30%â†’45%) |

---

**å½“å‰çŠ¶æ€**: APIé€šè¿‡ç‡ 30.19%  
**æ–¹æ¡ˆBå®Œæˆå**: é¢„è®¡55-60%  
**æ–¹æ¡ˆAå®Œæˆå**: é¢„è®¡70-80%

---

**å»ºè®®**: ç«‹å³å¯åŠ¨æ–¹æ¡ˆBï¼Œå¿«é€Ÿæ¢å¤ç³»ç»Ÿï¼

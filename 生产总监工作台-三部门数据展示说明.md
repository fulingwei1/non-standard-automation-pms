# 生产总监工作台 - 客服/仓储/发货部门数据展示说明

> 更新时间：2025-01-15

---

## 一、客服部（Customer Service）

### 1.1 概览卡片（首页顶部）

| 指标 | 数据来源 | 说明 |
|------|---------|------|
| **服务案例** | `serviceStats.activeCases` | 活跃案例数（待处理+处理中） |
| **今日解决** | `serviceStats.resolvedToday` | 今日已解决的案例数 |
| **客户满意度** | `serviceStats.customerSatisfaction` | 客户满意度（百分制，从满意度调查计算） |

**API来源**：`GET /service/dashboard-statistics`

---

### 1.2 详细Tab页面（"客服部"Tab）

#### 左侧：服务案例列表
**数据来源**：`mockServiceCases`（Mock数据，待替换为真实API）

**展示内容**：
- 案例类型（故障维修/现场调试/技术咨询等）
- 优先级（高/中/低）
- 状态（待处理/处理中/已解决）
- 项目名称
- 客户名称
- 分配工程师
- 响应时间（小时）

**示例数据**：
```javascript
{
  projectName: 'BMS老化测试设备',
  customer: '深圳XX科技',
  type: '故障维修',
  priority: 'high',
  status: 'in_progress',
  assignedEngineer: '钱工',
  responseTime: 1.5  // 小时
}
```

---

#### 右侧：服务指标
**数据来源**：`serviceStats`（真实API数据）

**展示内容**：

| 指标 | 字段 | 说明 |
|------|------|------|
| **客户满意度** | `customerSatisfaction` | 百分制，带进度条 |
| **平均响应时间** | `avgResponseTime` | 单位：小时 |
| **在岗工程师** | `activeEngineers / totalEngineers` | 在岗数/总数 |

**API来源**：`GET /service/dashboard-statistics`

**返回数据字段**：
- `active_cases`: 活跃案例数
- `resolved_today`: 今日解决数
- `pending_cases`: 待处理数
- `avg_response_time`: 平均响应时间（小时）
- `customer_satisfaction`: 客户满意度（百分制）
- `on_site_services`: 现场服务数
- `total_engineers`: 总工程师数
- `active_engineers`: 在岗工程师数

---

### 1.3 概览卡片（中间区域）

**展示内容**：
- 平均响应时间：`serviceStats.avgResponseTime` 小时
- 待处理案例：`serviceStats.pendingCases`
- 在岗工程师：`serviceStats.activeEngineers / serviceStats.totalEngineers`

---

## 二、仓储部（Warehouse）

### 2.1 概览卡片（首页顶部）

| 指标 | 数据来源 | 说明 |
|------|---------|------|
| **库存SKU** | `warehouseStats.totalItems` | 总SKU数 |
| **在库SKU** | `warehouseStats.inStockItems` | 在库SKU数 |
| **周转率** | `warehouseStats.inventoryTurnover` | 库存周转率（次） |

**API来源**：`GET /materials/warehouse/statistics`

---

### 2.2 详细Tab页面（"仓储部"Tab）

#### 左侧：库存预警列表
**数据来源**：`mockWarehouseAlerts`（Mock数据，待替换为真实API）

**展示内容**：
- 预警类型（低库存/缺货/待入库）
- 物料名称
- 当前库存 vs 最低库存
- 预计到货日期（待入库时显示）
- 预警状态（警告/严重/待处理）

**示例数据**：
```javascript
{
  type: 'low_stock',  // 或 'out_of_stock', 'pending_inbound'
  item: '导轨 20mm x 500mm',
  currentStock: 5,
  minStock: 10,
  status: 'warning'
}
```

---

#### 右侧：仓储指标
**数据来源**：`warehouseStats`（真实API数据）

**展示内容**：

| 指标 | 字段 | 说明 |
|------|------|------|
| **仓储利用率** | `warehouseUtilization` | 百分制，带进度条（目前为Mock数据82.3%） |
| **库存周转率** | `inventoryTurnover` | 次/月 |
| **在库SKU** | `inStockItems / totalItems` | 在库数/总数 |

**API来源**：`GET /materials/warehouse/statistics`

**返回数据字段**：
- `total_items`: 总SKU数
- `in_stock_items`: 在库SKU数
- `low_stock_items`: 低库存SKU数
- `out_of_stock_items`: 缺货SKU数
- `inventory_turnover`: 库存周转率
- `warehouse_utilization`: 仓储利用率（%）（TODO: 从仓储容量表计算）
- `pending_inbound`: 待入库订单数
- `pending_outbound`: 待出库工单数

---

### 2.3 概览卡片（中间区域）

**展示内容**：
- 仓储利用率：`warehouseStats.warehouseUtilization` %
- 在途订单：`shippingStats.inTransit`（这里显示的是发货部的在途订单）
- 待入库：`warehouseStats.pendingInbound`
- 待出库：`warehouseStats.pendingOutbound`

---

## 三、发货部（Shipping）

### 3.1 概览卡片（首页顶部）

| 指标 | 数据来源 | 说明 |
|------|---------|------|
| **待发货** | `shippingStats.pendingShipments` | 待发货订单数 |
| **今日已发** | `shippingStats.shippedToday` | 今日已发货数量 |
| **准时率** | `shippingStats.onTimeShippingRate` | 发货准时率（%） |

**API来源**：`GET /business-support/delivery-orders/statistics`

---

### 3.2 详细Tab页面（"发货部"Tab）

#### 左侧：发货订单列表
**数据来源**：`mockShippingOrders`（Mock数据，待替换为真实API）

**展示内容**：
- 订单状态（待发货/运输中/已送达）
- 优先级（紧急标记）
- 项目名称
- 订单号
- 客户名称
- 目的地
- 计划发货日期（待发货时显示）
- 预计到达日期（运输中时显示）
- 送达时间（已送达时显示）

**示例数据**：
```javascript
{
  orderNo: 'SO-2025-0018',
  projectName: 'BMS老化测试设备',
  customer: '深圳XX科技',
  destination: '深圳',
  status: 'pending',  // 或 'in_transit', 'delivered'
  plannedShipDate: '2025-01-08',
  priority: 'high'
}
```

---

#### 右侧：发货指标
**数据来源**：`shippingStats`（真实API数据）

**展示内容**：

| 指标 | 字段 | 说明 |
|------|------|------|
| **准时发货率** | `onTimeShippingRate` | 百分制，带进度条 |
| **平均发货时间** | `avgShippingTime` | 单位：天（从发货到签收） |
| **在途订单** | `inTransit` | 已发货但未签收的订单数 |

**API来源**：`GET /business-support/delivery-orders/statistics`

**返回数据字段**：
- `pending_shipments`: 待发货数（已审批但未发货）
- `shipped_today`: 今日已发数
- `in_transit`: 在途订单数（已发货但未签收）
- `delivered_this_week`: 本周已送达数
- `on_time_shipping_rate`: 准时发货率（%）
- `avg_shipping_time`: 平均发货时间（天）
- `total_orders`: 总订单数

---

### 3.3 概览卡片（中间区域）

**展示内容**：
- 在途订单：`shippingStats.inTransit`

---

## 四、数据状态总结

### 4.1 真实API数据（已实现）

✅ **客服部统计指标**：
- 活跃案例数、今日解决数、待处理数
- 客户满意度、平均响应时间
- 在岗工程师数

✅ **仓储部统计指标**：
- 总SKU数、在库SKU数、低库存SKU数、缺货SKU数
- 库存周转率
- 待入库/待出库数量

✅ **发货部统计指标**：
- 待发货数、今日已发数、在途订单数
- 准时发货率、平均发货时间

---

### 4.2 Mock数据（待替换）

⚠️ **客服部服务案例列表**：
- 当前使用 `mockServiceCases`
- 建议替换为：`GET /service-tickets` API

⚠️ **仓储部库存预警列表**：
- 当前使用 `mockWarehouseAlerts`
- 建议替换为：从物料表查询低库存/缺货物料

⚠️ **发货部订单列表**：
- 当前使用 `mockShippingOrders`
- 建议替换为：`GET /business-support/delivery-orders` API

---

## 五、数据展示位置

### 5.1 首页概览区域

- **顶部统计卡片**：6个卡片展示关键指标
  - 生产部：在产项目、今日产出
  - 客服部：服务案例、满意度
  - 仓储部：库存SKU、周转率
  - 发货部：待发货、准时率

- **中间概览卡片**：
  - 客服部概览：平均响应时间、待处理、在岗工程师
  - 仓储&发货概览：仓储利用率、在途订单、待入库/待出库

---

### 5.2 详细Tab页面

- **"客服部"Tab**：
  - 左侧：服务案例列表（Mock）
  - 右侧：服务指标（真实API）

- **"仓储部"Tab**：
  - 左侧：库存预警列表（Mock）
  - 右侧：仓储指标（真实API）

- **"发货部"Tab**：
  - 左侧：发货订单列表（Mock）
  - 右侧：发货指标（真实API）

---

## 六、后续优化建议

### 6.1 替换Mock数据

1. **客服案例列表**：
   ```javascript
   // 使用 serviceApi.tickets.list() 替换 mockServiceCases
   const [serviceCases, setServiceCases] = useState([])
   ```

2. **库存预警列表**：
   ```javascript
   // 从 materialApi 查询低库存/缺货物料
   const [warehouseAlerts, setWarehouseAlerts] = useState([])
   ```

3. **发货订单列表**：
   ```javascript
   // 使用 businessSupportApi.deliveryOrders.list() 替换 mockShippingOrders
   const [shippingOrders, setShippingOrders] = useState([])
   ```

---

### 6.2 数据可视化

- 添加趋势图表（满意度趋势、周转率趋势、准时率趋势）
- 添加对比图表（本月 vs 上月）
- 添加分布图表（案例类型分布、订单状态分布）

---

### 6.3 数据钻取

- 点击案例查看详情
- 点击预警查看物料详情
- 点击订单查看发货详情

---

## 七、API接口清单

### 已实现的API

1. ✅ `GET /service/dashboard-statistics` - 客服统计
2. ✅ `GET /materials/warehouse/statistics` - 仓储统计
3. ✅ `GET /business-support/delivery-orders/statistics` - 发货统计

### 待使用的API（替换Mock数据）

1. ⚠️ `GET /service-tickets` - 服务案例列表
2. ⚠️ `GET /materials?low_stock=true` - 低库存物料列表
3. ⚠️ `GET /business-support/delivery-orders` - 发货订单列表

---

**总结**：目前三个部门的**统计指标**都已使用真实API数据，但**列表数据**（案例列表、预警列表、订单列表）仍使用Mock数据，建议后续替换为真实API。

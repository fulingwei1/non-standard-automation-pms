# 销售流程梳理 - 线索到技术评估完整流程

**梳理时间**: 2026-02-15  
**系统**: 非标自动化项目管理系统  
**范围**: 线索 → 商机 → 技术评估 → 报价

---

## 📊 完整业务流程图

```
┌─────────────────────────────────────────────────────────────────┐
│                      销售商机管理全流程                          │
└─────────────────────────────────────────────────────────────────┘

🔵 阶段1: 线索获取与初步评估
├─ Step 1.1: 线索录入
│  └─ 来源: 展会/网站/推荐/主动开发
│  └─ 录入: 客户名称、行业、联系方式、需求摘要
│  └─ 分配: 自动/手动分配销售负责人
│  └─ 状态: NEW（新线索）
│
├─ Step 1.2: 优势产品匹配（初步筛选）
│  └─ 判断: 是否匹配公司优势产品
│  └─ 字段: is_advantage_product（Boolean）
│  └─ 字段: product_match_type（ADVANTAGE/NEW/UNKNOWN）
│  └─ 作用: 优先级排序，优势产品优先跟进
│
├─ Step 1.3: 销售跟进
│  └─ 跟进方式: 电话/邮件/拜访/会议
│  └─ 记录: LeadFollowUp表（跟进类型、内容、下一步）
│  └─ 状态流转: NEW → CONTACTED（已联系）
│
└─ Step 1.4: 线索评估
   └─ 评估: 客户意向、预算、决策链
   └─ 优先级评分: priority_score（0-100分）
   └─ 决策: 转商机 or 放弃 or 继续孵化
   └─ 状态: CONTACTED → QUALIFIED（合格）或 LOST（流失）

─────────────────────────────────────────────────────────────────

🟢 阶段2: 商机转化与需求详细采集
├─ Step 2.1: 线索转商机
│  └─ 触发: 销售判断客户意向明确
│  └─ 创建: Opportunity（商机）
│  └─ 关联: lead_id → 保持线索关联
│  └─ 关联: customer_id → 关联客户档案
│  └─ 初始阶段: DISCOVERY（发现阶段）
│
├─ Step 2.2: 商机基础信息完善
│  └─ 商机名称: 如"XX公司5G模块测试线项目"
│  └─ 项目类型: ICT/FCT/EOL/烧录/老化/视觉检测等
│  └─ 预估金额: est_amount
│  └─ 预估毛利率: est_margin
│  └─ 预计成交日期: expected_close_date
│  └─ 预算范围: budget_range
│  └─ 决策链: decision_chain（决策人信息）
│
├─ Step 2.3: 需求详细采集（关键环节）
│  └─ 方式1: 销售人工填写
│  └─ 方式2: AI智能澄清（AIClarification表）
│  │  └─ AI生成澄清问题
│  │  └─ 多轮澄清对话
│  │  └─ 自动结构化需求
│  │
│  └─ 需求详情表: LeadRequirementDetail（80+字段）
│     ├─ 基础信息:
│     │  └─ 客户工厂/地点
│     │  └─ 被测对象类型
│     │  └─ 应用场景
│     │  └─ 交付模式、期望交付日期
│     │  └─ 需求成熟度（1-5级）
│     │
│     ├─ 文档与资源:
│     │  └─ 是否有客户SOW/URS
│     │  └─ 是否有接口协议文档
│     │  └─ 是否有图纸/原理/IO清单
│     │  └─ 样品可提供情况
│     │  └─ 客户配合资源
│     │
│     ├─ 产能与节拍:
│     │  └─ 目标产能（UPH/日/班）
│     │  └─ 节拍要求（CT秒）
│     │  └─ 工位数/并行数
│     │  └─ 换型方式
│     │  └─ 良率目标、复测要求
│     │
│     ├─ 数据与追溯:
│     │  └─ 追溯要求类型
│     │  └─ 数据保留期限
│     │  └─ 数据格式
│     │
│     ├─ 测试范围:
│     │  └─ 测试范围（JSON Array）
│     │  └─ 关键指标口径
│     │  └─ 覆盖边界
│     │  └─ 异常处理规则
│     │
│     ├─ 验收标准:
│     │  └─ 验收方式
│     │  └─ 验收依据
│     │  └─ 验收交付物清单
│     │
│     ├─ 接口与通讯:
│     │  └─ 接口类型（IO点数）
│     │  └─ 通讯协议
│     │  └─ 上位系统对接
│     │  └─ 数据字段清单
│     │  └─ IT安全/网络限制
│     │
│     ├─ 现场条件:
│     │  └─ 供电、气源
│     │  └─ 环境要求
│     │  └─ 安全要求
│     │  └─ 占地与物流
│     │  └─ 客户现场规范
│     │
│     ├─ 供应链:
│     │  └─ 客供物料清单
│     │  └─ 禁用品牌
│     │  └─ 指定品牌
│     │  └─ 长周期件提示
│     │
│     └─ 售后要求:
│        └─ 备品备件要求
│        └─ 售后支持要求
│
├─ Step 2.4: 需求完整度检查
│  └─ 系统自动计算: completeness（0-100%）
│  └─ 基于必填字段和关键信息完成度
│  └─ 低于阈值（如60%）→ 提示补充
│
└─ Step 2.5: 需求冻结（重要里程碑）
   └─ 触发时机: 需求确认后、准备启动技术评估前
   └─ 冻结记录: RequirementFreeze表
   └─ 冻结类型: 初步冻结/报价冻结/立项冻结
   └─ 版本号: requirement_version
   └─ 冻结标识: is_frozen = True
   └─ 冻结后变更: 必须走ECR/ECN流程（requires_ecr）
   └─ 作用: 锁定需求基线，防止频繁变更

─────────────────────────────────────────────────────────────────

🟡 阶段3: 技术评估（售前技术支持核心）
├─ Step 3.1: 分配售前工程师
│  └─ 商机分配: assignee_id（被指派的售前工程师）
│  └─ 分配方式: 手动指派 or 自动分配（基于负荷）
│  └─ 状态更新: assessment_status = "ASSIGNED"
│
├─ Step 3.2: 创建技术评估任务
│  └─ 创建: TechnicalAssessment
│  └─ 来源: source_type = "OPPORTUNITY", source_id = opp_id
│  └─ 评估人: evaluator_id = 售前工程师ID
│  └─ 状态: status = "PENDING"（待评估）
│
├─ Step 3.3: 技术评估打分（五维度评分）
│  └─ 评分规则: ScoringRule表（可配置版本）
│  └─ 五个维度评分:
│     ├─ 1️⃣ 技术可行性（25分）
│     │  └─ 技术成熟度、技术难度、技术风险
│     │
│     ├─ 2️⃣ 需求明确度（20分）
│     │  └─ 需求成熟度、文档完整度、客户配合度
│     │
│     ├─ 3️⃣ 资源匹配度（20分）
│     │  └─ 人力资源、时间窗口、设备能力
│     │
│     ├─ 4️⃣ 商业价值（20分）
│     │  └─ 预估金额、毛利率、战略价值
│     │
│     └─ 5️⃣ 交付风险（15分）
│        └─ 交付周期、现场条件、供应链风险
│
│  └─ 总分: total_score（0-100分）
│  └─ 分数详情: dimension_scores（JSON）
│
├─ Step 3.4: 一票否决检查（关键风险控制）
│  └─ 否决规则: 配置在ScoringRule中
│  └─ 常见否决条件:
│     ❌ 预算严重不足（<成本估算的80%）
│     ❌ 交付周期不可能完成
│     ❌ 关键技术无法实现
│     ❌ 客户现场条件不满足
│     ❌ 供应链无法保障
│  └─ 触发标识: veto_triggered = True
│  └─ 否决原因: veto_rules（JSON）
│
├─ Step 3.5: AI辅助分析（可选）
│  └─ AI分析内容:
│     ├─ 相似项目匹配
│     ├─ 失败案例预警（FailureCase表）
│     ├─ 风险识别
│     └─ 成本估算辅助
│  └─ 存储: ai_analysis（Text字段）
│
├─ Step 3.6: 风险识别
│  └─ 风险列表: risks（JSON Array）
│  └─ 风险分类:
│     ⚠️ 技术风险
│     ⚠️ 进度风险
│     ⚠️ 成本风险
│     ⚠️ 供应链风险
│     ⚠️ 客户配合风险
│
├─ Step 3.7: 相似失败案例匹配
│  └─ 从FailureCase表中检索
│  └─ 匹配维度: 行业、产品类型、工序、节拍、预算状态等
│  └─ 预警信号: early_warning_signals
│  └─ 教训总结: lesson_learned
│  └─ 存储: similar_cases（JSON）
│
├─ Step 3.8: 决策建议生成
│  └─ 决策选项:
│     ✅ 推荐立项（总分≥80，无一票否决）
│     ⚠️ 有条件立项（60≤总分<80，无一票否决）
│        └─ 立项条件: conditions（JSON）
│        └─ 示例: "需客户提供完整图纸"、"预算增加20%"
│     🟡 暂缓（40≤总分<60 or 有条件但风险高）
│     ❌ 不建议立项（总分<40 or 有一票否决）
│
├─ Step 3.9: 未决事项管理（OpenItem）
│  └─ 问题记录: 评估过程中发现的待解决问题
│  └─ 问题类型:
│     • 技术澄清（需客户明确）
│     • 资源确认（需内部协调）
│     • 风险应对（需制定方案）
│     • 成本核算（需供应商报价）
│  └─ 责任方: 客户 or 内部
│  └─ 责任人: responsible_person_id
│  └─ 截止日期: due_date
│  └─ 阻塞标识: blocks_quotation（是否阻塞报价）
│  └─ 状态: PENDING/IN_PROGRESS/RESOLVED/CLOSED
│
└─ Step 3.10: 技术评估完成
   └─ 状态更新: status = "COMPLETED"
   └─ 完成时间: evaluated_at
   └─ 关联: 商机.assessment_id = 评估ID
   └─ 触发: 阶段门审批（如果配置了）

─────────────────────────────────────────────────────────────────

🔵 阶段4: 阶段门审批（可选）
├─ Step 4.1: 提交阶段门审批
│  └─ 适用场景: 大项目、高风险项目
│  └─ 审批节点: 技术评估完成后
│  └─ 状态: gate_status = "PENDING"
│
├─ Step 4.2: 审批决策
│  └─ 审批人: 技术总监 + 销售总监 + （总经理）
│  └─ 审批依据: 技术评估结果
│  └─ 审批结果: 通过 or 驳回 or 有条件通过
│
└─ Step 4.3: 审批通过
   └─ 状态: gate_status = "APPROVED"
   └─ 通过时间: gate_passed_at
   └─ 下一阶段: 准备报价

─────────────────────────────────────────────────────────────────

🟢 阶段5: 报价准备（技术评估后）
├─ Step 5.1: 方案设计
│  └─ 基于技术评估结果
│  └─ 设计内容: 系统架构、模块清单、BOM
│
├─ Step 5.2: 成本核算
│  └─ 人工成本、材料成本、设备成本、其他
│  └─ 成本总额 → 定价策略 → 报价金额
│
├─ Step 5.3: 创建报价单
│  └─ 报价关联: quote.opportunity_id
│  └─ 报价金额、成本、毛利率
│  └─ 报价明细、付款条件、交付期
│
├─ Step 5.4: 报价审批
│  └─ 审批表: QuoteApproval
│  └─ 审批规则: 基于金额、毛利率
│  └─ 审批层级: 销售经理 → 销售总监 → 总经理
│
└─ Step 5.5: 报价提交
   └─ 审批通过 → 发给客户
   └─ 商机阶段更新: stage = "QUOTATION"

─────────────────────────────────────────────────────────────────

🟡 后续阶段（简述）
├─ 阶段6: 商务谈判
│  └─ stage = "NEGOTIATION"
│  └─ 价格谈判、条款协商、技术澄清
│
├─ 阶段7: 合同签订
│  └─ stage = "CLOSED_WON"（成交）
│  └─ 创建合同、关联项目
│
└─ 阶段8: 项目执行
   └─ 转入项目管理模块
   └─ 设计 → 采购 → 生产 → 调试 → 验收

```

---

## 📊 核心数据流转

### 数据关联关系

```
Lead（线索）
  ├─ customer_id ────────────→ Customer（客户档案）
  ├─ owner_id ───────────────→ User（销售负责人）
  ├─ requirement_detail_id ──→ LeadRequirementDetail（需求详情）
  ├─ assessment_id ──────────→ TechnicalAssessment（技术评估）
  ├─ assignee_id ────────────→ User（售前工程师）
  └─ follow_ups ─────────────→ LeadFollowUp[]（跟进记录）

Opportunity（商机）
  ├─ lead_id ────────────────→ Lead（来源线索）
  ├─ customer_id ────────────→ Customer（客户）
  ├─ owner_id ───────────────→ User（销售负责人）
  ├─ assessment_id ──────────→ TechnicalAssessment（技术评估）
  ├─ requirements ───────────→ OpportunityRequirement[]（需求结构化）
  ├─ quotes ─────────────────→ Quote[]（报价单）
  └─ contracts ──────────────→ Contract[]（合同）

TechnicalAssessment（技术评估）
  ├─ source_type, source_id ─→ Lead or Opportunity
  ├─ evaluator_id ───────────→ User（售前工程师）
  └─ 评估结果: 总分、五维分数、决策建议、风险、相似案例

OpenItem（未决事项）
  ├─ source_type, source_id ─→ Lead or Opportunity
  ├─ responsible_person_id ──→ User（责任人）
  └─ 状态: PENDING/IN_PROGRESS/RESOLVED/CLOSED

Quote（报价单）
  ├─ opportunity_id ─────────→ Opportunity
  └─ approvals ──────────────→ QuoteApproval[]（审批记录）
```

---

## 🎯 关键节点总结

### 1. **线索评估节点**
- 时机: 线索录入后
- 决策: 是否转商机
- 关键指标: 优势产品匹配、优先级评分
- 输出: 转商机 or 继续孵化 or 放弃

### 2. **需求冻结节点**
- 时机: 需求采集完成后
- 作用: 锁定需求基线
- 影响: 后续变更需走ECR流程
- 版本: requirement_version

### 3. **技术评估节点**（核心）
- 时机: 需求冻结后
- 评估: 五维度打分（技术可行性、需求明确度、资源匹配度、商业价值、交付风险）
- 风险: 一票否决检查、失败案例预警
- 输出: 推荐立项/有条件立项/暂缓/不建议立项

### 4. **阶段门审批节点**（可选）
- 时机: 技术评估完成后
- 决策: 是否进入报价阶段
- 审批人: 技术总监 + 销售总监

### 5. **报价审批节点**
- 时机: 报价单创建后
- 审批: 基于金额和毛利率的多级审批
- 输出: 客户报价

---

## ⚠️ 当前流程的痛点

### 1. **需求采集效率低** 🔴
- 80+字段需要手工填写
- 销售人员不专业，遗漏关键信息
- 客户提供信息不完整

→ **AI解决方案**: AI智能需求理解，自动生成澄清问题

### 2. **技术评估周期长** 🔴
- 售前工程师负荷不均
- 评估经验依赖个人
- 缺少历史案例参考

→ **AI解决方案**: AI相似案例推荐、AI风险识别

### 3. **方案设计重复性高** 🔴
- 相似项目反复设计
- 知识无法复用
- 方案质量参差不齐

→ **AI解决方案**: AI智能方案生成、知识库推荐

### 4. **成本核算不准确** 🔴
- 依赖经验估算
- 成本超支风险高
- 毛利率不可控

→ **AI解决方案**: AI智能成本估算、成本优化建议

### 5. **报价周期长** 🟡
- 报价单制作耗时（2小时+）
- 审批流程慢
- 客户等待时间长

→ **AI解决方案**: AI报价单自动生成、智能审批路由

---

## 💡 AI优化建议

### 优化点1: AI需求理解（Step 2.3）
**当前**: 销售手工填写80+字段  
**优化**: AI自动提取、生成澄清问题  
**效果**: 需求采集时间 ↓ 70%

### 优化点2: AI技术评估辅助（Step 3.5-3.7）
**当前**: 售前工程师人工评估  
**优化**: AI推荐相似案例、自动风险识别  
**效果**: 评估周期 ↓ 50%

### 优化点3: AI方案生成（Step 5.1）
**当前**: 手工设计方案  
**优化**: AI基于需求自动生成初步方案  
**效果**: 方案设计时间 ↓ 80%

### 优化点4: AI成本估算（Step 5.2）
**当前**: 经验估算  
**优化**: AI机器学习模型预测成本  
**效果**: 成本准确率 ↑ 50%，毛利率 ↑ 15%

### 优化点5: AI报价生成（Step 5.3）
**当前**: 手工制作报价单  
**优化**: AI一键生成专业报价单  
**效果**: 报价时间 ↓ 90%

---

## 🚀 AI增强后的理想流程

```
线索录入（1小时）
   ↓
AI需求理解（30分钟）← 原2小时
   ↓
需求补充 + AI澄清（1小时）
   ↓
需求冻结（即时）
   ↓
分配售前工程师（即时）
   ↓
AI辅助技术评估（2小时）← 原1天
   ├─ AI相似案例推荐
   ├─ AI风险识别
   └─ AI决策建议
   ↓
人工确认评估结果（30分钟）
   ↓
阶段门审批（1天）
   ↓
AI方案生成（1小时）← 原3天
   ├─ 自动方案模板匹配
   ├─ 自动BOM生成
   └─ 自动架构图生成
   ↓
AI成本估算（30分钟）← 原4小时
   ├─ 多维度成本预测
   └─ 智能定价建议
   ↓
AI报价单生成（10分钟）← 原2小时
   ↓
报价审批（1-2天）
   ↓
发送客户（即时）

总周期: 5天（原10-15天）↓ 50-66%
```

---

## ✅ 总结

### 当前流程特点
✅ **流程完整** - 覆盖线索到报价全流程  
✅ **数据结构完善** - 80+字段详细需求采集  
✅ **风险控制严格** - 一票否决、阶段门、多级审批  
✅ **追溯性强** - 需求冻结、版本管理、变更控制

### 核心痛点
❌ **效率低** - 售前周期10-15天  
❌ **依赖人工** - 需求采集、技术评估、方案设计全靠人  
❌ **准确性差** - 成本估算靠经验，误差大  
❌ **知识浪费** - 历史案例无法复用

### AI改造价值
🚀 **效率提升50-70%** - 售前周期缩短至5天  
💰 **成交率提升30%** - AI辅助决策更准确  
📈 **毛利率提升15%** - AI成本优化  
🏆 **竞争力提升** - 响应速度快3倍

---

**符哥，这就是当前的完整销售流程！** 💪

**核心瓶颈在技术评估和方案设计环节，AI能大幅提升效率和准确性！** 🤖
